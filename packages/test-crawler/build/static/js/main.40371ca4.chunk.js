(this["webpackJsonptest-crawler"]=this["webpackJsonptest-crawler"]||[]).push([[0],{11:function(e,t,n){"use strict";(function(e){n.d(t,"k",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"j",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"m",(function(){return f})),n.d(t,"n",(function(){return d})),n.d(t,"s",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"h",(function(){return E})),n.d(t,"i",(function(){return b})),n.d(t,"r",(function(){return w})),n.d(t,"a",(function(){return y})),n.d(t,"t",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return k})),n.d(t,"l",(function(){return x})),n.d(t,"q",(function(){return T})),n.d(t,"p",(function(){return S})),n.d(t,"v",(function(){return C})),n.d(t,"w",(function(){return R})),n.d(t,"u",(function(){return L})),n.d(t,"x",(function(){return _})),n.d(t,"y",(function(){return D}));var r=n(2),a=n.n(r),o=n(9),c=n(21);function i(){return s.apply(this,arguments)}function s(){return(s=Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{dir:e});case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(e){return new c.a(e,this).info()}function l(e,t){return new c.a(e,this).jobs(t)}function p(e){return new c.a(e,this).repo()}function m(e){return new c.a(e,this).repos()}function f(e,t){return new c.a(e,this).loadProject(t)}function d(e){return new c.a(e,this).loadProjects()}function h(e,t,n,r){return new c.a(e,this).saveProject(t,n,r)}function g(e,t,n){return new c.a(e,this).getCrawler(t,n)}function v(e,t){return new c.a(e,this).getAllCrawlers(t)}function E(e,t,n){return new c.a(e,this).getPages(t,n)}function b(e,t){return new c.a(e,this).getPins(t)}function w(e,t,n,r){return new c.a(e,this).saveBeforeAfterCode(t,n,r)}function y(e,t,n){return new c.a(e,this).getBeforeAfterCode(t,n)}function j(e,t,n){return new c.a(e,this).saveCode(t,n)}function O(e,t,n){return new c.a(e,this).loadCode(t,n)}function k(e,t){return new c.a(e,this).getCodeList(t)}function x(e,t,n,r){return I.apply(this,arguments)}function I(){return(I=Object(o.a)(a.a.mark((function e(t,n,r,o){var i,s,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>4&&void 0!==u[4]?u[4]:300,i=new c.a(t,this),e.next=4,i.image(n,r,o);case 4:if(s=e.sent){e.next=7;break}throw new Error("Cannot load image.");case 7:return e.abrupt("return","data:image/png;base64, ".concat(s.toString("base64")));case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function T(e,t,n){return new c.a(e,this).removeFromPins(t,n)}function S(e,t,n,r){return new c.a(e,this).copyToPins(t,n,r)}function C(e,t,n,r,a,o){return P.apply(this,arguments)}function P(){return(P=Object(o.a)(a.a.mark((function e(t,n,r,o,i,s){var u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=new c.a(t,this),e.next=3,u.setZoneStatus(n,r,o,i,s);case 3:return e.abrupt("return",E(t,n,r));case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function R(e,t,n,r,a){return F.apply(this,arguments)}function F(){return(F=Object(o.a)(a.a.mark((function e(t,n,r,o,i){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new c.a(t,this),e.next=3,s.setZonesStatus(n,r,o,i);case 3:return e.abrupt("return",E(t,n,r));case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function L(e,t,n,r){return new c.a(e,this).setCrawlerStatus(t,n,r)}function _(e,t){return new c.a(e,this).startCrawler(t)}function D(){return new c.a(void 0,this).startCrawlers()}}).call(this,"/")},21:function(e,t,n){"use strict";var r=n(23),a=n(24),o=n(58),c=n(2),i=n.n(c),s=n(9),u=n(49),l=n(81),p=n(84),m=n(82),f=n(85),d=n(41),h=n(132),g=n(298),v=function(e,t){return function(n){return Object(d.join)(t,"".concat(e,".").concat(n))}},E=n(86),b=function(e){function t(e,n){var r;return Object(u.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e,n))).ctx=n,r}return Object(f.a)(t,e),Object(l.a)(t,[{key:"repos",value:function(){return this.storage.repos()}},{key:"repo",value:function(){return this.storage.getRepo()}},{key:"info",value:function(){return this.storage.info()}},{key:"jobs",value:function(e){return this.storage.jobs(e)}},{key:"loadProject",value:function(e){return this.storage.readJSON(this.join(e,"project.json"))}},{key:"loadProjects",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.readdir(r.PROJECT_FOLDER);case 2:return t=e.sent,e.abrupt("return",Promise.all(t.map((function(e){return n.loadProject(e)}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveProject",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r||(r=h(n)),a={id:r,name:n,crawlerInput:t},e.next=4,this.storage.saveJSON(this.join(r,"project.json"),a);case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getCrawler",value:function(e,t){var n=this.join(e,r.CRAWL_FOLDER,t,"_.json");return this.storage.readJSON(n)}},{key:"getAllCrawlers",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a,o,c=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.join(t,r.CRAWL_FOLDER),e.next=3,this.storage.readdir(n);case 3:return a=e.sent,e.next=6,Promise.all(a.map((function(e){return c.getCrawler(t,e)})));case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"copyToPins",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n,a){var o,c,s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.join(t,r.CRAWL_FOLDER,n),c=v(a,o),e.next=4,this.storage.readJSON(c("json"));case 4:if(!(null===(s=e.sent)||void 0===s?void 0:s.png)){e.next=10;break}if(s.png.diff={pixelDiffRatio:0,zones:[]},!(s.png.diff.pixelDiffRatio>0)){e.next=10;break}return e.next=10,this.storage.saveJSON(c("json"),s);case 10:return u=v(a,this.join(t,r.PIN_FOLDER)),e.next=13,this.storage.saveJSON(u("json"),s);case 13:return e.next=15,this.storage.copy(c("html"),u("html"));case 15:return e.next=17,this.storage.copy(c("png"),u("png"));case 17:return e.abrupt("return",s);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"removeFromPins",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v(n,this.join(t,r.PIN_FOLDER)),e.next=3,this.storage.remove(a("png"));case 3:return e.next=5,this.storage.remove(a("html"));case 5:return e.next=7,this.storage.remove(a("json"));case 7:return e.abrupt("return",this.getPins(t));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"image",value:function(e,t,n){var a="base"===t?this.join(e,r.PIN_FOLDER):this.join(e,r.CRAWL_FOLDER,t);return this.storage.blob(v(n,a)("png"))}},{key:"saveBeforeAfterCode",value:function(e,t,n){if(!Object.values(E.a).includes(t))throw new Error("Unknown code type ".concat(t,"."));var r=this.join(e,"".concat(t,".js"));return n.length?this.storage.saveFile(r,n):this.storage.remove(r)}},{key:"getBeforeAfterCode",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.values(E.a).includes(n)){e.next=2;break}throw new Error("Unknown code type ".concat(n,"."));case 2:return e.prev=2,e.next=5,this.storage.read(this.join(t,"".concat(n)));case 5:return r=e.sent,e.abrupt("return",(null===r||void 0===r?void 0:r.toString())||"");case 9:e.prev=9,e.t0=e.catch(2);case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveCode",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var c,s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.source,s=Object(o.a)(n,["source"]),e.next=3,this.getCodeList(t);case 3:return(u=e.sent)[n.id]=s,e.next=7,this.storage.saveJSON(this.join(t,r.CODE_FOLDER,"list.json"),Object(a.a)({},u));case 7:return e.next=9,this.storage.saveFile(this.join(t,r.CODE_FOLDER,"".concat(n.id,".js")),c);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadCode",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var o,c,s,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCodeList(t);case 2:if(o=e.sent,c=o[n],s=this.join(t,r.CODE_FOLDER,"".concat(n,".js")),!c){e.next=12;break}return e.next=8,this.storage.read(s);case 8:if(!(u=e.sent)){e.next=12;break}return l=u.toString(),e.abrupt("return",Object(a.a)({},c,{source:l}));case 12:return e.abrupt("return",{id:n,name:"",pattern:"",source:""});case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCodeList",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.length>1&&void 0!==o[1]&&o[1],n=this.join(t,r.CODE_FOLDER,"list.json"),e.next=4,this.storage.readJSON(n);case 4:return a=e.sent,e.abrupt("return",a||{});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPins",value:function(e){return this.getPinsInFolder(this.join(e,r.PIN_FOLDER))}},{key:"getPin",value:function(e,t){return this.getPageInFolder(this.join(e,r.PIN_FOLDER),t)}},{key:"getPages",value:function(e,t){return this.getPinsInFolder(this.join(e,r.CRAWL_FOLDER,t))}},{key:"getPageInFolder",value:function(e,t){return this.storage.readJSON(v(t,e)("json"))}},{key:"getPinsInFolder",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.readdir(t);case 2:return n=e.sent,e.abrupt("return",Promise.all(n.filter((function(e){return".json"===Object(d.extname)(e)&&"_.json"!==e})).map((function(e){return r.storage.readJSON(Object(d.join)(t,e))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCrawlerStatus",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n,a){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.join(t,r.CRAWL_FOLDER,n,"_.json"),e.next=3,this.storage.readJSON(o);case 3:return(c=e.sent).status=a,e.next=7,this.storage.saveJSON(o,c);case 7:return e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"setZoneStatus",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n,o,c,s){var u,l,p,m,f,d,h,E,b,w,y,j,O;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=this.join(t,r.CRAWL_FOLDER,n),m=v(o,p),e.next=4,this.storage.readJSON(m("json"));case 4:if(f=e.sent,"pin"!==s){e.next=13;break}return w=v(o,this.join(t,r.PIN_FOLDER)),e.next=9,this.storage.readJSON(w("json"));case 9:return(null===(y=e.sent)||void 0===y?void 0:null===(d=y.png)||void 0===d?void 0:null===(h=d.diff)||void 0===h?void 0:h.zones)&&(null===f||void 0===f?void 0:null===(E=f.png)||void 0===E?void 0:null===(b=E.diff)||void 0===b?void 0:b.zones)&&(y.png.diff.zones.push(Object(a.a)({},f.png.diff.zones[c],{status:s})),(j=y.png.diff.zones.map((function(e){return e.zone}))).sort((function(e,t){return e.xMin*e.yMin-t.xMin*t.yMin})),O=Object(g.groupOverlappingZone)(j),y.png.diff.zones=O.map((function(e){return{zone:e,status:s}}))),e.next=13,this.storage.saveJSON(w("json"),y);case 13:return(null===f||void 0===f?void 0:null===(u=f.png)||void 0===u?void 0:null===(l=u.diff)||void 0===l?void 0:l.zones)&&(f.png.diff.zones[c].status=s),e.next=16,this.storage.saveJSON(m("json"),f);case 16:return e.abrupt("return",f);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,o){return e.apply(this,arguments)}}()},{key:"setZonesStatus",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n,a,o){var c,s,u,l,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.join(t,r.CRAWL_FOLDER,n),s=v(a,c),e.next=4,this.storage.readJSON(s("json"));case 4:u=e.sent,p=0;case 6:if(!(p<u.png.diff.zones.length)){e.next=13;break}return e.next=9,this.setZoneStatus(t,n,a,p,o);case 9:l=e.sent;case 10:p++,e.next=6;break;case 13:return e.abrupt("return",l);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"startCrawler",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Math.floor(Date.now()/1e3).toString(),a={projectId:t,pagesFolder:r},e.next=4,this.storage.crawl(a,30,null===(n=this.ctx)||void 0===n?void 0:n.push);case 4:return o=e.sent,e.abrupt("return",{timestamp:r,redirect:o});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"join",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return d.join.apply(void 0,[r.PROJECT_FOLDER,e].concat(n))}}]),t}(n(88).a);n.d(t,"a",(function(){return b}))},23:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"ROOT_FOLDER",(function(){return o})),n.d(t,"PROJECT_FOLDER",(function(){return c})),n.d(t,"CRAWL_FOLDER",(function(){return i})),n.d(t,"PIN_FOLDER",(function(){return s})),n.d(t,"CODE_FOLDER",(function(){return u})),n.d(t,"MAX_HISTORY",(function(){return l})),n.d(t,"TIMEOUT",(function(){return p})),n.d(t,"CONSUMER_COUNT",(function(){return m})),n.d(t,"USER_AGENT",(function(){return f})),n.d(t,"CONSUME_TIMEOUT",(function(){return d})),n.d(t,"config",(function(){return h}));var r=n(24),a=n(41),o=Object({NODE_ENV:"production",PUBLIC_URL:""}).ROOT_FOLDER||Object(a.join)(e,"../../.."),c=Object({NODE_ENV:"production",PUBLIC_URL:""}).PROJECT_FOLDER||"test-crawler",i="crawl",s="pin",u="code",l=10,p=1e4,m=5,f="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",d=Object({NODE_ENV:"production",PUBLIC_URL:""}).CONSUME_TIMEOUT?parseInt(Object({NODE_ENV:"production",PUBLIC_URL:""}).CONSUME_TIMEOUT,10):0,h=function(){var e,t=Object(a.join)(o,"test-crawler.config.js");try{e=n(326)(t)}catch(c){e={}}return Object(r.a)({remote:{}},e)}()}.call(this,"/")},299:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return O}));var r=n(27),a=n(102),o=n(24),c=n(2),i=n.n(c),s=n(9),u=n(49),l=n(81),p=n(84),m=n(82),f=n(85),d=n(300),h=n(41),g=n(198),v=n.n(g),E=n(23),b=n(71),w=n(88),y="https://api.github.com",j="\nname: Test-crawler CI\n\non:\n  repository_dispatch:\n    types: [".concat("test-crawler","]\n\njobs:\n  test-crawler:\n\n    runs-on: ubuntu-latest\n\n    steps:\n    - uses: actions/checkout@v2\n    - name: Run test-crawler ${{ github.event.client_payload.projectId }}\n      uses: apiel/test-crawler/actions/run@master\n    - name: Push changes\n      uses: apiel/test-crawler/actions/push@master\n      with:\n        token: ${{ secrets.GITHUB_TOKEN }}\n"),O=function(t){function n(e){var t;return Object(u.a)(this,n),(t=Object(p.a)(this,Object(m.a)(n).call(this))).ctx=e,t.config=void 0,t.config=E.config.remote.github,t}return Object(f.a)(n,t),Object(l.a)(n,[{key:"readdir",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getContents(t);case 3:return n=e.sent,r=n.data,e.abrupt("return",r.map((function(e){return e.name})));case 8:if(e.prev=8,e.t0=e.catch(0),404!==(null===e.t0||void 0===e.t0?void 0:null===(a=e.t0.response)||void 0===a?void 0:a.status)){e.next=12;break}return e.abrupt("return",[]);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"blob",value:function(){var t=Object(s.a)(i.a.mark((function t(n){var r,a,o,c,s,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getContents(Object(h.dirname)(n));case 2:if(r=t.sent,a=r.data,o=Object(h.basename)(n),c=a.find((function(e){return e.name===o}))){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,this.call({url:"".concat(this.blobUrl,"/").concat(c.sha)});case 10:return s=t.sent,u=s.data.content,t.abrupt("return",e.from(u,"base64"));case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"read",value:function(){var t=Object(s.a)(i.a.mark((function t(n){var r,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getContents(n);case 2:return r=t.sent,a=r.data.content,t.abrupt("return",e.from(a,"base64"));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"readJSON",value:function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=JSON,e.next=4,this.read(t);case 4:return e.t1=e.sent.toString(),e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContents(t);case 2:return n=e.sent,r=n.data.sha,a=JSON.stringify({message:"".concat("[test-crawler]"," save json"),sha:r}),e.next=7,this.call({method:"DELETE",url:"".concat(this.contentsUrl,"/").concat(t),data:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveFile",value:function(){var t=Object(s.a)(i.a.mark((function t(n,r){var a,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.repo){t.next=2;break}throw new Error("GitHub repository required.");case 2:return t.next=4,this.getSha(n);case 4:return a=t.sent,c=JSON.stringify(Object(o.a)({message:"".concat("[test-crawler]"," save file"),content:e.from(r).toString("base64")},a&&{sha:a})),t.next=8,this.call({method:"PUT",url:"".concat(this.contentsUrl,"/").concat(n),data:c});case 8:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getSha",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getContents(t);case 3:if(n=e.sent,!(null===(r=n.data)||void 0===r?void 0:r.sha)){e.next=7;break}return e.abrupt("return",r.sha);case 7:e.next=13;break;case 9:if(e.prev=9,e.t0=e.catch(0),404===(null===e.t0||void 0===e.t0?void 0:null===(a=e.t0.response)||void 0===a?void 0:a.status)){e.next=13;break}throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"saveJSON",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveFile(t,JSON.stringify(n,null,4)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"copy",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.read(t);case 2:(r=e.sent)&&this.saveFile(n,r.toString());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"crawl",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t||void 0===t?void 0:t.projectId)){e.next=5;break}return e.next=3,this.saveFile(".github/workflows/test-crawler.yml",j);case 3:return e.next=5,this.call({method:"POST",url:"".concat(this.ciDispatchUrl),data:{event_type:"test-crawler",client_payload:{projectId:t.projectId}}});case 5:return e.abrupt("return",this.redirectUrl);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"repos",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:"".concat(y,"/users/").concat(null===(t=this.config)||void 0===t?void 0:t.user,"/repos?sort=updated&per_page=1000")});case 2:return n=e.sent,r=n.data,e.abrupt("return",r.map((function(e){return e.name})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRepo",value:function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.repo);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"info",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:"".concat(y,"/rate_limit")});case 2:return t=e.sent,n=t.data.rate,r=n.limit,a=n.remaining,e.abrupt("return","For GitHub API requests, you can make up to 5000 requests per hour.\n        Every pages of the test-crawler UI is using multiples request at once. Your\n        current rate limit is: ".concat(a," of ").concat(r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"jobs",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:this.runsUrl});case 2:return n=e.sent,r=n.data.workflow_runs,e.next=6,this.getInProgressJobs(t,r);case 6:return o=e.sent,c=this.getQueuedJobs(r),e.abrupt("return",[].concat(Object(a.a)(c),Object(a.a)(o)));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueuedJobs",value:function(e){return e.filter((function(e){var t=e.status;return!["in_progress","completed"].includes(t)})).map((function(e){var t=e.id,n=e.html_url,r=e.status,a=e.created_at,o=e.updated_at;return{id:t,url:n,status:r,startAt:Math.round(new Date(a).getTime()/1e3),lastUpdate:Math.round(new Date(o).getTime()/1e3)}}))}},{key:"getInProgressJobs",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var a,o,c=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.filter((function(e){return"in_progress"===e.status})).map((function(e){return e.id})),o=a.map(function(){var e=Object(s.a)(i.a.mark((function e(n){var a,o,s,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.call({url:"".concat(y,"/repos/").concat(c.user,"/").concat(c.repo,"/actions/runs/").concat(n,"/jobs")});case 2:if(a=e.sent,o=a.data.jobs,s=Object(r.a)(o,1),u=s[0],!(void 0!==u.steps.find((function(e){return e.name.includes(t)})))){e.next=9;break}return l=u.steps.find((function(e){return"in_progress"===e.status})),e.abrupt("return",{id:n,url:u.html_url,status:u.status,startAt:Math.round(new Date(u.started_at).getTime()/1e3),stepsCount:u.steps.length,stepsDone:u.steps.filter((function(e){return"completed"===e.status})).length,currentStep:(null===l||void 0===l?void 0:l.name)||"unknown",lastUpdate:Math.round(new Date((null===l||void 0===l?void 0:l.started_at)||u.started_at).getTime()/1e3)});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(o);case 4:return e.t0=function(e){return e},e.abrupt("return",e.sent.filter(e.t0));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"call",value:function(e){if(!this.token||!this.user)throw new Error(b.a.missingGitHubConfig);return v()(Object(o.a)({},e,{headers:Object(o.a)({},null===e||void 0===e?void 0:e.headers,{Authorization:"token ".concat(this.token)})}))}},{key:"getContents",value:function(e){return this.call({url:"".concat(this.contentsUrl,"/").concat(e)})}},{key:"contentsUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/contents")}},{key:"blobUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/git/blobs")}},{key:"ciDispatchUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/dispatches")}},{key:"runsUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/actions/workflows/test-crawler.yml/runs?event=repository_dispatch")}},{key:"redirectUrl",get:function(){return"https://github.com/".concat(this.user,"/").concat(this.repo,"/actions")}},{key:"user",get:function(){var e,t;return(null===(e=Object(w.b)("github",this.ctx))||void 0===e?void 0:e.user)||(null===(t=this.config)||void 0===t?void 0:t.user)}},{key:"token",get:function(){var e,t;return(null===(e=Object(w.b)("github",this.ctx))||void 0===e?void 0:e.token)||(null===(t=this.config)||void 0===t?void 0:t.user)}},{key:"repo",get:function(){var e;return Object(w.b)("githubRepo",this.ctx)||(null===(e=this.config)||void 0===e?void 0:e.defaultRepo)}}]),n}(d.a)}).call(this,n(328).Buffer)},300:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(49),a=function e(){Object(r.a)(this,e)}},316:function(e,t,n){e.exports=n(754)},323:function(e,t,n){},324:function(e,t,n){},326:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=326},71:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.missingGitHubConfig="cannot use GitHub if no config provided"}(r||(r={}))},754:function(e,t,n){"use strict";n.r(t);var r=n(315),a=n(0),o=n.n(a),c=n(8),i=n.n(c),s=(n(323),n(146)),u=n.n(s),l=n(15),p=n.n(l),m=n(33),f=n.n(m),d=n(16),h=n(59),g=(n(324),n(2)),v=n.n(g),E=n(24),b=n(58),w=n(9),y=n(51),j=n.n(y),O=n(304),k=n.n(O),x=n(139),I=n.n(x),T=n(22),S=n.n(T),C=n(10),P=n.n(C),R=n(138),F=n.n(R),L=n(145),_=n.n(L),D=n(26),N=n.n(D),U=n(20),z=n.n(U);function M(e){return"/new/".concat(e)}function A(e,t){return"/pins/".concat(e,"/").concat(t)}function J(e,t,n){return"/code/".concat(e,"/").concat(t,"/").concat(n)}function B(e,t,n){return"/results/".concat(e,"/").concat(t,"/").concat(n)}function H(e,t){return"/project/".concat(e,"/").concat(t)}var W,G=n(11),q={lineHeight:1.2,borderLeft:"8px solid #EEE",paddingLeft:15,color:"#666",textAlign:"justify"},V=function(e){var t=e.children;return o.a.createElement("div",{style:q},t)},Z=n(44),Y=n.n(Z),Q=[{name:"Desktop - 800x600",value:{width:800,height:600}},{name:"Desktop - 1024x768",value:{width:1024,height:768}},{name:"Desktop - 1920x1080",value:{width:1920,height:1080}},{name:"iPhone 5 - 320x568",value:{width:320,height:568,isMobile:!0,hasTouch:!0}},{name:"iPhone 6 - 375x667",value:{width:375,height:667,isMobile:!0,hasTouch:!0}},{name:"Ipad - 768x1024",value:{width:768,height:1024,isMobile:!0,hasTouch:!0}},{name:"Galaxy S5 - 360x640",value:{width:360,height:640,isMobile:!0,hasTouch:!0}}],$=Q.map((function(e){var t=e.value,n=Object(b.a)(e,["value"]);return Object(E.a)({},n,{value:JSON.stringify(t)})})),K=function(e){var t=JSON.stringify(e),n=$.findIndex((function(e){return e.value===t}));if(-1!==n)return $[n].name;var r=e.width,a=e.height,o=e.isMobile;return"".concat(r,"x").concat(a).concat(o&&" mobile")},X=Y.a.Option,ee=function(e){return(0,e.getFieldDecorator)("viewport",{initialValue:e.initialValue||$[0].name})(o.a.createElement(Y.a,null,$.map((function(e){var t=e.value,n=e.name;return o.a.createElement(X,{key:t,value:t},n)}))))},te=n(83),ne=n(27),re=function(e,t,n,r){return Object(w.a)(v.a.mark((function a(){var o;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n(void 0),r(!0),a.next=5,e();case 5:o=a.sent,t(o),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),n(a.t0);case 12:r(!1);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))},ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=o.a.useState(n),a=Object(ne.a)(r,2),c=a[0],i=a[1],s=o.a.useState(),u=Object(ne.a)(s,2),l=u[0],p=u[1],m=o.a.useState(!1),f=Object(ne.a)(m,2),d=f[0],h=f[1],g=re(e,i,p,h);return o.a.useEffect((function(){g()}),t),{loading:d,result:c,call:g,error:l,setResult:i}},oe=function(e){var t=e.storageType,n=e.loadProjects,r=(e.defaultValue,ae((function(){return Object(G.o)(t)})).result),a=ae((function(){return Object(G.j)(t)})).result;return r?o.a.createElement(Y.a,{showSearch:!0,defaultValue:a,onChange:function(e){(new te.a).set("githubRepo",e,{path:"/"}),n&&n()},style:{width:200},placeholder:"repository"},r.map((function(e){return o.a.createElement(Y.a.Option,{key:e,value:e},e)}))):null},ce={marginRight:10,display:"inline-block"},ie={marginRight:30},se=function(){var e=Object(w.a)(v.a.mark((function e(t,n,r){var a,o,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.name,o=r.viewport,c=Object(b.a)(r,["name","viewport"]),e.prev=1,e.next=4,Object(G.s)(t,Object(E.a)({},c,{viewport:JSON.parse(o)}),a,void 0);case 4:n.push("/"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),N.a.error({message:"Something went wrong!",description:e.t0.toString()});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),ue=function(e,t,n){return function(r){r.preventDefault(),n((function(n,r){n||se(e,t,r)}))}},le=S.a.create({name:"start_crawler"})((function(e){var t=e.history,n=e.match.params.storageType,r=e.form,a=r.getFieldDecorator,c=r.validateFields,i=r.getFieldValue;oe({storageType:n});return o.a.createElement(S.a,{onSubmit:ue(n,t,c)},o.a.createElement(S.a.Item,null,a("name",{rules:[{required:!0,message:"Please give a name to the project."}]})(o.a.createElement(j.a,{addonBefore:"Name",placeholder:"Project name"}))),o.a.createElement(S.a.Item,null,a("url",{rules:[{required:!0,message:"Please input an URL to crawl."}]})(o.a.createElement(j.a,{placeholder:"https://domain.com/",addonBefore:"URL",addonAfter:o.a.createElement(ee,{getFieldDecorator:a,initialValue:JSON.stringify(Q[0].value)})}))),o.a.createElement(S.a.Item,null,o.a.createElement(S.a.Item,{style:ce},a("method",{initialValue:"spiderbot"})(o.a.createElement(_.a.Group,{size:"small",style:ie},o.a.createElement(_.a.Button,{value:"spiderbot"},o.a.createElement(P.a,{type:"radar-chart"})," Spider bot"),o.a.createElement(_.a.Button,{value:"urls"},o.a.createElement(P.a,{type:"ordered-list"})," URLs list")))),"spiderbot"===i("method")&&o.a.createElement(S.a.Item,{style:ce},"Limit ",a("limit")(o.a.createElement(k.a,{min:0,size:"small"})),"\xa0",o.a.createElement(F.a,{content:o.a.createElement("div",null,o.a.createElement("b",null,"Limit the number of sibling pages. "),"For example, with the urls:",o.a.createElement("ul",null,o.a.createElement("li",null,"/item/1"),o.a.createElement("li",null,"/item/2"),o.a.createElement("li",null,"/item/3"),o.a.createElement("li",null,"/item/4"))," using the limit ",o.a.createElement("b",null,"2")," will only crawl ",o.a.createElement("b",null,"/item/1")," and ",o.a.createElement("b",null,"/item/2"),".",o.a.createElement("br",null),o.a.createElement("br",null),"Use ",o.a.createElement("b",null,"0")," to skip the limit."),trigger:"click",overlayStyle:{width:200}},o.a.createElement(P.a,{type:"question-circle"}))),o.a.createElement(V,null,o.a.createElement(p.a.Paragraph,{ellipsis:{rows:1,expandable:!0}},o.a.createElement("b",null,"Spider bot")," crawling method will get all the links inside the page of the given URL and crawl the children. It will then continue do the same with the children till no new link is found. Be careful if you have big website, this is most likely not the right solution for you."),o.a.createElement(p.a.Paragraph,{ellipsis:{rows:1,expandable:!0}},o.a.createElement("b",null,"URLs list")," crawling method will crawl a specific sets of URLs. In the URL input field you must provide an endpoint containing a list of URLs (a simple text format, with one URL per line). The crawler will crawl each of those URL only and will not try to find links in the page. To use a static list of URLs, you can use a tool like ",o.a.createElement("a",{href:"https://pastebin.com",target:"_blank",rel:"noopener noreferrer"},"https://pastebin.com"),"."))),o.a.createElement(S.a.Item,null,a("autopin",{valuePropName:"checked"})(o.a.createElement(I.a,null,"Automatically pin new page founds."))),o.a.createElement(S.a.Item,null,o.a.createElement(oe,{storageType:n})),o.a.createElement(S.a.Item,null,o.a.createElement(S.a.Item,{style:ce},o.a.createElement(z.a,{type:"primary",icon:"plus",htmlType:"submit"},"Create"))))}));!function(e){e.GitHub="github"}(W||(W={}));var pe,me,fe,de=n(34),he=n.n(de),ge=n(32),ve=n.n(ge),Ee=n(71),be=function(e){return function(t){t.preventDefault(),e((function(e,t){var n,r;e||((new te.a).set("github",t,{path:"/"}),null===(n=window)||void 0===n||null===(r=n.location)||void 0===r||r.reload())}))}},we=S.a.create({name:"github_auth"})((function(e){var t=e.form,n=t.getFieldDecorator,r=t.validateFields;return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a.Title,{level:4},"GitHub"),o.a.createElement(V,null,o.a.createElement(p.a.Paragraph,null,"In order to use ",o.a.createElement("a",{href:"https://developer.github.com/v3/",target:"_blank",rel:"noopener noreferrer"},"GitHub API"),", you need to provide some information. To be able to push data to your repository, we need a ",o.a.createElement("a",{href:"https://developer.github.com/v3/auth/#via-oauth-and-personal-access-tokens",target:"_blank",rel:"noopener noreferrer"},"personal access tokens"),". Note, the personal access tokens is a sensible information. Use this app, only on a trustable device. To ",o.a.createElement("a",{href:"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line",target:"_blank",rel:"noopener noreferrer"},"create a token"),", go in developer settings, personal access tokens and then generate new token. In most of the case you will only need to give permission for ",o.a.createElement(p.a.Text,{code:!0},"public_repo"),".")),o.a.createElement(S.a,{onSubmit:be(r)},o.a.createElement(S.a.Item,null,n("user",{rules:[{required:!0,message:"Please provide your GitHub username."}]})(o.a.createElement(j.a,{addonBefore:"Username",placeholder:"Github username"}))),o.a.createElement(S.a.Item,null,n("token",{rules:[{required:!0,message:"Please provide your personal access tokens."}]})(o.a.createElement(j.a.Password,{addonBefore:"Token",placeholder:"Personal access tokens"}))),o.a.createElement(S.a.Item,null,o.a.createElement(z.a,{type:"primary",icon:"github",htmlType:"submit"},"OK"))))})),ye=n(765),je=function(e){var t=e.storageType,n=ae((function(){return Object(G.f)(t)})).result;return n?o.a.createElement(V,null,o.a.createElement(p.a.Paragraph,null,n)):null},Oe=function(e){var t=e.title,n=e.storageType,r=function(e){var t=ae((function(){return Object(G.n)(e)})),n=t.result,r=t.error;return{projects:n,loading:t.loading,error:r,call:t.call}}(n),a=r.projects,c=r.loading,i=r.error,s=r.call,u=function(e){if(e){if(e===Ee.a.missingGitHubConfig||(null===e||void 0===e?void 0:e.message)===Ee.a.missingGitHubConfig)return we;ye.a.warning({message:"Something went wrong.",description:e.toString()})}}(i);return u?o.a.createElement(u,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a.Title,{level:4},t," ",o.a.createElement(oe,{storageType:n,loadProjects:s})),o.a.createElement(je,{storageType:n}),c?o.a.createElement(ve.a,null):o.a.createElement(he.a,{itemLayout:"horizontal",bordered:!0,dataSource:a,renderItem:function(e){var t=e.id,r=e.name,a=e.crawlerInput.url;return o.a.createElement(he.a.Item,{actions:[o.a.createElement(d.b,{to:H(n,t)},"Open")]},o.a.createElement(he.a.Item.Meta,{title:o.a.createElement(d.b,{to:H(n,t)},r," ",o.a.createElement(P.a,{type:n})),description:a}))}}))},ke=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a.Title,{level:3},"Projects"),Object.keys(W).map((function(e){return o.a.createElement("div",{key:e},o.a.createElement(Oe,{title:e,storageType:W[e]}),o.a.createElement("br",null),o.a.createElement(d.b,{to:M(W[e])},o.a.createElement(z.a,{icon:"plus",size:"small"},"New")),o.a.createElement("br",null),o.a.createElement("br",null))})))},xe=n(98),Ie=n(142),Te=n.n(Ie),Se=n(140),Ce=n.n(Se),Pe={textAlign:"center"},Re=300,Fe={width:Re+20,marginBottom:10},Le={paddingTop:10,paddingBottom:10},_e={gutter:10,fitWidth:!0},De=n(141),Ne=n.n(De),Ue=function(e){var t=e.message,n=void 0===t?"Something went wrong":t,r=e.description;return o.a.createElement(Ne.a,{message:n,description:r,type:"warning",showIcon:!0})},ze=n(306),Me=n.n(ze),Ae=n(307),Je=n.n(Ae),Be={width:Fe.width,marginRight:_e.gutter},He=function(e,t,n){return function(r){t&&(r.length?(clearTimeout(pe),pe=setTimeout((function(){qe(e,We(t,r),n)}),500)):qe(e,t,n))}},We=function(e,t){return new Me.a(e,{keys:["url","viewport.width","viewport.height","keywords"]}).search(t)},Ge=function(e,t,n){return function(r){t&&(n(r),qe(e,t,r))}},qe=function(e,t,n){if(t)if(n.length){var r=n.filter((function(e){return!Object.keys(Ve).includes(e)})).join(" ");r&&(t=We(t,r)),e(t.filter((function(e){var t=!0;if(n.includes("with-diff")){var r=Je()(e,"png.diff.pixelDiffRatio");t=t&&r>0}return n.includes("new")&&(t=t&&!!e.png&&!e.png.diff),t})))}else e(t)},Ve={"with-diff":"with diff",new:"new"},Ze=Y.a.Option,Ye=function(e){var t=e.children,n=e.response,r=e.withFilters,a=o.a.useState(),c=Object(ne.a)(a,2),i=c[0],s=c[1],u=o.a.useState([]),l=Object(ne.a)(u,2),p=l[0],m=l[1],f=o.a.useState(),d=Object(ne.a)(f,2),h=d[0],g=d[1];return o.a.useEffect((function(){s(n),Ge(g,n,m)(p)}),[n,m,p]),o.a.createElement(o.a.Fragment,null,o.a.createElement(Y.a,{mode:"tags",onChange:Ge(g,i,m),tokenSeparators:[","],style:Be,placeholder:"Search",filterOption:!1,onSearch:He(g,i,p)},!!r&&Object.keys(r).map((function(e){return o.a.createElement(Ze,{key:e},r[e])}))),t(h))},Qe=n(309),$e=n.n(Qe),Ke=n(80),Xe=function(e){return Object(Ke.unix)(parseInt(e,10)).calendar()},et=n(102),tt=n(308),nt=n(30),rt=n.n(nt),at={marginLeft:5,marginRight:5},ot=function(e,t){var n=t.timestamp,r=t.id,a=t.index,o=t.projectId,c=t.setPages,i=t.storageType;return(Object(w.a)(v.a.mark((function t(){var s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(G.v)(i,o,n,r,a,e);case 3:s=t.sent,c(s),rt.a.success("Page pinned as reference for comparison.",2),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),N.a.error({message:"Something went wrong!",description:t.t0.toString()});case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))))},ct=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(z.a,{style:at,icon:"check",size:"small",onClick:ot("valid",e)},"Valid"),o.a.createElement(z.a,{style:at,icon:"pushpin",size:"small",onClick:ot("pin",e)},"Always valid"),o.a.createElement(z.a,{style:at,icon:"warning",size:"small",type:"danger",onClick:ot("report",e)},"Report"))},it=function(e){return"valid"===e||"pin"===e?"#0F0":"report"===e?"red":"yellow"},st=function(e,t,n,r,a,o,c){var i=e.xMin,s=e.yMin,u=s/t-1,l=i/t-1;return{width:(e.xMax-i)/t+2,height:(e.yMax-s)/t+2,top:u,left:l+r,border:"1px solid ".concat(it(c)),position:"absolute",backgroundImage:o?'url("'.concat(a,'")'):"none",backgroundPosition:"".concat(-(l+1),"px ").concat(-(u+1),"px"),backgroundSize:n}},ut=function(e){var t=e.storageType,n=e.setPages,r=e.projectId,c=e.folder,i=e.id,s=e.index,u=e.originalWidth,l=e.zone,p=e.status,m=e.width,f=e.marginLeft,d=Object(a.useState)(),h=Object(ne.a)(d,2),g=h[0],E=h[1],b=function(){var e=Object(w.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=E,e.next=3,Object(G.l)(t,r,"base",i,m);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){b()}),[]);var y=Object(a.useState)(!1),j=Object(ne.a)(y,2),O=j[0],k=j[1],x=u/m;return o.a.createElement(F.a,{key:"".concat(i,"-").concat(s),content:o.a.createElement(ct,{storageType:t,index:s,timestamp:c,id:i,projectId:r,setPages:n}),trigger:"click"},o.a.createElement("div",{style:st(l,x,m,f,g,O,p),onMouseOver:function(){return k(!0)},onMouseOut:function(){return k(!1)}}))},lt=function(e){var t=e.zones;return o.a.createElement("p",null,o.a.createElement("b",null,"Zone:"),"\xa0",[["diff"],["valid","pin"],["report"]].map((function(e){var n=Object(tt.a)(e),r=n[0],a=n.slice(1);return o.a.createElement(o.a.Fragment,{key:r},o.a.createElement("span",{style:{marginLeft:10,color:it(r)}},"\u25a0")," ",o.a.createElement("b",null,function(e,t){return e.filter((function(e){var n=e.status;return t.includes(n)})).length}(t,[r].concat(Object(et.a)(a))))," ",r)})))},pt=function(e){var t=e.diff;return o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,o.a.createElement(P.a,{type:"picture",theme:"outlined"}),"\xa0 Pixel diff ratio: ",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return e;var n=t-1-Math.floor(Math.log(e)/Math.log(10));return e.toFixed(n)}(t.pixelDiffRatio)),t.zones&&t.zones.length>0&&o.a.createElement(lt,{zones:t.zones}))},mt=function(e){var t=e.diff;return t?o.a.createElement(pt,{diff:t}):o.a.createElement("div",null,o.a.createElement(P.a,{type:"picture",theme:"outlined"}),"\xa0 New screenshot ",o.a.createElement($e.a,{color:"green"},"New"))},ft=new(n(702))({fg:"#333"}),dt={marginBottom:10},ht=function(e){var t=e.pageError,n=e.url,r=e.png;return o.a.createElement(o.a.Fragment,null,t&&o.a.createElement(Ne.a,{message:o.a.createElement("div",{dangerouslySetInnerHTML:{__html:ft.toHtml(t)}}),type:"warning",style:dt}),o.a.createElement("p",null,o.a.createElement(P.a,{type:"link"})," ",o.a.createElement("a",{href:n},n)),r?o.a.createElement(mt,{diff:r.diff}):o.a.createElement("p",null,o.a.createElement(P.a,{type:"picture",theme:"outlined"})," No screenshot available"))},gt=function(e){var t=e.timestamp,n=e.id,r=e.status,a=e.projectId,o=e.setPages,c=e.storageType;return(Object(w.a)(v.a.mark((function e(){var i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(G.w)(c,a,t.toString(),n,r);case 3:i=e.sent,o(i),rt.a.success('All zone are set to "'.concat(r,'".'),2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),N.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},vt=function(e){var t=e.status,n=e.type;return o.a.createElement(P.a,{type:n,title:'Set all zone to "'.concat(t,'".'),onClick:gt(e)})},Et=function(e){var t=e.storageType,n=e.projectId,r=e.timestamp,a=e.id;return(Object(w.a)(v.a.mark((function e(){var o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=rt.a.loading("Pin in progress..",0),e.next=4,Object(G.p)(t,n,r.toString(),a);case 4:o(),rt.a.success("Page pinned as reference for comparison.",2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),N.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},bt=function(e){return function(e){return o.a.createElement(P.a,{type:"pushpin",title:"pin as reference for comparison",onClick:Et(e)})}(e)},wt=n(310),yt=n.n(wt),jt=function(e){var t=e.storageType,n=e.projectId,r=e.folder,c=e.id,i=e.onImg,s=void 0===i?function(){}:i,u=e.width,l=void 0===u?Re:u,p=e.children,m=Object(a.useState)(),f=Object(ne.a)(m,2),d=f[0],h=f[1],g=function(){var e=Object(w.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=h,e.next=3,Object(G.l)(t,n,r,c,l);case 3:e.t1=e.sent,(0,e.t0)(e.t1),s();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){g()}),[]),d?o.a.createElement("div",{style:Pe},p,o.a.createElement("img",{style:{width:l},alt:"",src:d})):null},Ot=function(e){var t=e.storageType,n=e.projectId,r=e.folder,a=e.id,c=e.zones,i=e.originalWidth,s=void 0===i?0:i,u=e.width,l=void 0===u?Re:u,p=e.setPages,m=e.marginLeft,f=Object(b.a)(e,["storageType","projectId","folder","id","zones","originalWidth","width","setPages","marginLeft"]);return o.a.createElement(jt,Object.assign({storageType:t,projectId:n,folder:r,id:a,width:l},f),c&&c.map((function(e,c){var i=e.zone,u=e.status;return o.a.createElement(ut,{storageType:t,projectId:n,folder:r,id:a,width:l,index:c,originalWidth:s,marginLeft:m,status:u,zone:i,key:"zone-".concat(a,"-").concat(c),setPages:p})})))},kt=function(e){return function(){e(!0)}},xt=function(e){return function(){e(!1)}},It=function(e){var t=e.storageType,n=e.setPages,r=e.projectId,a=e.timestamp,c=e.id,i=e.png,s=e.url,u=e.pageError,l=o.a.useState(!1),p=Object(ne.a)(l,2),m=p[0],f=p[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(yt.a,{title:"",visible:m,onCancel:xt(f),footer:null,width:i.width+40},o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(Ot,{storageType:t,setPages:n,projectId:r,folder:a,id:c,zones:i.diff&&i.diff.zones,originalWidth:i.width,width:i.width,marginLeft:0}),o.a.createElement(ht,{url:s,pageError:u,png:i}))),o.a.createElement(P.a,{type:"fullscreen",title:"fullscreen",onClick:kt(f)}))},Tt=function(e){var t=e.storageType,n=e.setPages,r=e.projectId,a=e.timestamp,c=e.id,i=e.png,s=e.url,u=e.pageError;return[i&&o.a.createElement(It,{storageType:t,setPages:n,projectId:r,png:i,id:c,timestamp:a,url:s,pageError:u})].concat([o.a.createElement(vt,{storageType:t,type:"check",setPages:n,projectId:r,timestamp:a,id:c,status:"valid"}),o.a.createElement(vt,{storageType:t,type:"warning",setPages:n,projectId:r,timestamp:a,id:c,status:"report"}),o.a.createElement(bt,{storageType:t,projectId:r,timestamp:a,id:c})])},St=function(e){return me=e},Ct=function(){me&&me.layout(),clearTimeout(fe),fe=setTimeout((function(){me&&me.layout()}),500)},Pt=function(e){var t=e.projectId,n=e.timestamp,r=e.lastUpdate,a=e.storageType,c=ae((function(){return Object(G.h)(a,t,n)}),[r]),i=c.result,s=c.error,u=c.setResult;return s?o.a.createElement(Ue,{description:s.toString()}):o.a.createElement(Ye,{response:i,withFilters:Ve},(function(e){return e?o.a.createElement(Ce.a,{style:Le,options:_e,ref:function(e){St(e&&e.masonry)}},e.map((function(e){var r=e.id,c=e.url,i=e.png,s=e.error;return o.a.createElement(Te.a,{key:r,style:Fe,cover:i&&o.a.createElement(Ot,{storageType:a,projectId:t,folder:n,id:r,zones:i.diff&&i.diff.zones,originalWidth:i.width,onImg:Ct,setPages:u,marginLeft:10}),actions:Tt({storageType:a,setPages:u,projectId:t,id:r,timestamp:n,png:i,url:c,pageError:s})},o.a.createElement(ht,{url:c,pageError:s,png:i}))}))):o.a.createElement(ve.a,null)}))},Rt=n(143),Ft=n.n(Rt),Lt=(n(734),n(311)),_t=n.n(Lt),Dt=function(e,t,n,r){return function(){var a=Object(w.a)(v.a.mark((function a(o){var c,i;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c=o?"done":"review",a.next=4,Object(G.u)(e,t,n,c);case 4:i=a.sent,r(i),rt.a.success('Status set to "'.concat(c,'".'),2),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),N.a.error({message:"Something went wrong!",description:a.t0.toString()});case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}()},Nt=function(e){var t=e.storageType,n=e.timestamp,r=e.status,a=e.projectId,c=e.setCrawler;return o.a.createElement(_t.a,{checkedChildren:"done",unCheckedChildren:"review",checked:"done"===r,onChange:Dt(t,a,n,c)})},Ut=function(e,t){var n=ae((function(){return Object(G.m)(e,t)})),r=n.result,a=n.setResult,o=n.error;return o&&N.a.warning({message:"Something went wrong while loading project.",description:o.toString()}),{project:r,setProject:a}},zt=function(e){var t=e.projectId,n=e.storageType,r=Ut(n,t).project;return r?o.a.createElement("p",null,o.a.createElement("b",null,"Project:")," ",o.a.createElement(d.b,{to:H(n,r.id)},r.name)):null},Mt=p.a.Title,At={color:"#faad29"},Jt={color:"#999",fontSize:11},Bt=function(e){var t=e.crawler,n=t.timestamp,r=t.url,a=t.diffZoneCount,c=t.errorCount,i=t.status,s=t.urlsCount,u=t.inQueue,l=t.startAt,p=t.lastUpdate,m=t.limit,f=t.viewport,d=e.projectId,h=e.storageType,g=e.setCrawler,v=s+u,E=Math.floor(s/v*100),b=K(f);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Mt,{level:3},Xe(n)),(a>0||c>0)&&o.a.createElement("p",null,o.a.createElement(Nt,{storageType:h,setCrawler:g,projectId:d,status:i,timestamp:n})),o.a.createElement(zt,{projectId:d,storageType:h}),o.a.createElement("p",null,o.a.createElement("b",null,"URL:")," ",r),o.a.createElement("p",null,o.a.createElement("b",null,"Screen:")," ",b),o.a.createElement("p",null,o.a.createElement("b",null,"URL crawled:")," ",s,void 0!==m&&m>0&&o.a.createElement("span",{style:Jt}," (with limit set to ",m,")")),o.a.createElement("p",null,o.a.createElement("b",null,"Duration:")," ",Object(Ke.duration)(p-l).format("h [hrs], m [min], s [sec]")),u>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ft.a,{percent:E}),o.a.createElement("p",null,o.a.createElement("b",null,"In queue:")," ",u)),c>0&&o.a.createElement("p",{style:At},o.a.createElement(P.a,{type:"exclamation-circle"})," ",c," error(s) founds"))},Ht=function(e){var t=e.match.params,n=t.timestamp,r=t.projectId,a=t.storageType,c=ae((function(){return Object(G.d)(a,r,n)})),i=c.result,s=c.error,u=c.setResult;if(o.a.useEffect((function(){var e=Object(xe.subscrib)(u);return function(){return Object(xe.unsubscrib)(e)}}),[i,u]),s)return o.a.createElement(Ue,{description:s.toString()});var l=null===i||void 0===i?void 0:i.lastUpdate;return i?o.a.createElement(o.a.Fragment,null,o.a.createElement(Bt,{crawler:i,projectId:r,storageType:a,setCrawler:u}),o.a.createElement(Pt,{storageType:a,timestamp:n,lastUpdate:l,projectId:r})):o.a.createElement(ve.a,null)},Wt=n(312),Gt=n.n(Wt),qt=function(e,t,n,r){return Object(w.a)(v.a.mark((function a(){var o,c;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=rt.a.loading("Delete in progress..",0),a.next=3,Object(G.q)(e,t,n);case 3:c=a.sent,r(c),o();case 6:case"end":return a.stop()}}),a)})))},Vt=function(e){var t=e.storageType,n=e.projectId,r=e.id,a=e.url,c=e.viewport,i=e.onImg,s=e.png,u=e.setPins;return o.a.createElement(Te.a,{style:Fe,cover:s&&o.a.createElement(jt,{folder:"base",id:r,onImg:i,projectId:n}),actions:[o.a.createElement(Gt.a,{title:"Are you sure delete this pin?",onConfirm:qt(t,n,r,u),okText:"Yes",cancelText:"No"},o.a.createElement(P.a,{type:"delete",title:"Delete pin"})),o.a.createElement(d.b,{to:{pathname:J(t,n,r),state:{pattern:a}}},o.a.createElement(P.a,{type:"code",title:"Insert code while crawling"}))]},o.a.createElement("p",null,o.a.createElement(P.a,{type:"link"})," ",o.a.createElement("a",{href:a},a)),!s&&o.a.createElement("p",null,o.a.createElement(P.a,{type:"picture",theme:"outlined"})," No screenshot available"),c&&o.a.createElement("p",null,o.a.createElement(P.a,{type:"picture",theme:"outlined"})," ",K(c)))},Zt=p.a.Title,Yt=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,a=ae((function(){return Object(G.i)(r,n)})),c=a.result,i=a.error,s=a.setResult;return i?o.a.createElement(Ue,{description:i.toString()}):o.a.createElement(o.a.Fragment,null,o.a.createElement(Zt,{level:3},"Pins"),o.a.createElement(zt,{projectId:n,storageType:r}),o.a.createElement(Ye,{response:c},(function(e){return e?o.a.createElement(Ce.a,{style:Le,options:_e,ref:function(e){St(e&&e.masonry)}},e.map((function(e){var t=e.id,a=e.url,c=e.png,i=e.viewport;return o.a.createElement(Vt,{projectId:n,id:t,key:t,url:a,setPins:s,png:c,viewport:i,onImg:Ct,storageType:r})}))):o.a.createElement(ve.a,null)})))},Qt=n(144),$t=n.n(Qt),Kt=(n(292),n(293),p.a.Paragraph),Xt=p.a.Text,en=function(e){var t=e.full,n=void 0===t||t;return o.a.createElement(V,null,o.a.createElement(Kt,null,"Inject some code in the crawler while parsing the page. This code will be executed just after the page finish loaded, before to make the screenshot and before extracting the links. ",n&&o.a.createElement(o.a.Fragment,null,"You need to export a function that will take as first parameter the ",o.a.createElement(Xt,{code:!0},"page")," coming from Puppeteer.")),n&&o.a.createElement(Kt,null,o.a.createElement(Xt,{code:!0},"module.exports = async (page) => ...some code")))},tn={border:"1px solid #EEE",marginBottom:15,width:"auto"},nn=(Object(E.a)({},Fe,{float:"left"}),{marginBottom:15}),rn={marginRight:10},an={maxWidth:500,margin:"0px 0px 10px 0px"},on=n(313),cn=n.n(on),sn=n(50),un=n.n(sn),ln=p.a.Paragraph,pn=function(){rt.a.warn("To be implemented.",2)},mn=function(){var e=Object(w.a)(v.a.mark((function e(t,n,r,a,o){var c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=rt.a.loading("Saving in progress...",0),e.next=4,Object(G.t)(t,n,Object(E.a)({id:r,source:a},o));case 4:c(),rt.a.success("Code saved.",2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),N.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,r,a,o){return e.apply(this,arguments)}}(),fn=function(e,t,n,r,a){return function(o){o.preventDefault(),a((function(a,o){a||mn(e,t,n,r,o)}))}},dn=S.a.create({name:"code"})((function(e){var t,n=e.storageType,r=e.projectId,a=e.setSource,c=e.id,i=e.code,s=e.form,u=s.getFieldDecorator,l=s.validateFields,p=e.location.state;return o.a.createElement(S.a,{onSubmit:fn(n,r,c,i.source,l)},o.a.createElement(S.a.Item,{style:an},u("name",{initialValue:i.name||""})(o.a.createElement(j.a,{addonBefore:"Name"}))),o.a.createElement(S.a.Item,{style:an},u("pattern",{rules:[{required:!0,message:"Please input a pattern!"}],initialValue:i.pattern||p&&p.pattern||""})(o.a.createElement(j.a,{addonBefore:"Pattern"}))),o.a.createElement(V,null,o.a.createElement(ln,null,"Pattern is using ",o.a.createElement("a",{href:"https://www.npmjs.com/package/minimatch",target:"_blank",rel:"noopener noreferrer"},"minimatch")," to match the urls to inject the code. It works by converting glob expressions into JavaScript RegExp objects.")),o.a.createElement("div",{style:nn},o.a.createElement(z.a,{icon:"save",htmlType:"submit",style:rn},"Save"),o.a.createElement(z.a,{icon:"caret-right",onClick:pn,style:rn},"Preview"),o.a.createElement(cn.a,{overlay:(t=a,o.a.createElement(un.a,null,o.a.createElement(un.a.Item,{key:"1",onClick:function(){t('module.exports = async function run(page) {\n    await page.evaluate(() => {\n        const div = document.createElement("div");\n        div.innerHTML = "Test-crawler is awesome!";\n        document.body.insertBefore(div, document.body.firstChild);\n    });\n}')}},"Test-crawler is awesome"),o.a.createElement(un.a.Item,{key:"2",onClick:function(){t("module.exports = async function run(page) {\n    return await page.evaluate(() => {\n        Array.from(document.body.getElementsByTagName(\"a\"))\n             .filter(a => !a.href)\n             .forEach(a => a.click());\n        return Array.from(document.links).map(\n            link => link.href.replace('/?', '/iframe.html?')\n        );\n    });\n}")}},"Storybook"),o.a.createElement(un.a.Item,{key:"3",onClick:function(){t("// expect library from jest is installed by default\n// but you can use any assertion tool of your choice\n// just install it and use it here :D\nconst expect = require('expect');\n\nmodule.exports = async function run(page) {\n  await expect(page.title()).resolves.toMatch('React App');\n  expect('a').toBe('b'); // fail\n}")}},"Expect assetion example")))},o.a.createElement(z.a,{style:rn},"Code snippet ",o.a.createElement(P.a,{type:"down"})))))})),hn=p.a.Title,gn=function(e,t){return function(n){t(Object(E.a)({},e,{source:n}))}},vn=function(e){var t=e.match.params,n=t.id,r=t.projectId,a=t.storageType,c=e.location,i=ae((function(){return Object(G.b)(a,r,n)})),s=i.error,u=i.result,l=i.setResult;return s?o.a.createElement(Ue,{description:s.toString()}):o.a.createElement(o.a.Fragment,null,o.a.createElement(hn,{level:3},"Add some code"),u?o.a.createElement(S.a,null,o.a.createElement(en,null),o.a.createElement(zt,{projectId:r,storageType:a}),o.a.createElement(dn,{projectId:r,id:n,code:u,setSource:gn(u,l),location:c,storageType:a}),o.a.createElement($t.a,{mode:"javascript",theme:"tomorrow",onChange:gn(u,l),fontSize:14,value:u.source.length?u.source:"module.exports = async function run(page) {\n// your code\n}",style:tn})):o.a.createElement(ve.a,null))},En=p.a.Title,bn=function(){var e=Object(w.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,Object(G.k)();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),wn=function(){var e=o.a.useState(),t=Object(ne.a)(e,2),n=t[0],r=t[1];return o.a.useEffect((function(){bn(r)}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement(En,{level:3},"Settings"),n?o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,o.a.createElement("b",null,"Dir:")," ",n.dir)):o.a.createElement(ve.a,null),o.a.createElement("p",null,o.a.createElement(z.a,{icon:"caret-right",size:"small",onClick:G.y},"Start crawlers")))},yn=n(86),jn=p.a.Title,On=p.a.Text,kn=function(e){var t=e.projectId,n=e.storageType,r=ae((function(){return Object(G.c)(n,t)})),a=r.error,c=r.result;return a?o.a.createElement(Ue,{description:a.toString()}):o.a.createElement(o.a.Fragment,null,o.a.createElement(jn,{level:4},"For each page"),o.a.createElement(en,{full:!1}),c?o.a.createElement(he.a,{bordered:!0,dataSource:Object.values(c),renderItem:function(e){var r=e.id,a=e.name,c=e.pattern;return o.a.createElement(he.a.Item,{actions:[o.a.createElement(d.b,{to:J(n,t,r)},"Edit")]},o.a.createElement(he.a.Item.Meta,{title:o.a.createElement(d.b,{to:J(n,t,r)},a," ",o.a.createElement(On,{code:!0},c))}))}}):o.a.createElement(ve.a,null),o.a.createElement("br",null),o.a.createElement(d.b,{to:J(n,t,Math.floor(Date.now()/1e3).toString())},o.a.createElement(z.a,{icon:"plus",size:"small"},"New code")))},xn=p.a.Title,In=p.a.Paragraph,Tn=function(e,t,n,r){return Object(w.a)(v.a.mark((function a(){var o;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,o=rt.a.loading("Saving...",0),a.next=4,Object(G.r)(r,n,t,e);case 4:o(),rt.a.success("Code saved.",2),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),N.a.error({message:"Something went wrong!",description:a.t0.toString()});case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))},Sn=function(e){var t=e.type,n=e.projectId,r=e.storageType,a=e.title,c=e.info,i=e.codeParam,s=void 0===i?"":i,u=ae((function(){return Object(G.a)(r,n,t)})),l=u.error,p=u.result,m=u.setResult;return l?o.a.createElement(Ue,{description:l.toString()}):o.a.createElement(o.a.Fragment,null,o.a.createElement(xn,{level:4},a),o.a.createElement(V,null,o.a.createElement(In,null,c)),o.a.createElement($t.a,{mode:"javascript",theme:"tomorrow",onChange:m,fontSize:14,value:(null===p||void 0===p?void 0:p.length)?p:"module.exports = async function run(".concat(s,") {\n// your code\n}"),style:Object(E.a)({},tn,{height:200})}),o.a.createElement(z.a,{icon:"save",size:"small",onClick:Tn(p,t,n,r)},"Save"))},Cn=p.a.Title,Pn=(p.a.Text,function(e){var t=e.projectId,n=e.storageType,r=ae((function(){return Object(G.c)(n,t)})),a=r.error;r.result;return a?o.a.createElement(Ue,{description:a.toString()}):o.a.createElement(o.a.Fragment,null,o.a.createElement(Cn,{level:3},"Codes"),o.a.createElement(kn,{projectId:t,storageType:n}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(Sn,{type:yn.a.Before,projectId:t,storageType:n,title:"Before all",info:"This script will run when the test-crawler is starting, to give you the possibility to setup a working environment, for example to start a test server."}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(Sn,{type:yn.a.After,projectId:t,storageType:n,title:"After all",info:"This script will run when the test-crawler finish. You could for example use this script to send some notification.",codeParam:"totalDiffCount, totalErrorCount"}))}),Rn=function(e){var t=e.jobs,n=e.loadJobs,r=e.loadCrawlers,a=o.a.useState(!1),c=Object(ne.a)(a,2),i=c[0],s=c[1];return o.a.useEffect((function(){var e;return(null===t||void 0===t?void 0:t.length)?(!i&&s(!0),e=setInterval(n,3e4)):i&&(s(!1),r()),function(){return clearInterval(e)}}),[t]),(null===t||void 0===t?void 0:t.length)?o.a.createElement(he.a,{itemLayout:"horizontal",bordered:!0,dataSource:t,style:{marginBottom:10},renderItem:function(e){var t=e.status,n=e.startAt,r=e.stepsCount,a=e.stepsDone,c=e.currentStep,i=e.url;return o.a.createElement(he.a.Item,{actions:[o.a.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},"Open")]},o.a.createElement(he.a.Item.Meta,{title:o.a.createElement("span",null,"CI job ",Xe(n.toString())),description:o.a.createElement(o.a.Fragment,null,!!r&&void 0!==a&&o.a.createElement(Ft.a,{percent:100/r*a,size:"small",format:function(){return"".concat(a," of ").concat(r)}}),o.a.createElement("span",null,o.a.createElement(p.a.Text,{code:!0},t)," ",c))}))}}):null},Fn=function(e,t,n,r){return Object(w.a)(v.a.mark((function a(){var c,i,s,u;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c=rt.a.loading("Starting crawlers",0),a.next=4,Object(G.x)(n,t);case 4:i=a.sent,s=i.timestamp,(u=i.redirect)?(setTimeout(r,5e3),setTimeout(r,1e4),N.a.open({duration:10,message:"Test-crawler started",description:"Test-crawler is running the crawlers on a remote container. To see live progress click open:",btn:o.a.createElement("a",{href:u,target:"_blank",rel:"noopener noreferrer"},"Open")})):e.push(B(n,t,s)),c(),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),N.a.error({message:"Something went wrong!",description:a.t0.toString()});case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))},Ln=function(e,t,n){var r=t.name,a=t.id,o=t.crawlerInput;return(function(){var t=Object(w.a)(v.a.mark((function t(c){var i,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.target.checked,t.next=3,Object(G.s)(e,Object(E.a)({},o,{autopin:i}),r,a);case 3:s=t.sent,n(s);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},_n=function(e,t,n,r){return r>0?"loading":e||0!==t?"done"===n?"issues-close":"exclamation-circle":"check"},Dn=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,a=e.history,c=Ut(r,n),i=c.project,s=c.setProject,u=function(e,t){var n=ae(Object(w.a)(v.a.mark((function n(){var r;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(G.e)(e,t);case 2:return r=n.sent,n.abrupt("return",r.sort((function(e,t){var n=e.timestamp,r=t.timestamp;return parseInt(r,10)-parseInt(n,10)})));case 4:case"end":return n.stop()}}),n)})))),r=n.result,a=n.setResult,o=n.error,c=n.loading,i=n.call;return o&&N.a.warning({message:"Something went wrong while loading crawlers from project.",description:o.toString()}),{crawlers:r,setCrawlers:a,loading:c,loadCrawlers:i}}(r,n),l=u.crawlers,m=u.loading,f=u.loadCrawlers,h=ae((function(){return Object(G.g)(r,n)})),g=h.result,E=h.call;return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a.Title,{level:3},"Project"),i?o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,o.a.createElement("b",null,"Name:")," ",i.name),o.a.createElement("p",null,o.a.createElement("b",null,"ID:")," ",n),o.a.createElement("p",null,o.a.createElement("b",null,"URL:")," ",i.crawlerInput.url),o.a.createElement("p",null,o.a.createElement("b",null,"Screen:")," ",K(i.crawlerInput.viewport)),o.a.createElement("p",null,o.a.createElement("b",null,"Method:"),"urls"===i.crawlerInput.method?o.a.createElement(o.a.Fragment,null," ",o.a.createElement(P.a,{type:"ordered-list"})," URLs list"):o.a.createElement(o.a.Fragment,null," ",o.a.createElement(P.a,{type:"radar-chart"})," Spider bot",!!i.crawlerInput.limit&&o.a.createElement("span",{style:{color:"#999",fontSize:12}}," (Limit: ",i.crawlerInput.limit,")"))),o.a.createElement("p",null,o.a.createElement(I.a,{checked:i.crawlerInput.autopin,onChange:Ln(r,i,s)},"Automatically pin new page founds.")),o.a.createElement("p",null,o.a.createElement(z.a,{icon:"caret-right",size:"small",onClick:Fn(a,n,r,E)},"Run")," \xa0",o.a.createElement(d.b,{to:A(r,n)},o.a.createElement(z.a,{icon:"pushpin",size:"small"},"Pins"))),o.a.createElement(Rn,{jobs:g,loadJobs:E,loadCrawlers:f}),o.a.createElement(he.a,{itemLayout:"horizontal",bordered:!0,loading:m,dataSource:l,renderItem:function(e){var t=e.timestamp,a=e.diffZoneCount,c=e.errorCount,i=e.status,s=e.inQueue;return o.a.createElement(he.a.Item,{actions:[o.a.createElement(d.b,{to:B(r,n,t)},"Open")]},o.a.createElement(he.a.Item.Meta,{title:o.a.createElement(d.b,{to:B(r,n,t)},Xe(t)),description:o.a.createElement(o.a.Fragment,null,o.a.createElement(P.a,{type:_n(a,c,i,s)}),o.a.createElement("span",null," Diff: ",a," - Error: ",c," - In queue: ",s))}))}})):o.a.createElement(ve.a,null),o.a.createElement("br",null),o.a.createElement(Pn,{projectId:n,storageType:r}))},Nn=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,a=Ut(r,n).project;return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:"/"},"Projects")),o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:H(r,n)},null===a||void 0===a?void 0:a.name)))},Un=function(e){var t=e.match.params,n=t.projectId,r=t.timestamp,a=t.storageType,c=Ut(a,n).project;return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:"/"},"Projects")),o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:H(a,n)},null===c||void 0===c?void 0:c.name)),o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:B(a,n,r)},"Results: ",Xe(r))))},zn=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,a=Ut(r,n).project;return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:"/"},"Projects")),o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:H(r,n)},null===a||void 0===a?void 0:a.name)),o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:A(r,n)},"Pins")))},Mn=function(e){var t=e.match.params,n=t.projectId,r=t.id,a=t.storageType,c=Ut(a,n).project;return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:"/"},"Projects")),o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:H(a,n)},null===c||void 0===c?void 0:c.name)),o.a.createElement(f.a.Item,null,o.a.createElement(d.b,{to:J(a,n,r)},"Code")))},An=u.a.Content,Jn=u.a.Header,Bn=p.a.Title,Hn={minHeight:"100vh"},Wn={color:"#fff",marginTop:15,marginRight:15,float:"left"},Gn={background:"#fff",padding:24,margin:10,minHeight:280},qn=function(){return o.a.createElement(d.a,null,o.a.createElement(u.a,{style:Hn},o.a.createElement(Jn,null,o.a.createElement(d.b,{to:"/"},o.a.createElement(Bn,{level:3,style:Wn},"Test-crawler")),o.a.createElement(un.a,{theme:"dark",mode:"horizontal",style:{lineHeight:"64px"}},o.a.createElement(un.a.Item,{key:"projects"},o.a.createElement(P.a,{type:"folder"}),o.a.createElement("span",{className:"nav-text"},"Projects"),o.a.createElement(d.b,{to:"/"})),o.a.createElement(un.a.Item,{key:"settings",style:{float:"right"}},o.a.createElement(d.b,{to:"/settings"},o.a.createElement(P.a,{type:"setting"}))))),o.a.createElement(f.a,{style:{margin:"10px 0 0 10px"}},o.a.createElement(h.a,{path:H(":storageType",":projectId"),exact:!0,component:Nn}),o.a.createElement(h.a,{path:B(":storageType",":projectId",":timestamp"),exact:!0,component:Un}),o.a.createElement(h.a,{path:A(":storageType",":projectId"),exact:!0,component:zn}),o.a.createElement(h.a,{path:J(":storageType",":projectId",":id"),exact:!0,component:Mn})),o.a.createElement(An,{style:Gn},o.a.createElement(h.a,{path:"/",exact:!0,component:ke}),o.a.createElement(h.a,{path:"/settings",exact:!0,component:wn}),o.a.createElement(h.a,{path:"/auth/github",exact:!0,component:we}),o.a.createElement(h.a,{path:M(":storageType"),exact:!0,component:le}),o.a.createElement(h.a,{path:A(":storageType",":projectId"),exact:!0,component:Yt}),o.a.createElement(h.a,{path:J(":storageType",":projectId",":id"),exact:!0,component:vn}),o.a.createElement(h.a,{path:B(":storageType",":projectId",":timestamp"),component:Ht}),o.a.createElement(h.a,{path:H(":storageType",":projectId"),exact:!0,component:Dn}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Vn=n(314);"apiel.github.io"===window.location.host&&Vn.hotjar.initialize(1680523,6),i.a.render(o.a.createElement(r.a,null,o.a.createElement(qn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},86:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Before="before",e.After="after"}(r||(r={}))},88:function(e,t,n){"use strict";var r=n(2),a=n.n(r),o=n(9),c=n(49),i=n(81),s=n(84),u=n(82),l=n(85),p=n(83),m=n(299),f=function e(){Object(c.a)(this,e)};n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return g}));var d=new m.a;function h(e,t){return(new p.a).get(e)}var g=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(s.a)(this,Object(u.a)(t).call(this))).ctx=n,r.storage=d,r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"startCrawlers",value:function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),t}(f)}},[[316,1,2]]]);
//# sourceMappingURL=main.40371ca4.chunk.js.map