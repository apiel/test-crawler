(this["webpackJsonptest-crawler"]=this["webpackJsonptest-crawler"]||[]).push([[0],{12:function(e,t,n){"use strict";(function(e){n.d(t,"k",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"j",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"m",(function(){return f})),n.d(t,"n",(function(){return d})),n.d(t,"s",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return E})),n.d(t,"r",(function(){return w})),n.d(t,"a",(function(){return y})),n.d(t,"t",(function(){return j})),n.d(t,"b",(function(){return k})),n.d(t,"c",(function(){return O})),n.d(t,"l",(function(){return x})),n.d(t,"q",(function(){return T})),n.d(t,"p",(function(){return S})),n.d(t,"v",(function(){return C})),n.d(t,"w",(function(){return R})),n.d(t,"u",(function(){return F})),n.d(t,"x",(function(){return _})),n.d(t,"y",(function(){return D}));var r=n(2),a=n.n(r),o=n(9),i=n(21);function c(){return l.apply(this,arguments)}function l(){return(l=Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{dir:e});case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function s(e){return new i.a(e,this).info()}function u(e,t){return new i.a(e,this).jobs(t)}function p(e){return new i.a(e,this).repo()}function m(e){return new i.a(e,this).repos()}function f(e,t){return new i.a(e,this).loadProject(t)}function d(e){return new i.a(e,this).loadProjects()}function h(e,t,n,r){return new i.a(e,this).saveProject(t,n,r)}function g(e,t,n){return new i.a(e,this).getCrawler(t,n)}function v(e,t){return new i.a(e,this).getAllCrawlers(t)}function b(e,t,n){return new i.a(e,this).getPages(t,n)}function E(e,t){return new i.a(e,this).getPins(t)}function w(e,t,n,r){return new i.a(e,this).saveBeforeAfterCode(t,n,r)}function y(e,t,n){return new i.a(e,this).getBeforeAfterCode(t,n)}function j(e,t,n){return new i.a(e,this).saveCode(t,n)}function k(e,t,n){return new i.a(e,this).loadCode(t,n)}function O(e,t){return new i.a(e,this).getCodeList(t)}function x(e,t,n,r){return I.apply(this,arguments)}function I(){return(I=Object(o.a)(a.a.mark((function e(t,n,r,o){var c,l,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.length>4&&void 0!==s[4]?s[4]:300,c=new i.a(t,this),e.next=4,c.image(n,r,o);case 4:if(l=e.sent){e.next=7;break}throw new Error("Cannot load image.");case 7:return e.abrupt("return","data:image/png;base64, ".concat(l.toString("base64")));case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function T(e,t,n){return new i.a(e,this).removeFromPins(t,n)}function S(e,t,n,r){return new i.a(e,this).copyToPins(t,n,r)}function C(e,t,n,r,a,o){return P.apply(this,arguments)}function P(){return(P=Object(o.a)(a.a.mark((function e(t,n,r,o,c,l){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new i.a(t,this),e.next=3,s.setZoneStatus(n,r,o,c,l);case 3:return e.abrupt("return",b(t,n,r));case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function R(e,t,n,r,a){return L.apply(this,arguments)}function L(){return(L=Object(o.a)(a.a.mark((function e(t,n,r,o,c){var l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=new i.a(t,this),e.next=3,l.setZonesStatus(n,r,o,c);case 3:return e.abrupt("return",b(t,n,r));case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function F(e,t,n,r){return new i.a(e,this).setCrawlerStatus(t,n,r)}function _(e,t){return new i.a(e,this).startCrawler(t)}function D(){return new i.a(void 0,this).startCrawlers()}}).call(this,"/")},21:function(e,t,n){"use strict";var r=n(23),a=n(24),o=n(60),i=n(2),c=n.n(i),l=n(9),s=n(51),u=n(83),p=n(85),m=n(84),f=n(86),d=n(42),h=n(133),g=n(300),v=function(e,t){return function(n){return Object(d.join)(t,"".concat(e,".").concat(n))}},b=n(46),E=function(e){function t(e,n){var r;return Object(s.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e,n))).ctx=n,r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"repos",value:function(){return this.storage.repos()}},{key:"repo",value:function(){return this.storage.getRepo()}},{key:"info",value:function(){return this.storage.info()}},{key:"jobs",value:function(e){return this.storage.jobs(e)}},{key:"loadProject",value:function(e){return this.storage.readJSON(this.join(e,"project.json"))}},{key:"loadProjects",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.readdir(r.PROJECT_FOLDER);case 2:return t=e.sent,e.abrupt("return",Promise.all(t.map((function(e){return n.loadProject(e)}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveProject",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r||(r=h(n)),a={id:r,name:n,crawlerInput:t},e.next=4,this.storage.saveJSON(this.join(r,"project.json"),a);case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getCrawler",value:function(e,t){var n=this.join(e,r.CRAWL_FOLDER,t,"_.json");return this.storage.readJSON(n)}},{key:"getAllCrawlers",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,o,i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.join(t,r.CRAWL_FOLDER),e.next=3,this.storage.readdir(n);case 3:return a=e.sent,e.next=6,Promise.all(a.map((function(e){return i.getCrawler(t,e)})));case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"copyToPins",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,a){var o,i,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.join(t,r.CRAWL_FOLDER,n),i=v(a,o),e.next=4,this.storage.readJSON(i("json"));case 4:if(!(null===(l=e.sent)||void 0===l?void 0:l.png)){e.next=10;break}if(l.png.diff={pixelDiffRatio:0,zones:[]},!(l.png.diff.pixelDiffRatio>0)){e.next=10;break}return e.next=10,this.storage.saveJSON(i("json"),l);case 10:return s=v(a,this.join(t,r.PIN_FOLDER)),e.next=13,this.storage.saveJSON(s("json"),l);case 13:return e.next=15,this.storage.copy(i("html"),s("html"));case 15:return e.next=17,this.storage.copy(i("png"),s("png"));case 17:return e.abrupt("return",l);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"removeFromPins",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v(n,this.join(t,r.PIN_FOLDER)),e.next=3,this.storage.remove(a("png"));case 3:return e.next=5,this.storage.remove(a("html"));case 5:return e.next=7,this.storage.remove(a("json"));case 7:return e.abrupt("return",this.getPins(t));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"image",value:function(e,t,n){var a="base"===t?this.join(e,r.PIN_FOLDER):this.join(e,r.CRAWL_FOLDER,t);return this.storage.blob(v(n,a)("png"))}},{key:"saveBeforeAfterCode",value:function(e,t,n){if(!Object.values(b.a).includes(t))throw new Error("Unknown code type ".concat(t,"."));var r=this.join(e,"".concat(t,".js"));return n.length?this.storage.saveFile(r,n):this.storage.remove(r)}},{key:"getBeforeAfterCode",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.values(b.a).includes(n)){e.next=2;break}throw new Error("Unknown code type ".concat(n,"."));case 2:return e.prev=2,e.next=5,this.storage.read(this.join(t,"".concat(n)));case 5:return r=e.sent,e.abrupt("return",(null===r||void 0===r?void 0:r.toString())||"");case 9:e.prev=9,e.t0=e.catch(2);case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveCode",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var i,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.source,l=Object(o.a)(n,["source"]),e.next=3,this.getCodeList(t);case 3:return(s=e.sent)[n.id]=l,e.next=7,this.storage.saveJSON(this.join(t,r.CODE_FOLDER,"list.json"),Object(a.a)({},s));case 7:return e.next=9,this.storage.saveFile(this.join(t,r.CODE_FOLDER,"".concat(n.id,".js")),i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadCode",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var o,i,l,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCodeList(t);case 2:if(o=e.sent,i=o[n],l=this.join(t,r.CODE_FOLDER,"".concat(n,".js")),!i){e.next=12;break}return e.next=8,this.storage.read(l);case 8:if(!(s=e.sent)){e.next=12;break}return u=s.toString(),e.abrupt("return",Object(a.a)({},i,{source:u}));case 12:return e.abrupt("return",{id:n,name:"",pattern:"",source:""});case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCodeList",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.length>1&&void 0!==o[1]&&o[1],n=this.join(t,r.CODE_FOLDER,"list.json"),e.next=4,this.storage.readJSON(n);case 4:return a=e.sent,e.abrupt("return",a||{});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPins",value:function(e){return this.getPinsInFolder(this.join(e,r.PIN_FOLDER))}},{key:"getPin",value:function(e,t){return this.getPageInFolder(this.join(e,r.PIN_FOLDER),t)}},{key:"getPages",value:function(e,t){return this.getPinsInFolder(this.join(e,r.CRAWL_FOLDER,t))}},{key:"getPageInFolder",value:function(e,t){return this.storage.readJSON(v(t,e)("json"))}},{key:"getPinsInFolder",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.readdir(t);case 2:return n=e.sent,e.abrupt("return",Promise.all(n.filter((function(e){return".json"===Object(d.extname)(e)&&"_.json"!==e})).map((function(e){return r.storage.readJSON(Object(d.join)(t,e))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCrawlerStatus",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,a){var o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.join(t,r.CRAWL_FOLDER,n,"_.json"),e.next=3,this.storage.readJSON(o);case 3:return(i=e.sent).status=a,e.next=7,this.storage.saveJSON(o,i);case 7:return e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"setZoneStatus",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,o,i,l){var s,u,p,m,f,d,h,b,E,w,y,j,k;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=this.join(t,r.CRAWL_FOLDER,n),m=v(o,p),e.next=4,this.storage.readJSON(m("json"));case 4:if(f=e.sent,"pin"!==l){e.next=13;break}return w=v(o,this.join(t,r.PIN_FOLDER)),e.next=9,this.storage.readJSON(w("json"));case 9:return(null===(y=e.sent)||void 0===y?void 0:null===(d=y.png)||void 0===d?void 0:null===(h=d.diff)||void 0===h?void 0:h.zones)&&(null===f||void 0===f?void 0:null===(b=f.png)||void 0===b?void 0:null===(E=b.diff)||void 0===E?void 0:E.zones)&&(y.png.diff.zones.push(Object(a.a)({},f.png.diff.zones[i],{status:l})),(j=y.png.diff.zones.map((function(e){return e.zone}))).sort((function(e,t){return e.xMin*e.yMin-t.xMin*t.yMin})),k=Object(g.groupOverlappingZone)(j),y.png.diff.zones=k.map((function(e){return{zone:e,status:l}}))),e.next=13,this.storage.saveJSON(w("json"),y);case 13:return(null===f||void 0===f?void 0:null===(s=f.png)||void 0===s?void 0:null===(u=s.diff)||void 0===u?void 0:u.zones)&&(f.png.diff.zones[i].status=l),e.next=16,this.storage.saveJSON(m("json"),f);case 16:return e.abrupt("return",f);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,o){return e.apply(this,arguments)}}()},{key:"setZonesStatus",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,a,o){var i,l,s,u,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.join(t,r.CRAWL_FOLDER,n),l=v(a,i),e.next=4,this.storage.readJSON(l("json"));case 4:s=e.sent,p=0;case 6:if(!(p<s.png.diff.zones.length)){e.next=13;break}return e.next=9,this.setZoneStatus(t,n,a,p,o);case 9:u=e.sent;case 10:p++,e.next=6;break;case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"startCrawler",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Math.floor(Date.now()/1e3).toString(),a={projectId:t,pagesFolder:r},e.next=4,this.storage.crawl(a,30,null===(n=this.ctx)||void 0===n?void 0:n.push);case 4:return o=e.sent,e.abrupt("return",{timestamp:r,redirect:o});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"join",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return d.join.apply(void 0,[r.PROJECT_FOLDER,e].concat(n))}}]),t}(n(88).a);n.d(t,"a",(function(){return E}))},23:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"ROOT_FOLDER",(function(){return o})),n.d(t,"PROJECT_FOLDER",(function(){return i})),n.d(t,"CRAWL_FOLDER",(function(){return c})),n.d(t,"PIN_FOLDER",(function(){return l})),n.d(t,"CODE_FOLDER",(function(){return s})),n.d(t,"MAX_HISTORY",(function(){return u})),n.d(t,"TIMEOUT",(function(){return p})),n.d(t,"CONSUMER_COUNT",(function(){return m})),n.d(t,"USER_AGENT",(function(){return f})),n.d(t,"CONSUME_TIMEOUT",(function(){return d})),n.d(t,"config",(function(){return h}));var r=n(24),a=n(42),o=Object({NODE_ENV:"production",PUBLIC_URL:""}).ROOT_FOLDER||Object(a.join)(e,"../../.."),i=Object({NODE_ENV:"production",PUBLIC_URL:""}).PROJECT_FOLDER||"test-crawler",c="crawl",l="pin",s="code",u=10,p=1e4,m=5,f="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",d=Object({NODE_ENV:"production",PUBLIC_URL:""}).CONSUME_TIMEOUT?parseInt(Object({NODE_ENV:"production",PUBLIC_URL:""}).CONSUME_TIMEOUT,10):0,h=function(){var e,t=Object(a.join)(o,"test-crawler.config.js");try{e=n(328)(t)}catch(i){e={}}return Object(r.a)({remote:{}},e)}()}.call(this,"/")},301:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return k}));var r=n(25),a=n(103),o=n(24),i=n(2),c=n.n(i),l=n(9),s=n(51),u=n(83),p=n(85),m=n(84),f=n(86),d=n(302),h=n(42),g=n(200),v=n.n(g),b=n(23),E=n(99),w=n(88),y="https://api.github.com",j="\nname: Test-crawler CI\n\non:\n  repository_dispatch:\n    types: [".concat("test-crawler","]\n\njobs:\n  test-crawler:\n\n    runs-on: ubuntu-latest\n\n    steps:\n    - uses: actions/checkout@v2\n    - name: Run test-crawler ${{ github.event.client_payload.projectId }}\n      uses: apiel/test-crawler/actions/run@master\n    - name: Push changes\n      uses: apiel/test-crawler/actions/push@master\n      with:\n        token: ${{ secrets.GITHUB_TOKEN }}\n"),k=function(t){function n(e){var t;return Object(s.a)(this,n),(t=Object(p.a)(this,Object(m.a)(n).call(this))).ctx=e,t.config=void 0,t.config=b.config.remote.github,t}return Object(f.a)(n,t),Object(u.a)(n,[{key:"readdir",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getContents(t);case 3:return n=e.sent,r=n.data,e.abrupt("return",r.map((function(e){return e.name})));case 8:if(e.prev=8,e.t0=e.catch(0),404!==(null===e.t0||void 0===e.t0?void 0:null===(a=e.t0.response)||void 0===a?void 0:a.status)){e.next=12;break}return e.abrupt("return",[]);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"blob",value:function(){var t=Object(l.a)(c.a.mark((function t(n){var r,a,o,i,l,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getContents(Object(h.dirname)(n));case 2:if(r=t.sent,a=r.data,o=Object(h.basename)(n),i=a.find((function(e){return e.name===o}))){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,this.call({url:"".concat(this.blobUrl,"/").concat(i.sha)});case 10:return l=t.sent,s=l.data.content,t.abrupt("return",e.from(s,"base64"));case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"read",value:function(){var t=Object(l.a)(c.a.mark((function t(n){var r,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getContents(n);case 2:return r=t.sent,a=r.data.content,t.abrupt("return",e.from(a,"base64"));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"readJSON",value:function(){var e=Object(l.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=JSON,e.next=4,this.read(t);case 4:return e.t1=e.sent.toString(),e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContents(t);case 2:return n=e.sent,r=n.data.sha,a=JSON.stringify({message:"".concat("[test-crawler]"," save json"),sha:r}),e.next=7,this.call({method:"DELETE",url:"".concat(this.contentsUrl,"/").concat(t),data:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveFile",value:function(){var t=Object(l.a)(c.a.mark((function t(n,r){var a,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.repo){t.next=2;break}throw new Error("GitHub repository required.");case 2:return t.next=4,this.getSha(n);case 4:return a=t.sent,i=JSON.stringify(Object(o.a)({message:"".concat("[test-crawler]"," save file"),content:e.from(r).toString("base64")},a&&{sha:a})),t.next=8,this.call({method:"PUT",url:"".concat(this.contentsUrl,"/").concat(n),data:i});case 8:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getSha",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getContents(t);case 3:if(n=e.sent,!(null===(r=n.data)||void 0===r?void 0:r.sha)){e.next=7;break}return e.abrupt("return",r.sha);case 7:e.next=13;break;case 9:if(e.prev=9,e.t0=e.catch(0),404===(null===e.t0||void 0===e.t0?void 0:null===(a=e.t0.response)||void 0===a?void 0:a.status)){e.next=13;break}throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"saveJSON",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveFile(t,JSON.stringify(n,null,4)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"copy",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.read(t);case 2:(r=e.sent)&&this.saveFile(n,r.toString());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"crawl",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t||void 0===t?void 0:t.projectId)){e.next=5;break}return e.next=3,this.saveFile(".github/workflows/test-crawler.yml",j);case 3:return e.next=5,this.call({method:"POST",url:"".concat(this.ciDispatchUrl),data:{event_type:"test-crawler",client_payload:{projectId:t.projectId}}});case 5:return e.abrupt("return",this.redirectUrl);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"repos",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:"".concat(y,"/users/").concat(null===(t=this.config)||void 0===t?void 0:t.user,"/repos?sort=updated&per_page=1000")});case 2:return n=e.sent,r=n.data,e.abrupt("return",r.map((function(e){return e.name})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRepo",value:function(){var e=Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.repo);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"info",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:"".concat(y,"/rate_limit")});case 2:return t=e.sent,n=t.data.rate,r=n.limit,a=n.remaining,e.abrupt("return","For GitHub API requests, you can make up to 5000 requests per hour.\n        Every pages of the test-crawler UI is using multiples request at once. Your\n        current rate limit is: ".concat(a," of ").concat(r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"jobs",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:this.runsUrl});case 2:return n=e.sent,r=n.data.workflow_runs,e.next=6,this.getInProgressJobs(t,r);case 6:return o=e.sent,i=this.getQueuedJobs(r),e.abrupt("return",[].concat(Object(a.a)(i),Object(a.a)(o)));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueuedJobs",value:function(e){return e.filter((function(e){var t=e.status;return!["in_progress","completed"].includes(t)})).map((function(e){var t=e.id,n=e.html_url,r=e.status,a=e.created_at,o=e.updated_at;return{id:t,url:n,status:r,startAt:Math.round(new Date(a).getTime()/1e3),lastUpdate:Math.round(new Date(o).getTime()/1e3)}}))}},{key:"getInProgressJobs",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var a,o,i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.filter((function(e){return"in_progress"===e.status})).map((function(e){return e.id})),o=a.map(function(){var e=Object(l.a)(c.a.mark((function e(n){var a,o,l,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.call({url:"".concat(y,"/repos/").concat(i.user,"/").concat(i.repo,"/actions/runs/").concat(n,"/jobs")});case 2:if(a=e.sent,o=a.data.jobs,l=Object(r.a)(o,1),s=l[0],!(void 0!==s.steps.find((function(e){return e.name.includes(t)})))){e.next=9;break}return u=s.steps.find((function(e){return"in_progress"===e.status})),e.abrupt("return",{id:n,url:s.html_url,status:s.status,startAt:Math.round(new Date(s.started_at).getTime()/1e3),stepsCount:s.steps.length,stepsDone:s.steps.filter((function(e){return"completed"===e.status})).length,currentStep:(null===u||void 0===u?void 0:u.name)||"unknown",lastUpdate:Math.round(new Date((null===u||void 0===u?void 0:u.started_at)||s.started_at).getTime()/1e3)});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(o);case 4:return e.t0=function(e){return e},e.abrupt("return",e.sent.filter(e.t0));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"call",value:function(e){if(!this.token||!this.user)throw new Error(E.a.missingGitHubConfig);return v()(Object(o.a)({},e,{headers:Object(o.a)({},null===e||void 0===e?void 0:e.headers,{Authorization:"token ".concat(this.token)})}))}},{key:"getContents",value:function(e){return this.call({url:"".concat(this.contentsUrl,"/").concat(e)})}},{key:"contentsUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/contents")}},{key:"blobUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/git/blobs")}},{key:"ciDispatchUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/dispatches")}},{key:"runsUrl",get:function(){return"".concat(y,"/repos/").concat(this.user,"/").concat(this.repo,"/actions/workflows/test-crawler.yml/runs?event=repository_dispatch")}},{key:"redirectUrl",get:function(){return"https://github.com/".concat(this.user,"/").concat(this.repo,"/actions")}},{key:"user",get:function(){var e,t;return(null===(e=Object(w.b)("github",this.ctx))||void 0===e?void 0:e.user)||(null===(t=this.config)||void 0===t?void 0:t.user)}},{key:"token",get:function(){var e,t;return(null===(e=Object(w.b)("github",this.ctx))||void 0===e?void 0:e.token)||(null===(t=this.config)||void 0===t?void 0:t.user)}},{key:"repo",get:function(){var e;return Object(w.b)("githubRepo",this.ctx)||(null===(e=this.config)||void 0===e?void 0:e.defaultRepo)}}]),n}(d.a)}).call(this,n(330).Buffer)},302:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(51),a=function e(){Object(r.a)(this,e)}},318:function(e,t,n){e.exports=n(757)},325:function(e,t,n){},326:function(e,t,n){},328:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=328},46:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e.ChromePuppeteer="chrome-puppeteer",e.FirefoxSelenium="firefox-selenium",e.ChromeSelenium="chrome-selenium"}(r||(r={})),function(e){e.Before="before",e.After="after"}(a||(a={}))},757:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(8),i=n.n(o),c=n(146),l=(n(325),n(74)),s=n.n(l),u=n(13),p=n.n(u),m=n(33),f=n.n(m),d=n(16),h=n(61),g=(n(326),n(2)),v=n.n(g),b=n(24),E=n(60),w=n(9),y=n(52),j=n.n(y),k=n(306),O=n.n(k),x=n(140),I=n.n(x),T=n(22),S=n.n(T),C=n(10),P=n.n(C),R=n(139),L=n.n(R),F=n(147),_=n.n(F),D=n(28),U=n.n(D),N=n(18),z=n.n(N),A=n(46);function M(e){return"/new/".concat(e)}function J(e,t){return"/pins/".concat(e,"/").concat(t)}function B(e,t,n){return"/code/".concat(e,"/").concat(t,"/").concat(n)}function H(e,t,n){return"/results/".concat(e,"/").concat(t,"/").concat(n)}function G(e,t){return"/project/".concat(e,"/").concat(t)}var W=n(12),q={lineHeight:1.2,borderLeft:"8px solid #EEE",paddingLeft:15,color:"#666",textAlign:"justify"},V=function(e){var t=e.children;return a.a.createElement("div",{style:q},t)},Z=n(37),Y=n.n(Z),Q=[{name:"Desktop - 800x600",value:{width:800,height:600}},{name:"Desktop - 1024x768",value:{width:1024,height:768}},{name:"Desktop - 1920x1080",value:{width:1920,height:1080}},{name:"iPhone 5 - 320x568",value:{width:320,height:568,isMobile:!0,hasTouch:!0}},{name:"iPhone 6 - 375x667",value:{width:375,height:667,isMobile:!0,hasTouch:!0}},{name:"Ipad - 768x1024",value:{width:768,height:1024,isMobile:!0,hasTouch:!0}},{name:"Galaxy S5 - 360x640",value:{width:360,height:640,isMobile:!0,hasTouch:!0}}],$=Q.map((function(e){var t=e.value,n=Object(E.a)(e,["value"]);return Object(b.a)({},n,{value:JSON.stringify(t)})})),K=function(e){var t=JSON.stringify(e),n=$.findIndex((function(e){return e.value===t}));if(-1!==n)return $[n].name;var r=e.width,a=e.height,o=e.isMobile;return"".concat(r,"x").concat(a).concat(o&&" mobile")},X=Y.a.Option,ee=function(e){return(0,e.getFieldDecorator)("viewport",{initialValue:e.initialValue||$[0].name})(a.a.createElement(Y.a,null,$.map((function(e){var t=e.value,n=e.name;return a.a.createElement(X,{key:t,value:t},n)}))))},te=n(59),ne=n(25),re=function(e,t,n,r){return Object(w.a)(v.a.mark((function a(){var o;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n(void 0),r(!0),a.next=5,e();case 5:o=a.sent,t(o),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),n(a.t0);case 12:r(!1);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))},ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=a.a.useState(n),o=Object(ne.a)(r,2),i=o[0],c=o[1],l=a.a.useState(),s=Object(ne.a)(l,2),u=s[0],p=s[1],m=a.a.useState(!1),f=Object(ne.a)(m,2),d=f[0],h=f[1],g=re(e,c,p,h);return a.a.useEffect((function(){g()}),t),{loading:d,result:i,call:g,error:u,setResult:c}},oe=function(e){var t=e.storageType,n=e.loadProjects,r=(e.defaultValue,ae((function(){return Object(W.o)(t)})).result),o=ae((function(){return Object(W.j)(t)})).result;return r?a.a.createElement(Y.a,{showSearch:!0,defaultValue:o,onChange:function(e){(new te.a).set("githubRepo",e,{path:"/"}),n&&n()},style:{width:200},placeholder:"repository"},r.map((function(e){return a.a.createElement(Y.a.Option,{key:e,value:e},e)}))):null},ie=a.a.createContext({open:!1,toggle:function(){},setOpen:function(){},setContent:function(){}});var ce,le=function(){return a.a.useContext(ie)},se=function(e){var t=le().setContent;a.a.useEffect((function(){t(e)}),[])},ue=function(){var e=Object(w.a)(v.a.mark((function e(t,n,r){var a,o,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.name,o=r.viewport,i=Object(E.a)(r,["name","viewport"]),e.prev=1,e.next=4,Object(W.s)(t,Object(b.a)({},i,{viewport:JSON.parse(o)}),a,void 0);case 4:n.push("/"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),U.a.error({message:"Something went wrong!",description:e.t0.toString()});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),pe=function(e,t,n){return function(r){r.preventDefault(),n((function(n,r){n||ue(e,t,r)}))}},me=S.a.create({name:"start_crawler"})((function(e){var t=e.history,n=e.match.params.storageType,r=e.form,o=r.getFieldDecorator,i=r.validateFields,c=r.getFieldValue;return se(fe),a.a.createElement(S.a,{onSubmit:pe(n,t,i)},a.a.createElement(S.a.Item,null,o("name",{rules:[{required:!0,message:"Please give a name to the project."}]})(a.a.createElement(j.a,{addonBefore:"Name",placeholder:"Project name"}))),a.a.createElement(S.a.Item,null,o("url",{rules:[{required:!0,message:"Please input an URL to crawl."}]})(a.a.createElement(j.a,{placeholder:"https://domain.com/",addonBefore:"URL"}))),a.a.createElement("div",null,a.a.createElement(S.a.Item,{label:"Browser",className:"item-inline"},o("browser",{initialValue:A.b.ChromePuppeteer,rules:[{required:!0,message:"Please select a browser."}]})(a.a.createElement(Y.a,null,Object.keys(A.b).map((function(e){return a.a.createElement(Y.a.Option,{key:e,value:A.b[e]},A.b[e])}))))),a.a.createElement(S.a.Item,{label:"Viewport",className:"item-inline"},a.a.createElement(ee,{getFieldDecorator:o,initialValue:JSON.stringify(Q[0].value)}))),a.a.createElement("div",null,a.a.createElement(S.a.Item,{label:"Method",className:"item-inline"},o("method",{initialValue:"spiderbot",rules:[{required:!0}]})(a.a.createElement(_.a.Group,{size:"small"},a.a.createElement(_.a.Button,{value:"spiderbot"},a.a.createElement(P.a,{type:"radar-chart"})," Spider bot"),a.a.createElement(_.a.Button,{value:"urls"},a.a.createElement(P.a,{type:"ordered-list"})," URLs list")))),"spiderbot"===c("method")&&a.a.createElement(S.a.Item,{label:"Limit",className:"item-inline"},o("limit")(a.a.createElement(O.a,{min:0,size:"small"})),"\xa0",a.a.createElement(L.a,{content:a.a.createElement("div",null,a.a.createElement("b",null,"Limit the number of sibling pages. "),"For example, with the urls:",a.a.createElement("ul",null,a.a.createElement("li",null,"/item/1"),a.a.createElement("li",null,"/item/2"),a.a.createElement("li",null,"/item/3"),a.a.createElement("li",null,"/item/4"))," using the limit ",a.a.createElement("b",null,"2")," will only crawl ",a.a.createElement("b",null,"/item/1")," and ",a.a.createElement("b",null,"/item/2"),".",a.a.createElement("br",null),a.a.createElement("br",null),"Use ",a.a.createElement("b",null,"0")," to skip the limit."),trigger:"click",overlayStyle:{width:200}},a.a.createElement(P.a,{type:"question-circle"}))),a.a.createElement(V,null,a.a.createElement(p.a.Paragraph,{ellipsis:{rows:1,expandable:!0}},a.a.createElement("b",null,"Spider bot")," crawling method will get all the links inside the page of the given URL and crawl the children. It will then continue do the same with the children till no new link is found. Be careful if you have big website, this is most likely not the right solution for you."),a.a.createElement(p.a.Paragraph,{ellipsis:{rows:1,expandable:!0}},a.a.createElement("b",null,"URLs list")," crawling method will crawl a specific sets of URLs. In the URL input field you must provide an endpoint containing a list of URLs (a simple text format, with one URL per line). The crawler will crawl each of those URL only and will not try to find links in the page. To use a static list of URLs, you can use a tool like ",a.a.createElement("a",{href:"https://pastebin.com",target:"_blank",rel:"noopener noreferrer"},"https://pastebin.com"),"."))),a.a.createElement(S.a.Item,null,o("autopin",{valuePropName:"checked"})(a.a.createElement(I.a,null,"Automatically pin new page founds."))),a.a.createElement(S.a.Item,null,a.a.createElement(oe,{storageType:n})),a.a.createElement(S.a.Item,null,a.a.createElement(z.a,{type:"primary",icon:"plus",htmlType:"submit"},"Create")))})),fe=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"First of all, you need to give a name to your project. Then, you need to provide the URL depending of the crawling method you will be using. If you are using the ",a.a.createElement("b",null,"Spider bot")," method, you should give the URL of the website you want to crawl. If you are using the ",a.a.createElement("b",null,"URLs list")," method, you should give the URL of the endpoint containing the list of URLs."),a.a.createElement("p",null,"There is different kind of browser: ",a.a.createElement("a",{href:"https://github.com/puppeteer/puppeteer",target:"_blank",rel:"noopener noreferrer"},"chrome-puppeteer"),", ",a.a.createElement("a",{href:"https://github.com/SeleniumHQ/selenium",target:"_blank",rel:"noopener noreferrer"},"firefox-selenium"),"... Depending of the browser you will select, different tool will be available in the code injection. Also some brwoser are only available depending of the OS where is test-crawler hosted."),a.a.createElement("p",null,"There is multiple viewports (screen size) available. If you want to test multiple viewports for the same website, you will have to create one project per viewport."),a.a.createElement("p",null,"Finally, you can specify if you want to automatically pin the new pages founds. Pins are the references screenshot to make the comparison with. While crawling, the crawler is comparing page to pin. If you are not sure, the auto-pin can be activate/deactivate afterwards."),a.a.createElement(p.a.Title,{level:4},"Spider bot"),a.a.createElement("p",null,a.a.createElement("b",null,"Spider bot")," crawling method will get all the links inside the page of the given URL and crawl the children. It will then continue do the same with the children till no new link is found. Be careful if you have big website, this is most likely not the right solution for you."),a.a.createElement(p.a.Title,{level:4},"URLs list"),a.a.createElement("p",null,a.a.createElement("b",null,"URLs list")," crawling method will crawl a specific sets of URLs. In the URL input field you must provide an endpoint containing a list of URLs (a simple text format, with one URL per line). The crawler will crawl each of those URL only and will not try to find links in the page. To use a static list of URLs, you can use a tool like ",a.a.createElement("a",{href:"https://pastebin.com",target:"_blank",rel:"noopener noreferrer"},"https://pastebin.com"),"."))};!function(e){e.GitHub="github"}(ce||(ce={}));var de,he,ge,ve=n(34),be=n.n(ve),Ee=n(32),we=n.n(Ee),ye=n(99),je=function(e){return function(t){t.preventDefault(),e((function(e,t){var n,r;e||((new te.a).set("github",t,{path:"/"}),null===(n=window)||void 0===n||null===(r=n.location)||void 0===r||r.reload())}))}},ke=S.a.create({name:"github_auth"})((function(e){var t=e.form,n=t.getFieldDecorator,r=t.validateFields;return a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a.Title,{level:4},"GitHub"),a.a.createElement(V,null,a.a.createElement(p.a.Paragraph,null,"To save data in your GitHub repository, we need to provide a ",a.a.createElement("a",{href:"https://developer.github.com/v3/auth/#via-oauth-and-personal-access-tokens",target:"_blank",rel:"noopener noreferrer"},"personal access tokens")," to the ",a.a.createElement("a",{href:"https://developer.github.com/v3/",target:"_blank",rel:"noopener noreferrer"},"GitHub API"),". Note, the personal access tokens is a sensible information. Use this app, only on a trustable device. To ",a.a.createElement("a",{href:"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line",target:"_blank",rel:"noopener noreferrer"},"create a token"),", go in developer settings, personal access tokens and then generate new token. In most of the case you will only need to give permission for ",a.a.createElement(p.a.Text,{code:!0},"public_repo"),".")),a.a.createElement(S.a,{onSubmit:je(r)},a.a.createElement(S.a.Item,null,n("user",{rules:[{required:!0,message:"Please provide your GitHub username."}]})(a.a.createElement(j.a,{addonBefore:"Username",placeholder:"Github username"}))),a.a.createElement(S.a.Item,null,n("token",{rules:[{required:!0,message:"Please provide your personal access tokens."}]})(a.a.createElement(j.a.Password,{addonBefore:"Token",placeholder:"Personal access tokens"}))),a.a.createElement(S.a.Item,null,a.a.createElement(z.a,{type:"primary",icon:"github",htmlType:"submit"},"OK"))))})),Oe=n(768),xe=function(e){var t=e.storageType,n=ae((function(){return Object(W.f)(t)})).result;return n?a.a.createElement(V,null,a.a.createElement(p.a.Paragraph,null,n)):null},Ie=function(e){var t=e.title,n=e.storageType,r=function(e){var t=ae((function(){return Object(W.n)(e)})),n=t.result,r=t.error;return{projects:n,loading:t.loading,error:r,call:t.call}}(n),o=r.projects,i=r.loading,c=r.error,l=r.call,s=function(e){if(e){if(e===ye.a.missingGitHubConfig||(null===e||void 0===e?void 0:e.message)===ye.a.missingGitHubConfig)return ke;Oe.a.warning({message:"Something went wrong.",description:e.toString()})}}(c);return s?a.a.createElement(s,null):a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a.Title,{level:4},t," ",a.a.createElement(oe,{storageType:n,loadProjects:l})),a.a.createElement(xe,{storageType:n}),i?a.a.createElement(we.a,null):a.a.createElement(be.a,{itemLayout:"horizontal",bordered:!0,dataSource:o,renderItem:function(e){var t=e.id,r=e.name,o=e.crawlerInput.url;return a.a.createElement(be.a.Item,{actions:[a.a.createElement(d.b,{to:G(n,t)},"Open")]},a.a.createElement(be.a.Item.Meta,{title:a.a.createElement(d.b,{to:G(n,t)},r," ",a.a.createElement(P.a,{type:n})),description:o}))}}))},Te=function(){return se(Se),a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a.Title,{level:3},"Projects"),Object.keys(ce).map((function(e){return a.a.createElement("div",{key:e},a.a.createElement(Ie,{title:e,storageType:ce[e]}),a.a.createElement("br",null),a.a.createElement(d.b,{to:M(ce[e])},a.a.createElement(z.a,{icon:"plus",size:"small"},"New")),a.a.createElement("br",null),a.a.createElement("br",null))})))},Se=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"Test-crawler is project based. To be able to start a crawler, you will first need to create a project by clicking on ",a.a.createElement(z.a,{icon:"plus",size:"small"},"New")),a.a.createElement("p",null,"Depending on how test-crawler is hosted, there will be different type of storage availble: local, GitHub, and more coming soon... If you are running it, yourself, all the storage should be available."),a.a.createElement(p.a.Title,{level:4},"Local"),a.a.createElement("p",null,"The ",a.a.createElement("b",null,"local")," storage consist to save the data on the server where is hosted test-crawler. This is the best option to keep your tests private and safe."),a.a.createElement(p.a.Title,{level:4},"GitHub"),a.a.createElement("p",null,"The ",a.a.createElement("b",null,"GitHub")," storage consist to save the data on a given repository. This option is good for public project, especially for open source project that are already on GitHub. It will give you the possibility to keep history of your tests in relation to your code changes. Also this storage is using GitHub CI workflow to generate your test, you can therefor integrate it very well with your other workflow."),a.a.createElement("p",null,"To use ",a.a.createElement("b",null,"GitHub")," storage, we need to provide a user and a ",a.a.createElement("a",{href:"https://developer.github.com/v3/auth/#via-oauth-and-personal-access-tokens",target:"_blank",rel:"noopener noreferrer"},"personal access tokens")," to the ",a.a.createElement("a",{href:"https://developer.github.com/v3/",target:"_blank",rel:"noopener noreferrer"},"GitHub API"),". Note, the personal access tokens is a sensible information. Use this app, only on a trustable device. To ",a.a.createElement("a",{href:"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line",target:"_blank",rel:"noopener noreferrer"},"create a token"),", go in developer settings, personal access tokens and then generate new token. In most of the case you will only need to give permission for ",a.a.createElement(p.a.Text,{code:!0},"public_repo"),"."),a.a.createElement(V,null,a.a.createElement(p.a.Paragraph,null,"Note: we are not saving any of your credential on a server. Everything is save in your cookies. Also the ",a.a.createElement("a",{href:"https://apiel.github.io/test-crawler/live/"},"live version")," hosted on GitHub page is purely static. All the logic is running in your browser.")),a.a.createElement("p",null,"Once your credential provided, you will need to select the repository where you want to save your tests. In general, it would make sense to save those tests in the same repository as the website you are testing. You can switch from one repository to the other at anytime."))},Ce=n(98),Pe=n(143),Re=n.n(Pe),Le=n(141),Fe=n.n(Le),_e={textAlign:"center"},De=300,Ue={width:De+20,marginBottom:10},Ne={paddingTop:10,paddingBottom:10},ze={gutter:10,fitWidth:!0},Ae=n(142),Me=n.n(Ae),Je=function(e){var t=e.message,n=void 0===t?"Something went wrong":t,r=e.description;return a.a.createElement(Me.a,{message:n,description:r,type:"warning",showIcon:!0})},Be=n(308),He=n.n(Be),Ge=n(309),We=n.n(Ge),qe={width:Ue.width,marginRight:ze.gutter},Ve=function(e,t,n){return function(r){t&&(r.length?(clearTimeout(de),de=setTimeout((function(){Qe(e,Ze(t,r),n)}),500)):Qe(e,t,n))}},Ze=function(e,t){return new He.a(e,{keys:["url","viewport.width","viewport.height","keywords"]}).search(t)},Ye=function(e,t,n){return function(r){t&&(n(r),Qe(e,t,r))}},Qe=function(e,t,n){if(t)if(n.length){var r=n.filter((function(e){return!Object.keys($e).includes(e)})).join(" ");r&&(t=Ze(t,r)),e(t.filter((function(e){var t=!0;if(n.includes("with-diff")){var r=We()(e,"png.diff.pixelDiffRatio");t=t&&r>0}return n.includes("new")&&(t=t&&!!e.png&&!e.png.diff),t})))}else e(t)},$e={"with-diff":"with diff",new:"new"},Ke=Y.a.Option,Xe=function(e){var t=e.children,n=e.response,r=e.withFilters,o=a.a.useState(),i=Object(ne.a)(o,2),c=i[0],l=i[1],s=a.a.useState([]),u=Object(ne.a)(s,2),p=u[0],m=u[1],f=a.a.useState(),d=Object(ne.a)(f,2),h=d[0],g=d[1];return a.a.useEffect((function(){l(n),Ye(g,n,m)(p)}),[n,m,p]),a.a.createElement(a.a.Fragment,null,a.a.createElement(Y.a,{mode:"tags",onChange:Ye(g,c,m),tokenSeparators:[","],style:qe,placeholder:"Search",filterOption:!1,onSearch:Ve(g,c,p)},!!r&&Object.keys(r).map((function(e){return a.a.createElement(Ke,{key:e},r[e])}))),t(h))},et=n(311),tt=n.n(et),nt=n(82),rt=function(e){return Object(nt.unix)(parseInt(e,10)).calendar()},at=n(103),ot=n(310),it=n(30),ct=n.n(it),lt={marginLeft:5,marginRight:5},st=function(e,t){var n=t.timestamp,r=t.id,a=t.index,o=t.projectId,i=t.setPages,c=t.storageType;return(Object(w.a)(v.a.mark((function t(){var l;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(W.v)(c,o,n,r,a,e);case 3:l=t.sent,i(l),ct.a.success("Page pinned as reference for comparison.",2),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),U.a.error({message:"Something went wrong!",description:t.t0.toString()});case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))))},ut=function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(z.a,{style:lt,icon:"check",size:"small",onClick:st("valid",e)},"Valid"),a.a.createElement(z.a,{style:lt,icon:"pushpin",size:"small",onClick:st("pin",e)},"Always valid"),a.a.createElement(z.a,{style:lt,icon:"warning",size:"small",type:"danger",onClick:st("report",e)},"Report"))},pt=function(e){return"valid"===e||"pin"===e?"#0F0":"report"===e?"red":"yellow"},mt=function(e,t,n,r,a,o,i){var c=e.xMin,l=e.yMin,s=l/t-1,u=c/t-1;return{width:(e.xMax-c)/t+2,height:(e.yMax-l)/t+2,top:s,left:u+r,border:"1px solid ".concat(pt(i)),position:"absolute",backgroundImage:o?'url("'.concat(a,'")'):"none",backgroundPosition:"".concat(-(u+1),"px ").concat(-(s+1),"px"),backgroundSize:n}},ft=function(e){var t=e.storageType,n=e.setPages,o=e.projectId,i=e.folder,c=e.id,l=e.index,s=e.originalWidth,u=e.zone,p=e.status,m=e.width,f=e.marginLeft,d=Object(r.useState)(),h=Object(ne.a)(d,2),g=h[0],b=h[1],E=function(){var e=Object(w.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=b,e.next=3,Object(W.l)(t,o,"base",c,m);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){E()}),[]);var y=Object(r.useState)(!1),j=Object(ne.a)(y,2),k=j[0],O=j[1],x=s/m;return a.a.createElement(L.a,{key:"".concat(c,"-").concat(l),content:a.a.createElement(ut,{storageType:t,index:l,timestamp:i,id:c,projectId:o,setPages:n}),trigger:"click"},a.a.createElement("div",{style:mt(u,x,m,f,g,k,p),onMouseOver:function(){return O(!0)},onMouseOut:function(){return O(!1)}}))},dt=function(e){var t=e.zones;return a.a.createElement("p",null,a.a.createElement("b",null,"Zone:"),"\xa0",[["diff"],["valid","pin"],["report"]].map((function(e){var n=Object(ot.a)(e),r=n[0],o=n.slice(1);return a.a.createElement(a.a.Fragment,{key:r},a.a.createElement("span",{style:{marginLeft:10,color:pt(r)}},"\u25a0")," ",a.a.createElement("b",null,function(e,t){return e.filter((function(e){var n=e.status;return t.includes(n)})).length}(t,[r].concat(Object(at.a)(o))))," ",r)})))},ht=function(e){var t=e.diff;return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,a.a.createElement(P.a,{type:"picture",theme:"outlined"}),"\xa0 Pixel diff ratio: ",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return e;var n=t-1-Math.floor(Math.log(e)/Math.log(10));return e.toFixed(n)}(t.pixelDiffRatio)),t.zones&&t.zones.length>0&&a.a.createElement(dt,{zones:t.zones}))},gt=function(e){var t=e.diff;return t?a.a.createElement(ht,{diff:t}):a.a.createElement("div",null,a.a.createElement(P.a,{type:"picture",theme:"outlined"}),"\xa0 New screenshot ",a.a.createElement(tt.a,{color:"green"},"New"))},vt=new(n(704))({fg:"#333"}),bt={marginBottom:10},Et=function(e){var t=e.pageError,n=e.url,r=e.png;return a.a.createElement(a.a.Fragment,null,t&&a.a.createElement(Me.a,{message:a.a.createElement("div",{dangerouslySetInnerHTML:{__html:vt.toHtml(t)}}),type:"warning",style:bt}),a.a.createElement("p",null,a.a.createElement(P.a,{type:"link"})," ",a.a.createElement("a",{href:n},n)),r?a.a.createElement(gt,{diff:r.diff}):a.a.createElement("p",null,a.a.createElement(P.a,{type:"picture",theme:"outlined"})," No screenshot available"))},wt=function(e){var t=e.timestamp,n=e.id,r=e.status,a=e.projectId,o=e.setPages,i=e.storageType;return(Object(w.a)(v.a.mark((function e(){var c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(W.w)(i,a,t.toString(),n,r);case 3:c=e.sent,o(c),ct.a.success('All zone are set to "'.concat(r,'".'),2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),U.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},yt=function(e){var t=e.status,n=e.type;return a.a.createElement(P.a,{type:n,title:'Set all zone to "'.concat(t,'".'),onClick:wt(e)})},jt=function(e){var t=e.storageType,n=e.projectId,r=e.timestamp,a=e.id;return(Object(w.a)(v.a.mark((function e(){var o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=ct.a.loading("Pin in progress..",0),e.next=4,Object(W.p)(t,n,r.toString(),a);case 4:o(),ct.a.success("Page pinned as reference for comparison.",2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),U.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},kt=function(e){return function(e){return a.a.createElement(P.a,{type:"pushpin",title:"pin as reference for comparison",onClick:jt(e)})}(e)},Ot=n(312),xt=n.n(Ot),It=function(e){var t=e.storageType,n=e.projectId,o=e.folder,i=e.id,c=e.onImg,l=void 0===c?function(){}:c,s=e.width,u=void 0===s?De:s,p=e.children,m=Object(r.useState)(),f=Object(ne.a)(m,2),d=f[0],h=f[1],g=function(){var e=Object(w.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=h,e.next=3,Object(W.l)(t,n,o,i,u);case 3:e.t1=e.sent,(0,e.t0)(e.t1),l();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){g()}),[]),d?a.a.createElement("div",{style:_e},p,a.a.createElement("img",{style:{width:u},alt:"",src:d})):null},Tt=function(e){var t=e.storageType,n=e.projectId,r=e.folder,o=e.id,i=e.zones,c=e.originalWidth,l=void 0===c?0:c,s=e.width,u=void 0===s?De:s,p=e.setPages,m=e.marginLeft,f=Object(E.a)(e,["storageType","projectId","folder","id","zones","originalWidth","width","setPages","marginLeft"]);return a.a.createElement(It,Object.assign({storageType:t,projectId:n,folder:r,id:o,width:u},f),i&&i.map((function(e,i){var c=e.zone,s=e.status;return a.a.createElement(ft,{storageType:t,projectId:n,folder:r,id:o,width:u,index:i,originalWidth:l,marginLeft:m,status:s,zone:c,key:"zone-".concat(o,"-").concat(i),setPages:p})})))},St=function(e){return function(){e(!0)}},Ct=function(e){return function(){e(!1)}},Pt=function(e){var t=e.storageType,n=e.setPages,r=e.projectId,o=e.timestamp,i=e.id,c=e.png,l=e.url,s=e.pageError,u=a.a.useState(!1),p=Object(ne.a)(u,2),m=p[0],f=p[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(xt.a,{title:"",visible:m,onCancel:Ct(f),footer:null,width:c.width+40},a.a.createElement("div",{style:{position:"relative"}},a.a.createElement(Tt,{storageType:t,setPages:n,projectId:r,folder:o,id:i,zones:c.diff&&c.diff.zones,originalWidth:c.width,width:c.width,marginLeft:0}),a.a.createElement(Et,{url:l,pageError:s,png:c}))),a.a.createElement(P.a,{type:"fullscreen",title:"fullscreen",onClick:St(f)}))},Rt=function(e){var t=e.storageType,n=e.setPages,r=e.projectId,o=e.timestamp,i=e.id,c=e.png,l=e.url,s=e.pageError;return[c&&a.a.createElement(Pt,{storageType:t,setPages:n,projectId:r,png:c,id:i,timestamp:o,url:l,pageError:s})].concat([a.a.createElement(yt,{storageType:t,type:"check",setPages:n,projectId:r,timestamp:o,id:i,status:"valid"}),a.a.createElement(yt,{storageType:t,type:"warning",setPages:n,projectId:r,timestamp:o,id:i,status:"report"}),a.a.createElement(kt,{storageType:t,projectId:r,timestamp:o,id:i})])},Lt=function(e){return he=e},Ft=function(){he&&he.layout(),clearTimeout(ge),ge=setTimeout((function(){he&&he.layout()}),500)},_t=function(e){var t=e.projectId,n=e.timestamp,r=e.lastUpdate,o=e.storageType,i=ae((function(){return Object(W.h)(o,t,n)}),[r]),c=i.result,l=i.error,s=i.setResult;return l?a.a.createElement(Je,{description:l.toString()}):a.a.createElement(Xe,{response:c,withFilters:$e},(function(e){return e?a.a.createElement(Fe.a,{style:Ne,options:ze,ref:function(e){Lt(e&&e.masonry)}},e.map((function(e){var r=e.id,i=e.url,c=e.png,l=e.error;return a.a.createElement(Re.a,{key:r,style:Ue,cover:c&&a.a.createElement(Tt,{storageType:o,projectId:t,folder:n,id:r,zones:c.diff&&c.diff.zones,originalWidth:c.width,onImg:Ft,setPages:s,marginLeft:10}),actions:Rt({storageType:o,setPages:s,projectId:t,id:r,timestamp:n,png:c,url:i,pageError:l})},a.a.createElement(Et,{url:i,pageError:l,png:c}))}))):a.a.createElement(we.a,null)}))},Dt=n(144),Ut=n.n(Dt),Nt=(n(735),n(313)),zt=n.n(Nt),At=function(e,t,n,r){return function(){var a=Object(w.a)(v.a.mark((function a(o){var i,c;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,i=o?"done":"review",a.next=4,Object(W.u)(e,t,n,i);case 4:c=a.sent,r(c),ct.a.success('Status set to "'.concat(i,'".'),2),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),U.a.error({message:"Something went wrong!",description:a.t0.toString()});case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}()},Mt=function(e){var t=e.storageType,n=e.timestamp,r=e.status,o=e.projectId,i=e.setCrawler;return a.a.createElement(zt.a,{checkedChildren:"done",unCheckedChildren:"review",checked:"done"===r,onChange:At(t,o,n,i)})},Jt=function(e,t){var n=Object(c.b)(W.m,e,t),r=n.call,o=n.response,i=n.update,l=n.error,s=n.cache;return a.a.useEffect((function(){s()||r()}),[e,t,s,r]),l&&U.a.warning({message:"Something went wrong while loading project.",description:l.toString()}),{project:o,setProject:i}},Bt=function(e){var t=e.projectId,n=e.storageType,r=Jt(n,t).project;return r?a.a.createElement("p",null,a.a.createElement("b",null,"Project:")," ",a.a.createElement(d.b,{to:G(n,r.id)},r.name)):null},Ht=p.a.Title,Gt={color:"#faad29"},Wt={color:"#999",fontSize:11},qt=function(e){var t=e.crawler,n=t.timestamp,r=t.url,o=t.diffZoneCount,i=t.errorCount,c=t.status,l=t.urlsCount,s=t.inQueue,u=t.startAt,p=t.lastUpdate,m=t.limit,f=t.viewport,d=e.projectId,h=e.storageType,g=e.setCrawler,v=l+s,b=Math.floor(l/v*100),E=K(f);return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ht,{level:3},rt(n)),(o>0||i>0)&&a.a.createElement("p",null,a.a.createElement(Mt,{storageType:h,setCrawler:g,projectId:d,status:c,timestamp:n})),a.a.createElement(Bt,{projectId:d,storageType:h}),a.a.createElement("p",null,a.a.createElement("b",null,"URL:")," ",r),a.a.createElement("p",null,a.a.createElement("b",null,"Screen:")," ",E),a.a.createElement("p",null,a.a.createElement("b",null,"URL crawled:")," ",l,void 0!==m&&m>0&&a.a.createElement("span",{style:Wt}," (with limit set to ",m,")")),a.a.createElement("p",null,a.a.createElement("b",null,"Duration:")," ",Object(nt.duration)(p-u).format("h [hrs], m [min], s [sec]")),s>0&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Ut.a,{percent:b}),a.a.createElement("p",null,a.a.createElement("b",null,"In queue:")," ",s)),i>0&&a.a.createElement("p",{style:Gt},a.a.createElement(P.a,{type:"exclamation-circle"})," ",i," error(s) founds"))},Vt=function(e){var t=e.match.params,n=t.timestamp,r=t.projectId,o=t.storageType;se();var i=ae((function(){return Object(W.d)(o,r,n)})),c=i.result,l=i.error,s=i.setResult;if(a.a.useEffect((function(){var e=Object(Ce.subscrib)(s);return function(){return Object(Ce.unsubscrib)(e)}}),[c,s]),l)return a.a.createElement(Je,{description:l.toString()});var u=null===c||void 0===c?void 0:c.lastUpdate;return c?a.a.createElement(a.a.Fragment,null,a.a.createElement(qt,{crawler:c,projectId:r,storageType:o,setCrawler:s}),a.a.createElement(_t,{storageType:o,timestamp:n,lastUpdate:u,projectId:r})):a.a.createElement(we.a,null)},Zt=n(314),Yt=n.n(Zt),Qt=function(e,t,n,r){return Object(w.a)(v.a.mark((function a(){var o,i;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=ct.a.loading("Delete in progress..",0),a.next=3,Object(W.q)(e,t,n);case 3:i=a.sent,r(i),o();case 6:case"end":return a.stop()}}),a)})))},$t=function(e){var t=e.storageType,n=e.projectId,r=e.id,o=e.url,i=e.viewport,c=e.onImg,l=e.png,s=e.setPins;return a.a.createElement(Re.a,{style:Ue,cover:l&&a.a.createElement(It,{folder:"base",id:r,onImg:c,projectId:n}),actions:[a.a.createElement(Yt.a,{title:"Are you sure delete this pin?",onConfirm:Qt(t,n,r,s),okText:"Yes",cancelText:"No"},a.a.createElement(P.a,{type:"delete",title:"Delete pin"})),a.a.createElement(d.b,{to:{pathname:B(t,n,r),state:{pattern:o}}},a.a.createElement(P.a,{type:"code",title:"Insert code while crawling"}))]},a.a.createElement("p",null,a.a.createElement(P.a,{type:"link"})," ",a.a.createElement("a",{href:o},o)),!l&&a.a.createElement("p",null,a.a.createElement(P.a,{type:"picture",theme:"outlined"})," No screenshot available"),i&&a.a.createElement("p",null,a.a.createElement(P.a,{type:"picture",theme:"outlined"})," ",K(i)))},Kt=p.a.Title,Xt=function(e){var t=e.match.params,n=t.projectId,r=t.storageType;se();var o=ae((function(){return Object(W.i)(r,n)})),i=o.result,c=o.error,l=o.setResult;return c?a.a.createElement(Je,{description:c.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(Kt,{level:3},"Pins"),a.a.createElement(Bt,{projectId:n,storageType:r}),a.a.createElement(Xe,{response:i},(function(e){return e?a.a.createElement(Fe.a,{style:Ne,options:ze,ref:function(e){Lt(e&&e.masonry)}},e.map((function(e){var t=e.id,o=e.url,i=e.png,c=e.viewport;return a.a.createElement($t,{projectId:n,id:t,key:t,url:o,setPins:l,png:i,viewport:c,onImg:Ft,storageType:r})}))):a.a.createElement(we.a,null)})))},en=n(145),tn=n.n(en),nn=(n(294),n(295),p.a.Paragraph),rn=p.a.Text,an=function(e){var t=e.full,n=void 0===t||t;return a.a.createElement(V,null,a.a.createElement(nn,null,"Inject some code in the crawler while parsing the page. This code will be executed just after the page finish loaded, before to make the screenshot and before extracting the links. ",n&&a.a.createElement(a.a.Fragment,null,"You need to export a function that will take as first parameter the ",a.a.createElement(rn,{code:!0},"page")," coming from Puppeteer.")),n&&a.a.createElement(nn,null,a.a.createElement(rn,{code:!0},"module.exports = async (page) => ...some code")))},on={border:"1px solid #EEE",marginBottom:15,width:"auto"},cn=(Object(b.a)({},Ue,{float:"left"}),{marginBottom:15}),ln={marginRight:10},sn={maxWidth:500,margin:"0px 0px 10px 0px"},un=n(315),pn=n.n(un),mn=n(47),fn=n.n(mn),dn=p.a.Paragraph,hn=function(){ct.a.warn("To be implemented.",2)},gn=function(){var e=Object(w.a)(v.a.mark((function e(t,n,r,a,o){var i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=ct.a.loading("Saving in progress...",0),e.next=4,Object(W.t)(t,n,Object(b.a)({id:r,source:a},o));case 4:i(),ct.a.success("Code saved.",2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),U.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,r,a,o){return e.apply(this,arguments)}}(),vn=function(e,t,n,r,a){return function(o){o.preventDefault(),a((function(a,o){a||gn(e,t,n,r,o)}))}},bn=S.a.create({name:"code"})((function(e){var t,n=e.storageType,r=e.projectId,o=e.setSource,i=e.id,c=e.code,l=e.form,s=l.getFieldDecorator,u=l.validateFields,p=e.location.state;return a.a.createElement(S.a,{onSubmit:vn(n,r,i,c.source,u)},a.a.createElement(S.a.Item,{style:sn},s("name",{initialValue:c.name||""})(a.a.createElement(j.a,{addonBefore:"Name"}))),a.a.createElement(S.a.Item,{style:sn},s("pattern",{rules:[{required:!0,message:"Please input a pattern!"}],initialValue:c.pattern||p&&p.pattern||""})(a.a.createElement(j.a,{addonBefore:"Pattern"}))),a.a.createElement(V,null,a.a.createElement(dn,null,"Pattern is using ",a.a.createElement("a",{href:"https://www.npmjs.com/package/minimatch",target:"_blank",rel:"noopener noreferrer"},"minimatch")," to match the urls to inject the code. It works by converting glob expressions into JavaScript RegExp objects.")),a.a.createElement("div",{style:cn},a.a.createElement(z.a,{icon:"save",htmlType:"submit",style:ln},"Save"),a.a.createElement(z.a,{icon:"caret-right",onClick:hn,style:ln},"Preview"),a.a.createElement(pn.a,{overlay:(t=o,a.a.createElement(fn.a,null,a.a.createElement(fn.a.Item,{key:"1",onClick:function(){t('module.exports = async function run(page) {\n    await page.evaluate(() => {\n        const div = document.createElement("div");\n        div.innerHTML = "Test-crawler is awesome!";\n        document.body.insertBefore(div, document.body.firstChild);\n    });\n}')}},"Test-crawler is awesome"),a.a.createElement(fn.a.Item,{key:"2",onClick:function(){t("module.exports = async function run(page) {\n    return await page.evaluate(() => {\n        Array.from(document.body.getElementsByTagName(\"a\"))\n             .filter(a => !a.href)\n             .forEach(a => a.click());\n        return Array.from(document.links).map(\n            link => link.href.replace('/?', '/iframe.html?')\n        );\n    });\n}")}},"Storybook"),a.a.createElement(fn.a.Item,{key:"3",onClick:function(){t("// expect library from jest is installed by default\n// but you can use any assertion tool of your choice\n// just install it and use it here :D\nconst expect = require('expect');\n\nmodule.exports = async function run(page) {\n  await expect(page.title()).resolves.toMatch('React App');\n  expect('a').toBe('b'); // fail\n}")}},"Expect assetion example")))},a.a.createElement(z.a,{style:ln},"Code snippet ",a.a.createElement(P.a,{type:"down"})))))})),En=p.a.Title,wn=function(e,t){return function(n){t(Object(b.a)({},e,{source:n}))}},yn=function(e){var t=e.match.params,n=t.id,r=t.projectId,o=t.storageType,i=e.location;se();var c=ae((function(){return Object(W.b)(o,r,n)})),l=c.error,s=c.result,u=c.setResult;return l?a.a.createElement(Je,{description:l.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(En,{level:3},"Add some code"),s?a.a.createElement(S.a,null,a.a.createElement(an,null),a.a.createElement(Bt,{projectId:r,storageType:o}),a.a.createElement(bn,{projectId:r,id:n,code:s,setSource:wn(s,u),location:i,storageType:o}),a.a.createElement(tn.a,{mode:"javascript",theme:"tomorrow",onChange:wn(s,u),fontSize:14,value:s.source.length?s.source:"module.exports = async function run(page) {\n// your code\n}",style:on})):a.a.createElement(we.a,null))},jn=p.a.Title,kn=function(){var e=Object(w.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,Object(W.k)();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),On=function(){var e=a.a.useState(),t=Object(ne.a)(e,2),n=t[0],r=t[1];return a.a.useEffect((function(){kn(r)}),[]),se(),a.a.createElement(a.a.Fragment,null,a.a.createElement(jn,{level:3},"Settings"),n?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,a.a.createElement("b",null,"Dir:")," ",n.dir)):a.a.createElement(we.a,null),a.a.createElement("p",null,a.a.createElement(z.a,{icon:"caret-right",size:"small",onClick:W.y},"Start crawlers")))},xn=p.a.Title,In=p.a.Text,Tn=function(e){var t=e.projectId,n=e.storageType,r=ae((function(){return Object(W.c)(n,t)})),o=r.error,i=r.result;return o?a.a.createElement(Je,{description:o.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(xn,{level:4},"For each page"),a.a.createElement(an,{full:!1}),i?a.a.createElement(be.a,{bordered:!0,dataSource:Object.values(i),renderItem:function(e){var r=e.id,o=e.name,i=e.pattern;return a.a.createElement(be.a.Item,{actions:[a.a.createElement(d.b,{to:B(n,t,r)},"Edit")]},a.a.createElement(be.a.Item.Meta,{title:a.a.createElement(d.b,{to:B(n,t,r)},o," ",a.a.createElement(In,{code:!0},i))}))}}):a.a.createElement(we.a,null),a.a.createElement("br",null),a.a.createElement(d.b,{to:B(n,t,Math.floor(Date.now()/1e3).toString())},a.a.createElement(z.a,{icon:"plus",size:"small"},"New code")))},Sn=p.a.Title,Cn=p.a.Paragraph,Pn=function(e,t,n,r){return Object(w.a)(v.a.mark((function a(){var o;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,o=ct.a.loading("Saving...",0),a.next=4,Object(W.r)(r,n,t,e);case 4:o(),ct.a.success("Code saved.",2),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),U.a.error({message:"Something went wrong!",description:a.t0.toString()});case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))},Rn=function(e){var t=e.type,n=e.projectId,r=e.storageType,o=e.title,i=e.info,c=e.codeParam,l=void 0===c?"":c,s=ae((function(){return Object(W.a)(r,n,t)})),u=s.error,p=s.result,m=s.setResult;return u?a.a.createElement(Je,{description:u.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(Sn,{level:4},o),a.a.createElement(V,null,a.a.createElement(Cn,null,i)),a.a.createElement(tn.a,{mode:"javascript",theme:"tomorrow",onChange:m,fontSize:14,value:(null===p||void 0===p?void 0:p.length)?p:"module.exports = async function run(".concat(l,") {\n// your code\n}"),style:Object(b.a)({},on,{height:200})}),a.a.createElement(z.a,{icon:"save",size:"small",onClick:Pn(p,t,n,r)},"Save"))},Ln=p.a.Title,Fn=function(e){var t=e.projectId,n=e.storageType;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ln,{level:3},"Codes"),a.a.createElement(Tn,{projectId:t,storageType:n}),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(Rn,{type:A.a.Before,projectId:t,storageType:n,title:"Before all",info:"This script will run when the test-crawler is starting, to give you the possibility to setup a working environment, for example to start a test server."}),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(Rn,{type:A.a.After,projectId:t,storageType:n,title:"After all",info:"This script will run when the test-crawler finish. You could for example use this script to send some notification.",codeParam:"totalDiffCount, totalErrorCount"}))},_n=function(e){var t=e.jobs,n=e.loadJobs,r=e.loadCrawlers,o=a.a.useState(!1),i=Object(ne.a)(o,2),c=i[0],l=i[1];return a.a.useEffect((function(){var e;return(null===t||void 0===t?void 0:t.length)?(!c&&l(!0),e=setInterval(n,3e4)):c&&(l(!1),r()),function(){return clearInterval(e)}}),[t,r,l,c]),(null===t||void 0===t?void 0:t.length)?a.a.createElement(be.a,{itemLayout:"horizontal",bordered:!0,dataSource:t,style:{marginBottom:10},renderItem:function(e){var t=e.status,n=e.startAt,r=e.stepsCount,o=e.stepsDone,i=e.currentStep,c=e.url;return a.a.createElement(be.a.Item,{actions:[a.a.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},"Open")]},a.a.createElement(be.a.Item.Meta,{title:a.a.createElement("span",null,"CI job ",rt(n.toString())),description:a.a.createElement(a.a.Fragment,null,!!r&&void 0!==o&&a.a.createElement(Ut.a,{percent:100/r*o,size:"small",format:function(){return"".concat(o," of ").concat(r)}}),a.a.createElement("span",null,a.a.createElement(p.a.Text,{code:!0},t)," ",i))}))}}):null},Dn=function(e,t,n,r){return Object(w.a)(v.a.mark((function o(){var i,c,l,s;return v.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,i=ct.a.loading("Starting crawlers",0),o.next=4,Object(W.x)(n,t);case 4:c=o.sent,l=c.timestamp,(s=c.redirect)?(setTimeout(r,5e3),setTimeout(r,1e4),U.a.open({duration:10,message:"Test-crawler started",description:"Test-crawler is running the crawlers on a remote container. To see live progress click open:",btn:a.a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},"Open")})):e.push(H(n,t,l)),i(),o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),U.a.error({message:"Something went wrong!",description:o.t0.toString()});case 14:case"end":return o.stop()}}),o,null,[[0,11]])})))},Un=function(e,t,n){var r=t.name,a=t.id,o=t.crawlerInput;return(function(){var t=Object(w.a)(v.a.mark((function t(i){var c,l;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=i.target.checked,t.next=3,Object(W.s)(e,Object(b.a)({},o,{autopin:c}),r,a);case 3:l=t.sent,n(l);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},Nn=function(e,t,n,r){return r>0?"loading":e||0!==t?"done"===n?"issues-close":"exclamation-circle":"check"},zn=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,o=e.history;se(An);var i=Jt(r,n),c=i.project,l=i.setProject,s=function(e,t){var n=ae(Object(w.a)(v.a.mark((function n(){var r;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(W.e)(e,t);case 2:return r=n.sent,n.abrupt("return",r.sort((function(e,t){var n=e.timestamp,r=t.timestamp;return parseInt(r,10)-parseInt(n,10)})));case 4:case"end":return n.stop()}}),n)})))),r=n.result,a=n.setResult,o=n.error,i=n.loading,c=n.call;return o&&U.a.warning({message:"Something went wrong while loading crawlers from project.",description:o.toString()}),{crawlers:r,setCrawlers:a,loading:i,loadCrawlers:c}}(r,n),u=s.crawlers,m=s.loading,f=s.loadCrawlers,h=ae((function(){return Object(W.g)(r,n)})),g=h.result,b=h.call;return a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a.Title,{level:3},"Project"),c?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,a.a.createElement("b",null,"Name:")," ",c.name),a.a.createElement("p",null,a.a.createElement("b",null,"ID:")," ",n),a.a.createElement("p",null,a.a.createElement("b",null,"URL:")," ",c.crawlerInput.url),a.a.createElement("p",null,a.a.createElement("b",null,"Screen:")," ",K(c.crawlerInput.viewport)),a.a.createElement("p",null,a.a.createElement("b",null,"Method:"),"urls"===c.crawlerInput.method?a.a.createElement(a.a.Fragment,null," ",a.a.createElement(P.a,{type:"ordered-list"})," URLs list"):a.a.createElement(a.a.Fragment,null," ",a.a.createElement(P.a,{type:"radar-chart"})," Spider bot",!!c.crawlerInput.limit&&a.a.createElement("span",{style:{color:"#999",fontSize:12}}," (Limit: ",c.crawlerInput.limit,")"))),a.a.createElement("p",null,a.a.createElement(I.a,{checked:c.crawlerInput.autopin,onChange:Un(r,c,l)},"Automatically pin new page founds.")),a.a.createElement("p",null,a.a.createElement(z.a,{icon:"caret-right",size:"small",onClick:Dn(o,n,r,b)},"Run")," \xa0",a.a.createElement(d.b,{to:J(r,n)},a.a.createElement(z.a,{icon:"pushpin",size:"small"},"Pins"))),a.a.createElement(_n,{jobs:g,loadJobs:b,loadCrawlers:f}),a.a.createElement(be.a,{itemLayout:"horizontal",bordered:!0,loading:m,dataSource:u,renderItem:function(e){var t=e.timestamp,o=e.diffZoneCount,i=e.errorCount,c=e.status,l=e.inQueue;return a.a.createElement(be.a.Item,{actions:[a.a.createElement(d.b,{to:H(r,n,t)},"Open")]},a.a.createElement(be.a.Item.Meta,{title:a.a.createElement(d.b,{to:H(r,n,t)},rt(t)),description:a.a.createElement(a.a.Fragment,null,a.a.createElement(P.a,{type:Nn(o,i,c,l)}),a.a.createElement("span",null," Diff: ",o," - Error: ",i," - In queue: ",l))}))}})):a.a.createElement(we.a,null),a.a.createElement("br",null),a.a.createElement(Fn,{projectId:n,storageType:r}))},An=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"This page give you an overview of a selected project. From there you can see all the crawlers that has been started and their results. To run a crawler click on ",a.a.createElement(z.a,{icon:"caret-right",size:"small"},"Run")),a.a.createElement("p",null,"After clicking on the run button, you will be either redirected to the result page or a job will appear above the list of crawler, this will depends of the crawling storage you will use."),a.a.createElement(p.a.Title,{level:4},"Codes"),a.a.createElement("p",null,"Under the list of crawlers, is a codes section. This will let you write your own code to interact with the crawler when the job is running. There is different phases where you can interact with the crawler: before, during and after crawling."),a.a.createElement("p",null,a.a.createElement("b",null,"Before all")),a.a.createElement("p",null,"This script will run when the test-crawler is starting, to give you the possibility to setup a working environment. This can be useful if you need to start a server to run your test against it."),a.a.createElement("p",null,a.a.createElement("b",null,"For each page")),a.a.createElement("p",null,"This give you the possibility to inject some code in the crawler while parsing the page. This code will be executed just after the page finish loaded, before to make the screenshot and before extracting the links. This can be really useful to manipulate the page before making the screenshot. For example, if you have dynamic element in your page, you can simply remove it. You could open some hidden element from an accordion. Run some e2e assertion with Jest. There is so much possibility with this feature..."),a.a.createElement("p",null,a.a.createElement("b",null,"After all")),a.a.createElement("p",null,"This script will run when the test-crawler finish. This can be useful to send the result to an API or in an email. In the following example, we will show you how to send result in slack:"),a.a.createElement("pre",null,a.a.createElement("code",null,"\n// Need to install @slack/web-api where the crawler is running.\n// with local storage just do yarn add @slack/web-api\n// with remote storage like GitHub you will need to customize the CI job\nconst { WebClient } = require('@slack/web-api');\n\nconst token = 'api_slack_token';\n// Given some known conversation ID (representing a public channel, private channel, DM or group DM)\nconst conversationId = '...';\n\nmodule.exports = async function run(totalDiffCount, totalErrorCount) {\n    const web = new WebClient(token);\n    const result = await web.chat.postMessage({\n        text: `Hi, crawler finish his job. We found ${totalDiffCount} diff(s) and ${totalErrorCount} error(s).`,\n        channel: conversationId,\n    });\n}\n            ")))},Mn=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,o=Jt(r,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:G(r,n)},null===o||void 0===o?void 0:o.name)))},Jn=function(e){var t=e.match.params,n=t.projectId,r=t.timestamp,o=t.storageType,i=Jt(o,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:G(o,n)},null===i||void 0===i?void 0:i.name)),a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:H(o,n,r)},"Results: ",rt(r))))},Bn=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,o=Jt(r,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:G(r,n)},null===o||void 0===o?void 0:o.name)),a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:J(r,n)},"Pins")))},Hn=function(e){var t=e.match.params,n=t.projectId,r=t.id,o=t.storageType,i=Jt(o,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:G(o,n)},null===i||void 0===i?void 0:i.name)),a.a.createElement(f.a.Item,null,a.a.createElement(d.b,{to:B(o,n,r)},"Code")))},Gn=n(316),Wn=n.n(Gn),qn=function(e){var t=e.children,n=le(),r=n.open,o=n.toggle,i=n.content;return a.a.createElement(s.a,null,t,!!r&&a.a.createElement(s.a.Sider,{theme:"light",breakpoint:"md",collapsedWidth:"100%",width:"40%",style:{padding:15,textAlign:"justify"}},a.a.createElement(p.a.Title,{level:3,style:{float:"right",fontStyle:"italic",color:"#CCC"}},"Documentation"),a.a.createElement(Wn.a,{offsetTop:10,style:{marginBottom:10}},a.a.createElement(z.a,{size:"small",shape:"circle",icon:"close",onClick:o})),a.a.createElement("br",null),i||a.a.createElement("p",null,"We are sorry, there is no documentation for this section. If you have any questions, please don't hesitate to ",a.a.createElement("a",{href:"https://github.com/apiel/test-crawler/issues",target:"_blank",rel:"noopener noreferrer"},"contact us"),".")))},Vn=s.a.Content,Zn=s.a.Header,Yn=p.a.Title,Qn={minHeight:"100vh"},$n={color:"#fff",marginTop:15,marginRight:15,float:"left"},Kn={background:"#fff",padding:24,margin:10,minHeight:280},Xn=function(){var e=le().toggle;return(a.a.createElement(d.a,null,a.a.createElement(qn,null,a.a.createElement(s.a,{style:Qn},a.a.createElement(Zn,null,a.a.createElement(d.b,{to:"/"},a.a.createElement(Yn,{level:3,style:$n},"Test-crawler")),a.a.createElement(fn.a,{theme:"dark",mode:"horizontal",selectable:!1,style:{paddingTop:10}},a.a.createElement(fn.a.Item,{key:"projects"},a.a.createElement(P.a,{type:"folder"}),a.a.createElement("span",{className:"nav-text"},"Projects"),a.a.createElement(d.b,{to:"/"})),a.a.createElement(fn.a.Item,{key:"doc",title:"Docs",onClick:e},a.a.createElement(P.a,{type:"question-circle"}),a.a.createElement("span",{className:"nav-text"},"Documentation")),a.a.createElement(fn.a.Item,{key:"settings",title:"settings"},a.a.createElement(P.a,{type:"setting"}),a.a.createElement("span",{className:"nav-text"},"Settings"),a.a.createElement(d.b,{to:"/settings"})))),a.a.createElement(f.a,{style:{margin:"10px 0 0 10px"}},a.a.createElement(h.a,{path:G(":storageType",":projectId"),exact:!0,component:Mn}),a.a.createElement(h.a,{path:H(":storageType",":projectId",":timestamp"),exact:!0,component:Jn}),a.a.createElement(h.a,{path:J(":storageType",":projectId"),exact:!0,component:Bn}),a.a.createElement(h.a,{path:B(":storageType",":projectId",":id"),exact:!0,component:Hn})),a.a.createElement(Vn,{style:Kn},a.a.createElement(h.a,{path:"/",exact:!0,component:Te}),a.a.createElement(h.a,{path:"/settings",exact:!0,component:On}),a.a.createElement(h.a,{path:M(":storageType"),exact:!0,component:me}),a.a.createElement(h.a,{path:J(":storageType",":projectId"),exact:!0,component:Xt}),a.a.createElement(h.a,{path:B(":storageType",":projectId",":id"),exact:!0,component:yn}),a.a.createElement(h.a,{path:H(":storageType",":projectId",":timestamp"),component:Vt}),a.a.createElement(h.a,{path:G(":storageType",":projectId"),exact:!0,component:zn}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var er=n(317);"apiel.github.io"===window.location.host&&er.hotjar.initialize(1680523,6),i.a.render(a.a.createElement(c.a,null,a.a.createElement((function(e){var t=e.children,n=new te.a,r=a.a.useState("open"===n.get("doc")),o=Object(ne.a)(r,2),i=o[0],c=o[1],l=a.a.useState(),s=Object(ne.a)(l,2),u=s[0],p=s[1],m=function(e){n.set("doc",e?"open":"close",{path:"/"}),c(e)};return a.a.createElement(ie.Provider,{value:{open:i,setOpen:m,content:u,setContent:p,toggle:function(){return m(!i)}}},t)}),null,a.a.createElement(Xn,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},88:function(e,t,n){"use strict";var r=n(2),a=n.n(r),o=n(9),i=n(51),c=n(83),l=n(85),s=n(84),u=n(86),p=n(59),m=n(301),f=function e(){Object(i.a)(this,e)};n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return g}));var d=new m.a;function h(e,t){return(new p.a).get(e)}var g=function(e){function t(e,n){var r;return Object(i.a)(this,t),(r=Object(l.a)(this,Object(s.a)(t).call(this))).ctx=n,r.storage=d,r}return Object(u.a)(t,e),Object(c.a)(t,[{key:"startCrawlers",value:function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),t}(f)},99:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.missingGitHubConfig="cannot use GitHub if no config provided"}(r||(r={}))}},[[318,1,2]]]);
//# sourceMappingURL=main.bc6c68d9.chunk.js.map