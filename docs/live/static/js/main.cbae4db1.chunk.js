(this["webpackJsonptest-crawler"]=this["webpackJsonptest-crawler"]||[]).push([[0],{101:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.missingGitHubConfig="Please authenticate to use GitHub api"}(r||(r={}))},103:function(e,t,n){"use strict";var r=n(2),a=n.n(r),o=n(9),i=n(61),c=n(96),l=n(98),s=n(97),u=n(100),p=n(37),m=n(375),f=function e(){Object(i.a)(this,e)};n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return g}));var h=new m.a;function d(e,t){return(new p.a).get(e)}var g=function(e){function t(e,n){var r;return Object(i.a)(this,t),(r=Object(l.a)(this,Object(s.a)(t).call(this))).ctx=n,r.storage=h,r}return Object(u.a)(t,e),Object(c.a)(t,[{key:"startCrawlers",value:function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),t}(f)},13:function(e,t,n){"use strict";(function(e){n.d(t,"l",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"k",(function(){return p})),n.d(t,"p",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"o",(function(){return h})),n.d(t,"t",(function(){return d})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"i",(function(){return b})),n.d(t,"j",(function(){return w})),n.d(t,"s",(function(){return E})),n.d(t,"a",(function(){return y})),n.d(t,"u",(function(){return j})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return O})),n.d(t,"m",(function(){return x})),n.d(t,"r",(function(){return I})),n.d(t,"q",(function(){return S})),n.d(t,"w",(function(){return C})),n.d(t,"x",(function(){return R})),n.d(t,"v",(function(){return L})),n.d(t,"b",(function(){return F})),n.d(t,"y",(function(){return N})),n.d(t,"z",(function(){return U}));var r=n(2),a=n.n(r),o=n(9),i=n(25);function c(){return l.apply(this,arguments)}function l(){return(l=Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{dir:e});case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function s(e){return new i.a(e,this).info()}function u(e,t){return new i.a(e,this).jobs(t)}function p(e){return new i.a(e,this).repo()}function m(e){return new i.a(e,this).repos()}function f(e,t){return new i.a(e,this).loadProject(t)}function h(e){return new i.a(e,this).loadProjects()}function d(e,t,n,r){return new i.a(e,this).saveProject(t,n,r)}function g(e,t,n){return new i.a(e,this).getCrawler(t,n)}function v(e,t){return new i.a(e,this).getAllCrawlers(t)}function b(e,t,n){return new i.a(e,this).getPages(t,n)}function w(e,t){return new i.a(e,this).getPins(t)}function E(e,t,n,r){return new i.a(e,this).saveBeforeAfterCode(t,n,r)}function y(e,t,n){return new i.a(e,this).getBeforeAfterCode(t,n)}function j(e,t,n){return new i.a(e,this).saveCode(t,n)}function k(e,t,n){return new i.a(e,this).loadCode(t,n)}function O(e,t){return new i.a(e,this).getCodeList(t)}function x(e,t,n,r){return T.apply(this,arguments)}function T(){return(T=Object(o.a)(a.a.mark((function e(t,n,r,o){var c,l,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.length>4&&void 0!==s[4]?s[4]:300,c=new i.a(t,this),e.next=4,c.image(n,r,o);case 4:if(l=e.sent,console.log("img",l),l){e.next=8;break}throw new Error("Cannot load image.");case 8:return e.abrupt("return","data:image/png;base64, ".concat(l.toString("base64")));case 9:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function I(e,t,n){return new i.a(e,this).removeFromPins(t,n)}function S(e,t,n,r){return new i.a(e,this).copyToPins(t,n,r)}function C(e,t,n,r,a,o){return P.apply(this,arguments)}function P(){return(P=Object(o.a)(a.a.mark((function e(t,n,r,o,c,l){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new i.a(t,this),e.abrupt("return",s.setZoneStatus(n,r,o,l,c));case 2:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function R(e,t,n,r,a){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(a.a.mark((function e(t,n,r,o,c){var l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=new i.a(t,this),e.abrupt("return",l.setZoneStatus(n,r,o,c));case 2:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function L(e,t,n,r){return new i.a(e,this).setCrawlerStatus(t,n,r)}function F(e){return D.apply(this,arguments)}function D(){return(D=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.a(t,this),e.abrupt("return",n.browsers);case 2:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function N(e,t,n){return new i.a(e,this).startCrawler(t,n)}function U(){return new i.a(void 0,this).startCrawlers()}}).call(this,"/")},21:function(e,t,n){"use strict";var r,a,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),function(e){e.valid="valid",e.zonePin="zone-pin",e.report="report",e.diff="diff"}(r||(r={})),function(e){e.ChromePuppeteer="chrome-puppeteer",e.FirefoxSelenium="firefox-selenium",e.ChromeSelenium="chrome-selenium",e.SafariSelenium="safari-selenium",e.IeSelenium="ie-selenium"}(a||(a={})),function(e){e.Before="before",e.After="after"}(o||(o={}))},25:function(e,t,n){"use strict";var r=n(28),a=n(27),o=n(71),i=n(2),c=n.n(i),l=n(9),s=n(61),u=n(96),p=n(98),m=n(97),f=n(100),h=n(52),d=n(157),g=n(374),v=n(21),b=function(e){function t(e,n){var r;return Object(s.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e,n))).ctx=n,r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"repos",value:function(){return this.storage.repos()}},{key:"repo",value:function(){return this.storage.getRepo()}},{key:"info",value:function(){return this.storage.info()}},{key:"jobs",value:function(e){return this.storage.jobs(e)}},{key:"loadProject",value:function(e){return this.storage.readJSON(this.join(e,"project.json"))}},{key:"loadProjects",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.readdir(r.PROJECT_FOLDER);case 2:return t=e.sent,e.abrupt("return",Promise.all(t.map((function(e){return n.loadProject(e)}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveProject",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r||(r=d(n)),a={id:r,name:n,crawlerInput:t},e.next=4,this.storage.saveJSON(this.join(r,"project.json"),a);case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getCrawler",value:function(e,t){var n=this.join(e,r.CRAWL_FOLDER,t,"_.json");return this.storage.readJSON(n)}},{key:"getAllCrawlers",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,o,i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.join(t,r.CRAWL_FOLDER),e.next=3,this.storage.readdir(n);case 3:return a=e.sent,e.next=6,Promise.all(a.map((function(e){return i.getCrawler(t,e)})));case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"copyToPins",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,a){var o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.join(t,r.CRAWL_FOLDER,n,"".concat(a,".json")),e.next=3,this.storage.readJSON(o);case 3:if(!(null===(i=e.sent)||void 0===i?void 0:i.png)){e.next=9;break}if(i.png.diff={pixelDiffRatio:0,zones:[]},!(i.png.diff.pixelDiffRatio>0)){e.next=9;break}return e.next=9,this.storage.saveJSON(o,i);case 9:return e.next=11,this.storage.saveJSON(this.join(t,r.PIN_FOLDER,"".concat(a,".json")),i);case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"removeFromPins",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.remove(this.join(t,r.PIN_FOLDER,"".concat(n,".json")));case 2:return e.abrupt("return",this.getPins(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"image",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,a){var o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pin"!==n){e.next=7;break}return e.next=3,this.storage.readJSON(this.join(t,r.PIN_FOLDER,"".concat(a,".json")));case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return");case 6:n=o.timestamp;case 7:return e.abrupt("return",this.storage.image(this.join(t,r.SNAPSHOT_FOLDER,"".concat(n,"-").concat(a,".png"))));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveBeforeAfterCode",value:function(e,t,n){if(!Object.values(v.a).includes(t))throw new Error("Unknown code type ".concat(t,"."));var r=this.join(e,"".concat(t,".js"));return n.length?this.storage.saveFile(r,n):this.storage.remove(r)}},{key:"getBeforeAfterCode",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.values(v.a).includes(n)){e.next=2;break}throw new Error("Unknown code type ".concat(n,"."));case 2:return e.prev=2,e.next=5,this.storage.read(this.join(t,"".concat(n,".js")));case 5:return r=e.sent,e.abrupt("return",(null===r||void 0===r?void 0:r.toString())||"");case 9:e.prev=9,e.t0=e.catch(2);case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveCode",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var i,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.source,l=Object(o.a)(n,["source"]),e.next=3,this.getCodeList(t);case 3:return(s=e.sent)[n.id]=l,e.next=7,this.storage.saveJSON(this.join(t,r.CODE_FOLDER,"list.json"),Object(a.a)({},s));case 7:return e.next=9,this.storage.saveFile(this.join(t,r.CODE_FOLDER,"".concat(n.id,".js")),i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadCode",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var o,i,l,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCodeList(t);case 2:if(o=e.sent,i=o[n],l=this.join(t,r.CODE_FOLDER,"".concat(n,".js")),!i){e.next=12;break}return e.next=8,this.storage.read(l);case 8:if(!(s=e.sent)){e.next=12;break}return u=s.toString(),e.abrupt("return",Object(a.a)({},i,{source:u}));case 12:return e.abrupt("return",{id:n,name:"",pattern:"",source:""});case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCodeList",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.join(t,r.CODE_FOLDER,"list.json"),e.next=3,this.storage.readJSON(n);case 3:return a=e.sent,e.abrupt("return",a||{});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPins",value:function(e){return this.getPinsInFolder(this.join(e,r.PIN_FOLDER))}},{key:"getPin",value:function(e,t){return this.getPageInFolder(this.join(e,r.PIN_FOLDER),t)}},{key:"getPages",value:function(e,t){return this.getPinsInFolder(this.join(e,r.CRAWL_FOLDER,t))}},{key:"getPageInFolder",value:function(e,t){return this.storage.readJSON(Object(h.join)(e,"".concat(t,".json")))}},{key:"getPinsInFolder",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.readdir(t);case 2:return n=e.sent,e.abrupt("return",Promise.all(n.filter((function(e){return".json"===Object(h.extname)(e)&&"_.json"!==e})).map((function(e){return r.storage.readJSON(Object(h.join)(t,e))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCrawlerStatus",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,a){var o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.join(t,r.CRAWL_FOLDER,n,"_.json"),e.next=3,this.storage.readJSON(o);case 3:return(i=e.sent).status=a,e.next=7,this.storage.saveJSON(o,i);case 7:return e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"setZoneStatus",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,o,i,l){var s,u,p,m,f,d,b,w,E,y,j,k,O;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=this.join(t,r.CRAWL_FOLDER,n),m=Object(h.join)(p,"".concat(o,".json")),e.next=4,this.storage.readJSON(m);case 4:if(f=e.sent,!l||i!==v.c.zonePin){e.next=13;break}return y=this.join(t,r.PIN_FOLDER,"".concat(o,".json")),e.next=9,this.storage.readJSON(y);case 9:return(null===(j=e.sent)||void 0===j?void 0:null===(d=j.png)||void 0===d?void 0:null===(b=d.diff)||void 0===b?void 0:b.zones)&&(null===f||void 0===f?void 0:null===(w=f.png)||void 0===w?void 0:null===(E=w.diff)||void 0===E?void 0:E.zones)&&(l&&j.png.diff.zones.push(Object(a.a)({},f.png.diff.zones[l],{status:i})),(k=j.png.diff.zones.map((function(e){return e.zone}))).sort((function(e,t){return e.xMin*e.yMin-t.xMin*t.yMin})),O=Object(g.groupOverlappingZone)(k),j.png.diff.zones=O.map((function(e){return{zone:e,status:i}}))),e.next=13,this.storage.saveJSON(y,j);case 13:return(null===f||void 0===f?void 0:null===(s=f.png)||void 0===s?void 0:null===(u=s.diff)||void 0===u?void 0:u.zones)&&(l?f.png.diff.zones[l].status=i:f.png.diff.zones.forEach((function(e){return e.status=i}))),e.next=16,this.storage.saveJSON(m,f);case 16:return e.abrupt("return",this.getPages(t,n));case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,o){return e.apply(this,arguments)}}()},{key:"startCrawler",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r,a,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Math.floor(Date.now()/1e3).toString(),o={projectId:t,timestamp:a},e.next=4,this.storage.crawl(o,30,null===(r=this.ctx)||void 0===r?void 0:r.push,n);case 4:return i=e.sent,e.abrupt("return",{timestamp:a,redirect:i});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"join",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return h.join.apply(void 0,[r.PROJECT_FOLDER,e].concat(n))}},{key:"browsers",get:function(){return this.storage.browsers}}]),t}(n(103).a);n.d(t,"a",(function(){return b}))},28:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"ROOT_FOLDER",(function(){return o})),n.d(t,"PROJECT_FOLDER",(function(){return i})),n.d(t,"CRAWL_FOLDER",(function(){return c})),n.d(t,"PIN_FOLDER",(function(){return l})),n.d(t,"CODE_FOLDER",(function(){return s})),n.d(t,"QUEUE_FOLDER",(function(){return u})),n.d(t,"SNAPSHOT_FOLDER",(function(){return p})),n.d(t,"MAX_HISTORY",(function(){return m})),n.d(t,"TIMEOUT",(function(){return f})),n.d(t,"CONSUMER_COUNT",(function(){return h})),n.d(t,"USER_AGENT",(function(){return d})),n.d(t,"CONSUME_TIMEOUT",(function(){return g})),n.d(t,"config",(function(){return v}));var r=n(27),a=n(52),o=Object({NODE_ENV:"production",PUBLIC_URL:"/test-crawler/live"}).ROOT_FOLDER||Object(a.join)(e,"../../.."),i=Object({NODE_ENV:"production",PUBLIC_URL:"/test-crawler/live"}).PROJECT_FOLDER||"test-crawler",c="crawl",l="pin",s="code",u="queue",p="snapshot",m=10,f=1e4,h=5,d="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",g=Object({NODE_ENV:"production",PUBLIC_URL:"/test-crawler/live"}).CONSUME_TIMEOUT?parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"/test-crawler/live"}).CONSUME_TIMEOUT,10):0,v=function(){var e,t=Object(a.join)(o,"test-crawler.config.js");try{e=n(402)(t)}catch(i){e={}}return Object(r.a)({remote:{}},e)}()}.call(this,"/")},375:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return O}));var r=n(123),a=n(27),o=n(24),i=n(2),c=n.n(i),l=n(9),s=n(61),u=n(96),p=n(98),m=n(97),f=n(100),h=n(376),d=n(52),g=n(238),v=n.n(g),b=n(21),w=n(28),E=n(101),y=n(103),j="https://api.github.com",k="\nname: Test-crawler CI\n\non:\n  repository_dispatch:\n    types: [".concat("test-crawler","]\n\njobs:\n  test-crawler:\n    if: github.event.client_payload.os == 'default'\n    runs-on: macos-latest\n\n    steps:\n    - uses: actions/checkout@v2\n    - name: Enable safari driver\n      run: |\n        sudo safaridriver --enable\n        safaridriver -p 0 &\n    - name: Run test-crawler ${{ github.event.client_payload.projectId }}\n      uses: apiel/test-crawler/actions/run@master\n    - name: Push changes\n      uses: apiel/test-crawler/actions/push@master\n      with:\n        token: ${{ secrets.GITHUB_TOKEN }}\n\n  test-crawler-windows:\n    if: github.event.client_payload.os == 'win'\n    runs-on: windows-latest\n\n    steps:\n    - uses: actions/checkout@v2\n    - uses: warrenbuckley/Setup-Nuget@v1\n    - name: Enable ie driver\n      run: |\n        nuget install Selenium.WebDriver.IEDriver -Version 3.150.0\n        # nuget install Selenium.WebDriver.MicrosoftDriver -Version 17.17134.0\n        # nuget install Selenium.WebDriver.MicrosoftWebDriver -Version 10.0.17134\n    - name: Run test-crawler ${{ github.event.client_payload.projectId }}\n      uses: apiel/test-crawler/actions/run@master\n    - name: Push changes\n      uses: apiel/test-crawler/actions/push@master\n      with:\n        token: ${{ secrets.GITHUB_TOKEN }}\n"),O=function(t){function n(e){var t;return Object(s.a)(this,n),(t=Object(p.a)(this,Object(m.a)(n).call(this))).ctx=e,t.config=void 0,t.config=w.config.remote.github,t}return Object(f.a)(n,t),Object(u.a)(n,[{key:"readdir",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getContents(t);case 3:return n=e.sent,r=n.data,e.abrupt("return",r.map((function(e){return e.name})));case 8:if(e.prev=8,e.t0=e.catch(0),404!==(null===e.t0||void 0===e.t0?void 0:null===(a=e.t0.response)||void 0===a?void 0:a.status)){e.next=12;break}return e.abrupt("return",[]);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"image",value:function(){var t=Object(l.a)(c.a.mark((function t(n){var r,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getContents(n);case 2:if(r=t.sent,!(a=r.data).content){t.next=6;break}return t.abrupt("return",e.from(a.content,"base64"));case 6:return t.abrupt("return",a.download_url);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"blob",value:function(){var t=Object(l.a)(c.a.mark((function t(n){var r,a,o,i,l,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getContents(Object(d.dirname)(n));case 2:if(r=t.sent,a=r.data,o=Object(d.basename)(n),i=a.find((function(e){return e.name===o}))){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,this.call({url:"".concat(this.blobUrl,"/").concat(i.sha)});case 10:return l=t.sent,s=l.data.content,t.abrupt("return",e.from(s,"base64"));case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"saveBlob",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r,a,i,l,s,u,p,m,f,h,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.remove(t);case 2:return e.next=4,this.call({url:"".concat(this.baseRepo,"/commits")});case 4:return r=e.sent,a=Object(o.a)(r.data,1),i=a[0],l=i.sha,s=i.commit.tree.sha,e.next=11,this.call({method:"POST",url:this.blobUrl,data:{content:n.toString("base64"),encoding:"base64"}});case 11:return u=e.sent,p=u.data.sha,e.next=15,this.call({method:"POST",url:"".concat(this.baseRepo,"/git/trees"),data:{base_tree:s,tree:[{path:t,mode:"100644",sha:p}]}});case 15:return m=e.sent,f=m.data.sha,e.next=19,this.call({method:"POST",url:"".concat(this.baseRepo,"/git/commits"),data:{message:"".concat("[test-crawler]"," save blob"),tree:f,parents:[l]}});case 19:return h=e.sent,d=h.data.sha,e.next=23,this.call({method:"PATCH",url:"".concat(this.baseRepo,"/git/refs/heads/master"),data:{sha:d}});case 23:console.log("Blob saved",t);case 24:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"read",value:function(){var t=Object(l.a)(c.a.mark((function t(n){var r,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getContents(n);case 2:return r=t.sent,a=r.data.content,t.abrupt("return",e.from(a,"base64"));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"readJSON",value:function(){var e=Object(l.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.token&&this.user){e.next=2;break}throw new Error(E.a.missingGitHubConfig);case 2:return e.prev=2,e.t0=JSON,e.next=6,this.read(t);case 6:return e.t1=e.sent.toString(),e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 10:return e.prev=10,e.t2=e.catch(2),e.abrupt("return",void 0);case 13:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContents(t);case 2:return n=e.sent,r=n.data.sha,a=JSON.stringify({message:"".concat("[test-crawler]"," delete file"),sha:r}),e.next=7,this.call({method:"DELETE",url:"".concat(this.contentsUrl,"/").concat(t),data:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveFile",value:function(){var t=Object(l.a)(c.a.mark((function t(n,r){var o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.repo){t.next=2;break}throw new Error("GitHub repository required.");case 2:return t.next=4,this.getSha(n);case 4:return o=t.sent,i=JSON.stringify(Object(a.a)({message:"".concat("[test-crawler]"," save file"),content:e.from(r).toString("base64")},o&&{sha:o})),t.next=8,this.call({method:"PUT",url:"".concat(this.contentsUrl,"/").concat(n),data:i});case 8:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getSha",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getContents(t);case 3:if(n=e.sent,!(null===(r=n.data)||void 0===r?void 0:r.sha)){e.next=7;break}return e.abrupt("return",r.sha);case 7:e.next=13;break;case 9:if(e.prev=9,e.t0=e.catch(0),404===(null===e.t0||void 0===e.t0?void 0:null===(a=e.t0.response)||void 0===a?void 0:a.status)){e.next=13;break}throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"saveJSON",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveFile(t,JSON.stringify(n,null,4)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"copy",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.read(t);case 2:(r=e.sent)&&this.saveFile(n,r.toString());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"copyBlob",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.blob(t);case 2:if(!(r=e.sent)){e.next=6;break}return e.next=6,this.saveBlob(n,r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"crawl",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n,r,a){var o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t||void 0===t?void 0:t.projectId)){e.next=6;break}return e.next=3,this.saveFile(".github/workflows/test-crawler.yml",k);case 3:return o=a===b.b.IeSelenium?"win":"default",e.next=6,this.call({method:"POST",url:"".concat(this.ciDispatchUrl),data:{event_type:"test-crawler",client_payload:{projectId:t.projectId,os:o}}});case 6:return e.abrupt("return",this.redirectUrl);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"repos",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:"".concat(j,"/users/").concat(null===(t=this.config)||void 0===t?void 0:t.user,"/repos?sort=updated&per_page=1000")});case 2:return n=e.sent,r=n.data,e.abrupt("return",r.map((function(e){return e.name})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRepo",value:function(){var e=Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.repo);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"info",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:"".concat(j,"/rate_limit")});case 2:return t=e.sent,n=t.data.rate,r=n.limit,a=n.remaining,e.abrupt("return","For GitHub API requests, you can make up to 5000 requests per hour.\n        Every pages of the test-crawler UI is using multiples request at once. Your\n        current rate limit is: ".concat(a," of ").concat(r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"jobs",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call({url:this.runsUrl});case 2:return n=e.sent,a=n.data.workflow_runs,e.next=6,this.getInProgressJobs(t,a);case 6:return o=e.sent,i=this.getQueuedJobs(a),e.abrupt("return",[].concat(Object(r.a)(i),Object(r.a)(o)));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueuedJobs",value:function(e){return e.filter((function(e){var t=e.status;return!["in_progress","completed"].includes(t)})).map((function(e){var t=e.id,n=e.html_url,r=e.status,a=e.created_at,o=e.updated_at;return{id:t,url:n,status:r,startAt:Math.round(new Date(a).getTime()/1e3),lastUpdate:Math.round(new Date(o).getTime()/1e3)}}))}},{key:"getInProgressJobs",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var r,a,i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.filter((function(e){return"in_progress"===e.status})).map((function(e){return e.id})),a=r.map(function(){var e=Object(l.a)(c.a.mark((function e(n){var r,a,l,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.call({url:"".concat(i.baseRepo,"/actions/runs/").concat(n,"/jobs")});case 2:if(r=e.sent,a=r.data.jobs,l=Object(o.a)(a,1),s=l[0],!(void 0!==s.steps.find((function(e){return e.name.includes(t)})))){e.next=9;break}return u=s.steps.find((function(e){return"in_progress"===e.status})),e.abrupt("return",{id:n,url:s.html_url,status:s.status,startAt:Math.round(new Date(s.started_at).getTime()/1e3),stepsCount:s.steps.length,stepsDone:s.steps.filter((function(e){return"completed"===e.status})).length,currentStep:(null===u||void 0===u?void 0:u.name)||"unknown",lastUpdate:Math.round(new Date((null===u||void 0===u?void 0:u.started_at)||s.started_at).getTime()/1e3)});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(a);case 4:return e.t0=function(e){return e},e.abrupt("return",e.sent.filter(e.t0));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"call",value:function(e){if(!this.token||!this.user)throw new Error(E.a.missingGitHubConfig);return v()(Object(a.a)({},e,{headers:Object(a.a)({},null===e||void 0===e?void 0:e.headers,{Authorization:"token ".concat(this.token)})}))}},{key:"getContents",value:function(e){return this.call({url:"".concat(this.contentsUrl,"/").concat(e)})}},{key:"browsers",get:function(){return Object.values(b.b)}},{key:"baseRepo",get:function(){return"".concat(j,"/repos/").concat(this.user,"/").concat(this.repo)}},{key:"contentsUrl",get:function(){return"".concat(this.baseRepo,"/contents")}},{key:"blobUrl",get:function(){return"".concat(this.baseRepo,"/git/blobs")}},{key:"ciDispatchUrl",get:function(){return"".concat(this.baseRepo,"/dispatches")}},{key:"runsUrl",get:function(){return"".concat(this.baseRepo,"/actions/workflows/test-crawler.yml/runs?event=repository_dispatch")}},{key:"redirectUrl",get:function(){return"https://github.com/".concat(this.user,"/").concat(this.repo,"/actions")}},{key:"user",get:function(){var e,t;return(null===(e=Object(y.b)("github",this.ctx))||void 0===e?void 0:e.user)||(null===(t=this.config)||void 0===t?void 0:t.user)}},{key:"token",get:function(){var e,t;return(null===(e=Object(y.b)("github",this.ctx))||void 0===e?void 0:e.token)||(null===(t=this.config)||void 0===t?void 0:t.user)}},{key:"repo",get:function(){var e;return Object(y.b)("githubRepo",this.ctx)||(null===(e=this.config)||void 0===e?void 0:e.defaultRepo)}}]),n}(h.a)}).call(this,n(38).Buffer)},376:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(61),a=function e(){Object(r.a)(this,e)}},392:function(e,t,n){e.exports=n(917)},399:function(e,t,n){},400:function(e,t,n){},402:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=402},612:function(e,t){},614:function(e,t){},648:function(e,t){},649:function(e,t){},917:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(8),i=n.n(o),c=n(99),l=(n(399),n(85)),s=n.n(l),u=n(11),p=n.n(u),m=n(40),f=n.n(m),h=n(18),d=n(72);n(400);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var b=a.a.createElement("path",{d:"M325.8166665077209,137.29999988079066 c146.97,0 251.77,73.76 322.73,155.31 V1.4999998807907104 h-647.5 v292.48 C72.47666650772089,211.8799998807907 178.03666650772095,137.29999988079066 325.8166665077209,137.29999988079066 z"}),w=a.a.createElement("rect",{x:1.0366616249084473,y:506.1999510526657,width:647.5,height:142.8000030517578}),E=a.a.createElement("circle",{cx:324.79667139053345,cy:325.2499998807907,r:125.18000030517578}),y=function(e){var t=e.svgRef,n=e.title,r=v(e,["svgRef","title"]);return a.a.createElement("svg",g({viewBox:"0 0 647.5 647.5",ref:t},r),n?a.a.createElement("title",null,n):null,b,w,E)},j=a.a.forwardRef((function(e,t){return a.a.createElement(y,g({svgRef:t},e))})),k=(n.p,n(2)),O=n.n(k),x=n(27),T=n(71),I=n(9),S=n(56),C=n.n(S),P=n(380),R=n.n(P),_=n(164),L=n.n(_),F=n(26),D=n.n(F),N=n(10),U=n.n(N),z=n(163),A=n.n(z),M=n(172),B=n.n(M),J=n(32),H=n.n(J),G=n(19),W=n.n(G),q=n(21);function V(e){return"/new/".concat(e)}function Y(e,t){return"/pins/".concat(e,"/").concat(t)}function $(e,t,n){return"/code/".concat(e,"/").concat(t,"/").concat(n)}function Z(e,t,n){return"/results/".concat(e,"/").concat(t,"/").concat(n)}function Q(e,t){return"/project/".concat(e,"/").concat(t)}var K=n(13),X={lineHeight:1.2,borderLeft:"8px solid #EEE",paddingLeft:15,color:"#666",textAlign:"justify"},ee=function(e){var t=e.children;return a.a.createElement("div",{style:X},t)},te=[{name:"Desktop - 800x600",value:{width:800,height:600}},{name:"Desktop - 1024x768",value:{width:1024,height:768}},{name:"Desktop - 1920x1080",value:{width:1920,height:1080}},{name:"iPhone 5 - 320x568",value:{width:320,height:568,isMobile:!0,hasTouch:!0}},{name:"iPhone 6 - 375x667",value:{width:375,height:667,isMobile:!0,hasTouch:!0}},{name:"Ipad - 768x1024",value:{width:768,height:1024,isMobile:!0,hasTouch:!0}},{name:"Galaxy S5 - 360x640",value:{width:360,height:640,isMobile:!0,hasTouch:!0}}],ne=te.map((function(e){var t=e.value,n=Object(T.a)(e,["value"]);return Object(x.a)({},n,{value:JSON.stringify(t)})})),re=function(e){var t=JSON.stringify(e),n=ne.findIndex((function(e){return e.value===t}));if(-1!==n)return ne[n].name;var r=e.width,a=e.height,o=e.isMobile;return"".concat(r,"x").concat(a).concat(o&&" mobile")},ae=n(46),oe=n.n(ae),ie=n(37),ce=n(24),le=function(e,t,n,r){return Object(I.a)(O.a.mark((function a(){var o;return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n(void 0),r(!0),a.next=5,e();case 5:o=a.sent,t(o),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),n(a.t0);case 12:r(!1);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))},se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=a.a.useState(n),o=Object(ce.a)(r,2),i=o[0],c=o[1],l=a.a.useState(),s=Object(ce.a)(l,2),u=s[0],p=s[1],m=a.a.useState(!1),f=Object(ce.a)(m,2),h=f[0],d=f[1],g=le(e,c,p,d);return a.a.useEffect((function(){g()}),t),{loading:h,result:i,call:g,error:u,setResult:c}},ue=function(e){var t=e.storageType,n=e.loadProjects,r=(e.defaultValue,se((function(){return Object(K.p)(t)})).result),o=se((function(){return Object(K.k)(t)})).result;return r?a.a.createElement(oe.a,{showSearch:!0,defaultValue:o,onChange:function(e){(new ie.a).set("githubRepo",e,{path:"/"}),n&&n()},style:{width:200},placeholder:"repository"},r.map((function(e){return a.a.createElement(oe.a.Option,{key:e,value:e},e)}))):null},pe=a.a.createContext({open:!1,toggle:function(){},setOpen:function(){},setContent:function(){}});var me,fe=function(){return a.a.useContext(pe)},he=function(e){var t=fe().setContent;a.a.useEffect((function(){t(e)}),[])},de=function(){var e=Object(I.a)(O.a.mark((function e(t,n,r){var a,o,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.name,o=r.viewport,i=Object(T.a)(r,["name","viewport"]),e.prev=1,e.next=4,Object(K.t)(t,Object(x.a)({},i,{viewport:JSON.parse(o)}),a,void 0);case 4:n.push("/"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),H.a.error({message:"Something went wrong!",description:e.t0.toString()});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),ge=function(e,t,n){return function(r){r.preventDefault(),n((function(n,r){n||de(e,t,r)}))}},ve=D.a.create({name:"start_crawler"})((function(e){var t=e.history,n=e.match.params.storageType,r=e.form,o=r.getFieldDecorator,i=r.validateFields,c=r.getFieldValue,l=se((function(){return Object(K.b)(n)})).result;return he(be),a.a.createElement(D.a,{onSubmit:ge(n,t,i)},a.a.createElement(D.a.Item,null,o("name",{rules:[{required:!0,message:"Please give a name to the project."}]})(a.a.createElement(C.a,{addonBefore:"Name",placeholder:"Project name"}))),a.a.createElement(D.a.Item,null,o("url",{rules:[{required:!0,message:"Please input an URL to crawl."}]})(a.a.createElement(C.a,{placeholder:"https://domain.com/",addonBefore:"URL"}))),a.a.createElement("div",null,a.a.createElement(D.a.Item,{label:"Browser",className:"item-inline"},o("browser",{initialValue:q.b.ChromePuppeteer,rules:[{required:!0,message:"Please select a browser."}]})(a.a.createElement(oe.a,null,null===l||void 0===l?void 0:l.map((function(e){return a.a.createElement(oe.a.Option,{key:e,value:e},e)}))))),a.a.createElement(D.a.Item,{label:"Viewport",className:"item-inline"},o("viewport",{initialValue:JSON.stringify(te[0].value),rules:[{required:!0,message:"Please select viewport."}]})(a.a.createElement(oe.a,null,ne.map((function(e){var t=e.value,n=e.name;return a.a.createElement(oe.a.Option,{key:t,value:t},n)})))))),a.a.createElement("div",null,a.a.createElement(D.a.Item,{label:"Method",className:"item-inline"},o("method",{initialValue:"spiderbot",rules:[{required:!0}]})(a.a.createElement(B.a.Group,{size:"small"},a.a.createElement(B.a.Button,{value:"spiderbot"},a.a.createElement(U.a,{type:"radar-chart"})," Spider bot"),a.a.createElement(B.a.Button,{value:"urls"},a.a.createElement(U.a,{type:"ordered-list"})," URLs list")))),"spiderbot"===c("method")&&a.a.createElement(D.a.Item,{label:"Limit",className:"item-inline"},o("limit")(a.a.createElement(R.a,{min:0,size:"small"})),"\xa0",a.a.createElement(A.a,{content:a.a.createElement("div",null,a.a.createElement("b",null,"Limit the number of sibling pages. "),"For example, with the urls:",a.a.createElement("ul",null,a.a.createElement("li",null,"/item/1"),a.a.createElement("li",null,"/item/2"),a.a.createElement("li",null,"/item/3"),a.a.createElement("li",null,"/item/4"))," using the limit ",a.a.createElement("b",null,"2")," will only crawl ",a.a.createElement("b",null,"/item/1")," and ",a.a.createElement("b",null,"/item/2"),".",a.a.createElement("br",null),a.a.createElement("br",null),"Use ",a.a.createElement("b",null,"0")," to skip the limit."),trigger:"click",overlayStyle:{width:200}},a.a.createElement(U.a,{type:"question-circle"}))),a.a.createElement(ee,null,a.a.createElement(p.a.Paragraph,{ellipsis:{rows:1,expandable:!0}},a.a.createElement("b",null,"Spider bot")," crawling method will get all the links inside the page of the given URL and crawl the children. It will then continue do the same with the children till no new link is found. Be careful if you have big website, this is most likely not the right solution for you."),a.a.createElement(p.a.Paragraph,{ellipsis:{rows:1,expandable:!0}},a.a.createElement("b",null,"URLs list")," crawling method will crawl a specific sets of URLs. In the URL input field you must provide an endpoint containing a list of URLs (a simple text format, with one URL per line). The crawler will crawl each of those URL only and will not try to find links in the page. To use a static list of URLs, you can use a tool like ",a.a.createElement("a",{href:"https://pastebin.com",target:"_blank",rel:"noopener noreferrer"},"https://pastebin.com"),"."))),a.a.createElement(D.a.Item,null,o("autopin",{valuePropName:"checked"})(a.a.createElement(L.a,null,"Automatically pin new page founds."))),a.a.createElement(D.a.Item,null,a.a.createElement(ue,{storageType:n})),a.a.createElement(D.a.Item,null,a.a.createElement(W.a,{type:"primary",icon:"plus",htmlType:"submit"},"Create")))})),be=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"First of all, you need to give a name to your project. Then, you need to provide the URL depending of the crawling method you will be using. If you are using the ",a.a.createElement("b",null,"Spider bot")," method, you should give the URL of the website you want to crawl. If you are using the ",a.a.createElement("b",null,"URLs list")," method, you should give the URL of the endpoint containing the list of URLs."),a.a.createElement("p",null,"There is different kind of browser: ",a.a.createElement("a",{href:"https://github.com/puppeteer/puppeteer",target:"_blank",rel:"noopener noreferrer"},"chrome-puppeteer"),", ",a.a.createElement("a",{href:"https://github.com/SeleniumHQ/selenium",target:"_blank",rel:"noopener noreferrer"},"firefox-selenium"),"... Depending of the browser you will select, different tool will be available in the code injection. Also some browser are only available depending of the OS where is test-crawler hosted."),a.a.createElement(ee,null,a.a.createElement("p",null,"IE and Safari are in experimentation, might not be stable.")),a.a.createElement("p",null,"Running your test in safari work only on macOS. Safari doesn't support multiple instance in parallel, therefor crawling might be very slow. Locally, you will need to activate safari webdriver for selenium with the following commands:"),a.a.createElement("pre",null,a.a.createElement("code",null,"sudo safaridriver --enable safaridriver -p 0 &")),a.a.createElement("p",null,"Internet explorer, is the browser giving the most problem till now. Setting viewport has no effect, fullpage screenshot doesn't work, Spider Bot crawling will most likely fail."),a.a.createElement("p",null,"There is multiple viewports (screen size) available. If you want to test multiple viewports for the same website, you will have to create one project per viewport."),a.a.createElement("p",null,"Finally, you can specify if you want to automatically pin the new pages founds. Pins are the references screenshot to make the comparison with. While crawling, the crawler is comparing page to pin. If you are not sure, the auto-pin can be activate/deactivate afterwards."),a.a.createElement(p.a.Title,{level:4},"Spider bot"),a.a.createElement("p",null,a.a.createElement("b",null,"Spider bot")," crawling method will get all the links inside the page of the given URL and crawl the children. It will then continue do the same with the children till no new link is found. Be careful if you have big website, this is most likely not the right solution for you."),a.a.createElement(p.a.Title,{level:4},"URLs list"),a.a.createElement("p",null,a.a.createElement("b",null,"URLs list")," crawling method will crawl a specific sets of URLs. In the URL input field you must provide an endpoint containing a list of URLs (a simple text format, with one URL per line). The crawler will crawl each of those URL only and will not try to find links in the page. To use a static list of URLs, you can use a tool like ",a.a.createElement("a",{href:"https://pastebin.com",target:"_blank",rel:"noopener noreferrer"},"https://pastebin.com"),"."))};!function(e){e.GitHub="github"}(me||(me={}));var we=n(41),Ee=n.n(we),ye=n(39),je=n.n(ye),ke=n(101),Oe=n(30),xe=n.n(Oe),Te=n(381),Ie=n.n(Te),Se=n(165),Ce=n.n(Se),Pe=n(166),Re=n.n(Pe);var _e,Le,Fe,De=function(e){return function(){e("")}},Ne=function(e){return function(){(new ie.a).set("githubNoSave","true",{path:"/"}),e("")}},Ue=function(e,t,n){return function(){t.length&&((new ie.a).set("githubToken",Ce.a.encrypt(n,t).toString(),{path:"/"}),e(""))}},ze=function(e){var t=e.token,n=e.setToken,r=a.a.useState(""),o=Object(ce.a)(r,2),i=o[0],c=o[1];return a.a.createElement(Re.a,{visible:!!t.length,title:"Keep token safe",onCancel:De(n),footer:[a.a.createElement(W.a,{key:"later",onClick:De(n)},"Later"),a.a.createElement(W.a,{key:"never",onClick:Ne(n)},"Never"),a.a.createElement(W.a,{key:"save",onClick:Ue(n,i,t)},"Save")]},a.a.createElement("p",{style:{textAlign:"justify"}},"Personal access tokens is a sensible information and you should keep it safe. For this reason, we are saving this token in your cookie only for a limited amount of time. After",10," min of inactivity, you will need to enter it again."),a.a.createElement("p",{style:{textAlign:"justify"}},"To keep this token safe, use some password manager like Lastpass or Bitwarden. Alternatively, you can use the build-in token AES encryption. Just set a password:"),a.a.createElement(C.a.Password,{placeholder:"Password",onChange:function(e){var t=e.target.value;return c(t)}}))},Ae=function(e){var t=Object(d.e)(),n=Object(d.f)();e===me.GitHub&&((new ie.a).get("github")||t.push({pathname:"/auth/github",state:{referer:n.pathname}}))},Me=function(e,t){return function(n){n.preventDefault(),e((function(e,n){e||((new ie.a).set("github",n,{path:"/",maxAge:600}),t())}))}},Be=function(e){return function(t){var n=t.target.value;if(n.length){var r=new ie.a;"true"===r.get("githubNoSave")||r.get("githubToken")||e(n)}}},Je=function(e){return function(){var t=new ie.a;if(t.get("githubToken")){var n=prompt("Please enter password to unlock token");if(null===n||void 0===n?void 0:n.length){var r=Ce.a.decrypt(t.get("githubToken"),n);if(r){var a=r.toString(Ie.a);if(a.length)return void e(a)}xe.a.error("Invalid password")}}}},He=D.a.create({name:"github_auth"})((function(e){var t=e.form,n=t.getFieldDecorator,r=t.validateFields,o=function(){var e=Object(d.e)(),t=Object(d.f)();return function(){var n,r,a;"/"===t.pathname?null===(r=window)||void 0===r||null===(a=r.location)||void 0===a||a.reload():(null===(n=t.state)||void 0===n?void 0:n.referer)?e.push(t.state.referer):e.push("/")}}(),i=a.a.useState(""),c=Object(ce.a)(i,2),l=c[0],s=c[1],u=a.a.useState(""),m=Object(ce.a)(u,2),f=m[0],h=m[1],g=new ie.a,v="true"!==g.get("githubNoSave")&&!g.get("githubToken");return a.a.createElement(a.a.Fragment,null,a.a.createElement(ze,{token:l,setToken:s}),a.a.createElement(p.a.Title,{level:4},"GitHub"),a.a.createElement(ee,null,a.a.createElement(p.a.Paragraph,null,"To save data in your GitHub repository, we need to provide a ",a.a.createElement("a",{href:"https://developer.github.com/v3/auth/#via-oauth-and-personal-access-tokens",target:"_blank",rel:"noopener noreferrer"},"personal access tokens")," to the ",a.a.createElement("a",{href:"https://developer.github.com/v3/",target:"_blank",rel:"noopener noreferrer"},"GitHub API"),". To ",a.a.createElement("a",{href:"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line",target:"_blank",rel:"noopener noreferrer"},"create a token"),", go in developer settings, personal access tokens and then generate new token. In most of the case you will only need to give permission for ",a.a.createElement(p.a.Text,{code:!0},"public_repo"),".")),a.a.createElement(D.a,{onSubmit:Me(r,o)},a.a.createElement(D.a.Item,null,n("user",{rules:[{required:!0,message:"Please provide your GitHub username."}]})(a.a.createElement(C.a,{addonBefore:"Username",placeholder:"Github username"}))),a.a.createElement(D.a.Item,null,n("token",{initialValue:f,rules:[{required:!0,message:"Please provide your personal access tokens."}]})(a.a.createElement(C.a.Password,Object.assign({addonBefore:"Token",placeholder:"Personal access tokens"},v&&{onBlur:Be(s)},g.get("githubToken")&&{addonAfter:a.a.createElement(U.a,{type:"unlock",onClick:Je(h)})})))),a.a.createElement(D.a.Item,null,a.a.createElement(W.a,{type:"primary",icon:"github",htmlType:"submit"},"OK"))))})),Ge=n(928),We=function(e){var t=e.storageType,n=se((function(){return Object(K.g)(t)})).result;return n?a.a.createElement(ee,null,a.a.createElement(p.a.Paragraph,null,n)):null},qe=function(e){var t=e.title,n=e.storageType,r=function(e){var t=se((function(){return Object(K.o)(e)})),n=t.result,r=t.error;return{projects:n,loading:t.loading,error:r,call:t.call}}(n),o=r.projects,i=r.loading,c=r.error,l=r.call,s=function(e){if(e){if(e===ke.a.missingGitHubConfig||(null===e||void 0===e?void 0:e.message)===ke.a.missingGitHubConfig)return He;Ge.a.warning({message:"Something went wrong.",description:e.toString()})}}(c);return s?a.a.createElement(s,null):a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a.Title,{level:4},t," ",a.a.createElement(ue,{storageType:n,loadProjects:l})),a.a.createElement(We,{storageType:n}),i?a.a.createElement(je.a,null):a.a.createElement(Ee.a,{itemLayout:"horizontal",bordered:!0,dataSource:o,renderItem:function(e){var t=e.id,r=e.name,o=e.crawlerInput.url;return a.a.createElement(Ee.a.Item,{actions:[a.a.createElement(h.b,{to:Q(n,t)},"Open")]},a.a.createElement(Ee.a.Item.Meta,{title:a.a.createElement(h.b,{to:Q(n,t)},r," ",a.a.createElement(U.a,{type:n})),description:o}))}}))},Ve=function(){return he(Ye),a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a.Title,{level:3},"Projects"),Object.keys(me).map((function(e){return a.a.createElement("div",{key:e},a.a.createElement(qe,{title:e,storageType:me[e]}),a.a.createElement("br",null),a.a.createElement(h.b,{to:V(me[e])},a.a.createElement(W.a,{icon:"plus",size:"small"},"New")),a.a.createElement("br",null),a.a.createElement("br",null))})))},Ye=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"Test-crawler is project based. To be able to start a crawler, you will first need to create a project by clicking on ",a.a.createElement(W.a,{icon:"plus",size:"small"},"New")),a.a.createElement("p",null,"Depending on how test-crawler is hosted, there will be different type of storage availble: local, GitHub, and more coming soon... If you are running it, yourself, all the storage should be available."),a.a.createElement(p.a.Title,{level:4},"Local"),a.a.createElement("p",null,"The ",a.a.createElement("b",null,"local")," storage consist to save the data on the server where is hosted test-crawler. This is the best option to keep your tests private and safe."),a.a.createElement(p.a.Title,{level:4},"GitHub"),a.a.createElement("p",null,"The ",a.a.createElement("b",null,"GitHub")," storage consist to save the data on a given repository. This option is good for public project, especially for open source project that are already on GitHub. It will give you the possibility to keep history of your tests in relation to your code changes. Also this storage is using GitHub CI workflow to generate your test, you can therefor integrate it very well with your other workflow."),a.a.createElement("p",null,"To use ",a.a.createElement("b",null,"GitHub")," storage, we need to provide a user and a ",a.a.createElement("a",{href:"https://developer.github.com/v3/auth/#via-oauth-and-personal-access-tokens",target:"_blank",rel:"noopener noreferrer"},"personal access tokens")," to the ",a.a.createElement("a",{href:"https://developer.github.com/v3/",target:"_blank",rel:"noopener noreferrer"},"GitHub API"),". Personal access tokens is a sensible information and you should keep it safe. For this reason, we are saving this token in your cookie only for a limited amount of time. After ",10," min of inactivity, you will need to enter it again."),a.a.createElement("p",null,"To keep this token safe, use some password manager like Lastpass or Bitwarden. Alternatively, you can use the build-in token AES encryption. To decrypt the token click on lock icon ",a.a.createElement(U.a,{type:"unlock"}),"."),a.a.createElement("p",null,"To ",a.a.createElement("a",{href:"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line",target:"_blank",rel:"noopener noreferrer"},"create a token"),", go in developer settings, personal access tokens and then generate new token. In most of the case you will only need to give permission for ",a.a.createElement(p.a.Text,{code:!0},"public_repo"),"."),a.a.createElement(ee,null,a.a.createElement(p.a.Paragraph,null,"Note: we are not saving any of your credential on a server. Everything is save in your cookies. Also the ",a.a.createElement("a",{href:"https://apiel.github.io/test-crawler/live/"},"live version")," hosted on GitHub page is purely static. All the logic is running in your browser.")),a.a.createElement("p",null,"Once your credential provided, you will need to select the repository where you want to save your tests. In general, it would make sense to save those tests in the same repository as the website you are testing. You can switch from one repository to the other at anytime."))},$e=n(119),Ze=n(169),Qe=n.n(Ze),Ke=n(167),Xe=n.n(Ke),et={textAlign:"center"},tt=300,nt={width:tt+20,marginBottom:10},rt={paddingTop:10,paddingBottom:10},at={gutter:10,fitWidth:!0},ot=n(168),it=n.n(ot),ct=function(e){var t=e.message,n=void 0===t?"Something went wrong":t,r=e.description;return a.a.createElement(it.a,{message:n,description:r,type:"warning",showIcon:!0})},lt=n(383),st=n.n(lt),ut=n(384),pt=n.n(ut),mt={width:nt.width,marginRight:at.gutter},ft=function(e,t,n){return function(r){t&&(r.length?(clearTimeout(_e),_e=setTimeout((function(){gt(e,ht(t,r),n)}),500)):gt(e,t,n))}},ht=function(e,t){return new st.a(e,{keys:["url","viewport.width","viewport.height","keywords"]}).search(t)},dt=function(e,t,n){return function(r){t&&(n(r),gt(e,t,r))}},gt=function(e,t,n){if(t)if(n.length){var r=n.filter((function(e){return!Object.keys(vt).includes(e)})).join(" ");r&&(t=ht(t,r)),e(t.filter((function(e){var t=!0;if(n.includes("with-diff")){var r=pt()(e,"png.diff.pixelDiffRatio");t=t&&r>0}return n.includes("new")&&(t=t&&!!e.png&&!e.png.diff),t})))}else e(t)},vt={"with-diff":"with diff",new:"new"},bt=oe.a.Option,wt=function(e){var t=e.children,n=e.response,r=e.withFilters,o=a.a.useState(),i=Object(ce.a)(o,2),c=i[0],l=i[1],s=a.a.useState([]),u=Object(ce.a)(s,2),p=u[0],m=u[1],f=a.a.useState(),h=Object(ce.a)(f,2),d=h[0],g=h[1];return a.a.useEffect((function(){l(n),dt(g,n,m)(p)}),[n,m,p]),a.a.createElement(a.a.Fragment,null,a.a.createElement(oe.a,{mode:"tags",onChange:dt(g,c,m),tokenSeparators:[","],style:mt,placeholder:"Search",filterOption:!1,onSearch:ft(g,c,p)},!!r&&Object.keys(r).map((function(e){return a.a.createElement(bt,{key:e},r[e])}))),t(d))},Et=n(386),yt=n.n(Et),jt=n(95),kt=function(e){return Object(jt.unix)(parseInt(e,10)).calendar()},Ot=n(123),xt=n(385),Tt={marginLeft:5,marginRight:5},It=function(e,t){var n=t.timestamp,r=t.id,a=t.index,o=t.projectId,i=t.setPages,c=t.storageType;return(Object(I.a)(O.a.mark((function t(){var l;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(K.w)(c,o,n,r,a,e);case 3:l=t.sent,i(l),xe.a.success("Page pinned as reference for comparison.",2),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),H.a.error({message:"Something went wrong!",description:t.t0.toString()});case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))))},St=function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(W.a,{style:Tt,icon:"check",size:"small",onClick:It(q.c.valid,e)},"Valid"),a.a.createElement(W.a,{style:Tt,icon:"pushpin",size:"small",onClick:It(q.c.zonePin,e)},"Always valid"),a.a.createElement(W.a,{style:Tt,icon:"warning",size:"small",type:"danger",onClick:It(q.c.report,e)},"Report"))},Ct=function(e){return e===q.c.valid||e===q.c.zonePin?"#0F0":e===q.c.report?"red":"yellow"},Pt=function(e,t,n,r,a,o,i){var c=e.xMin,l=e.yMin,s=l/t-1,u=c/t-1;return{width:(e.xMax-c)/t+2,height:(e.yMax-l)/t+2,top:s,left:u+r,border:"1px solid ".concat(Ct(i)),position:"absolute",backgroundImage:o?'url("'.concat(a,'")'):"none",backgroundPosition:"".concat(-(u+1),"px ").concat(-(s+1),"px"),backgroundSize:n}},Rt=function(e){var t=e.storageType,n=e.thumb,o=e.setPages,i=e.projectId,c=e.timestamp,l=e.id,s=e.index,u=e.originalWidth,p=e.zone,m=e.status,f=e.width,h=e.marginLeft,d=Object(r.useState)(!1),g=Object(ce.a)(d,2),v=g[0],b=g[1],w=u/f;return a.a.createElement(A.a,{key:"".concat(l,"-").concat(s),content:a.a.createElement(St,{storageType:t,index:s,timestamp:c,id:l,projectId:i,setPages:o}),trigger:"click"},a.a.createElement("div",{style:Pt(p,w,f,h,n,v,m),onMouseOver:function(){return b(!0)},onMouseOut:function(){return b(!1)}}))},_t=function(e){var t=e.zones;return a.a.createElement("p",null,a.a.createElement("b",null,"Zone:"),"\xa0",[[q.c.diff],[q.c.valid,q.c.zonePin],[q.c.report]].map((function(e){var n=Object(xt.a)(e),r=n[0],o=n.slice(1);return a.a.createElement(a.a.Fragment,{key:r},a.a.createElement("span",{style:{marginLeft:10,color:Ct(r)}},"\u25a0")," ",a.a.createElement("b",null,function(e,t){return e.filter((function(e){var n=e.status;return t.includes(n)})).length}(t,[r].concat(Object(Ot.a)(o))))," ",r)})))},Lt=function(e){var t=e.diff;return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,a.a.createElement(U.a,{type:"picture",theme:"outlined"}),"\xa0 Pixel diff ratio: ",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return e;var n=t-1-Math.floor(Math.log(e)/Math.log(10));return e.toFixed(n)}(t.pixelDiffRatio)),t.zones&&t.zones.length>0&&a.a.createElement(_t,{zones:t.zones}))},Ft=function(e){var t=e.diff;return t?a.a.createElement(Lt,{diff:t}):a.a.createElement("div",null,a.a.createElement(U.a,{type:"picture",theme:"outlined"}),"\xa0 New screenshot ",a.a.createElement(yt.a,{color:"green"},"New"))},Dt=new(n(866))({fg:"#333"}),Nt={marginBottom:10},Ut=function(e){var t=e.pageError,n=e.url,r=e.png;return a.a.createElement(a.a.Fragment,null,t&&a.a.createElement(it.a,{message:a.a.createElement("div",{dangerouslySetInnerHTML:{__html:Dt.toHtml(t)}}),type:"warning",style:Nt}),a.a.createElement("p",null,a.a.createElement(U.a,{type:"link"})," ",a.a.createElement("a",{href:n},n)),r?a.a.createElement(Ft,{diff:r.diff}):a.a.createElement("p",null,a.a.createElement(U.a,{type:"picture",theme:"outlined"})," No screenshot available"))},zt=function(e){var t=e.timestamp,n=e.id,r=e.status,a=e.projectId,o=e.setPages,i=e.storageType;return(Object(I.a)(O.a.mark((function e(){var c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(K.x)(i,a,t.toString(),n,r);case 3:c=e.sent,o(c),xe.a.success('All zone are set to "'.concat(r,'".'),2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),H.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},At=function(e){var t=e.status,n=e.type;return a.a.createElement(U.a,{type:n,title:'Set all zone to "'.concat(t,'".'),onClick:zt(e)})},Mt=function(e){var t=e.storageType,n=e.projectId,r=e.timestamp,a=e.id;return(Object(I.a)(O.a.mark((function e(){var o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=xe.a.loading("Pin in progress..",0),e.next=4,Object(K.q)(t,n,r.toString(),a);case 4:o(),xe.a.success("Page pinned as reference for comparison.",2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),H.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},Bt=function(e){return function(e){return a.a.createElement(U.a,{type:"pushpin",title:"pin as reference for comparison",onClick:Mt(e)})}(e)},Jt=function(e){var t=e.storageType,n=e.projectId,o=e.timestamp,i=e.id,c=e.onImg,l=void 0===c?function(){}:c,s=e.width,u=void 0===s?tt:s,p=e.children,m=Object(r.useState)(),f=Object(ce.a)(m,2),h=f[0],d=f[1],g=function(){var e=Object(I.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,Object(K.m)(t,n,o,i,u);case 3:e.t1=e.sent,(0,e.t0)(e.t1),l();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){g()}),[]),h?a.a.createElement("div",{style:et},p,a.a.createElement("img",{style:{width:u},alt:"",src:h})):null},Ht=function(e){var t=e.storageType,n=e.projectId,r=e.timestamp,o=e.id,i=e.zones,l=e.originalWidth,s=void 0===l?0:l,u=e.width,p=void 0===u?tt:u,m=e.setPages,f=e.marginLeft,h=Object(T.a)(e,["storageType","projectId","timestamp","id","zones","originalWidth","width","setPages","marginLeft"]),d=Object(c.b)(K.m,t,n,"pin",o,p),g=d.call,v=d.response,b=d.cache;return a.a.useEffect((function(){i&&!b()&&g()}),[i]),a.a.createElement(Jt,Object.assign({storageType:t,projectId:n,timestamp:r,id:o,width:p},h),null===i||void 0===i?void 0:i.map((function(e,i){var c=e.zone,l=e.status;return a.a.createElement(Rt,{storageType:t,thumb:v,projectId:n,timestamp:r,id:o,width:p,index:i,originalWidth:s,marginLeft:f,status:l,zone:c,key:"zone-".concat(o,"-").concat(i),setPages:m})})))},Gt=function(e){return function(){e(!0)}},Wt=function(e){return function(){e(!1)}},qt=function(e){var t=e.storageType,n=e.setPages,r=e.projectId,o=e.timestamp,i=e.id,c=e.png,l=e.url,s=e.pageError,u=a.a.useState(!1),p=Object(ce.a)(u,2),m=p[0],f=p[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(Re.a,{title:"",visible:m,onCancel:Wt(f),footer:null,width:c.width+40},a.a.createElement("div",{style:{position:"relative"}},a.a.createElement(Ht,{storageType:t,setPages:n,projectId:r,timestamp:o,id:i,zones:c.diff&&c.diff.zones,originalWidth:c.width,width:c.width,marginLeft:0}),a.a.createElement(Ut,{url:l,pageError:s,png:c}))),a.a.createElement(U.a,{type:"fullscreen",title:"fullscreen",onClick:Gt(f)}))},Vt=function(e){var t=e.storageType,n=e.setPages,r=e.projectId,o=e.timestamp,i=e.id,c=e.png,l=e.url,s=e.pageError;return[c&&a.a.createElement(qt,{storageType:t,setPages:n,projectId:r,png:c,id:i,timestamp:o,url:l,pageError:s})].concat([a.a.createElement(At,{storageType:t,type:"check",setPages:n,projectId:r,timestamp:o,id:i,status:q.c.valid}),a.a.createElement(At,{storageType:t,type:"warning",setPages:n,projectId:r,timestamp:o,id:i,status:q.c.report}),a.a.createElement(Bt,{storageType:t,projectId:r,timestamp:o,id:i})])},Yt=function(e){return Le=e},$t=function(){Le&&Le.layout(),clearTimeout(Fe),Fe=setTimeout((function(){Le&&Le.layout()}),500)},Zt=function(e){var t=e.projectId,n=e.timestamp,r=e.lastUpdate,o=e.storageType,i=se((function(){return Object(K.i)(o,t,n)}),[r]),c=i.result,l=i.error,s=i.setResult;return l?a.a.createElement(ct,{description:l.toString()}):a.a.createElement(wt,{response:c,withFilters:vt},(function(e){return e?a.a.createElement(Xe.a,{style:rt,options:at,ref:function(e){Yt(e&&e.masonry)}},e.map((function(e){var r=e.id,i=e.url,c=e.png,l=e.error;return a.a.createElement(Qe.a,{key:r,style:nt,cover:c&&a.a.createElement(Ht,{storageType:o,projectId:t,timestamp:n,id:r,zones:c.diff&&c.diff.zones,originalWidth:c.width,onImg:$t,setPages:s,marginLeft:10}),actions:Vt({storageType:o,setPages:s,projectId:t,id:r,timestamp:n,png:c,url:i,pageError:l})},a.a.createElement(Ut,{url:i,pageError:l,png:c}))}))):a.a.createElement(je.a,null)}))},Qt=n(170),Kt=n.n(Qt),Xt=(n(895),n(387)),en=n.n(Xt),tn=function(e,t,n,r){return function(){var a=Object(I.a)(O.a.mark((function a(o){var i,c;return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,i=o?"done":"review",a.next=4,Object(K.v)(e,t,n,i);case 4:c=a.sent,r(c),xe.a.success('Status set to "'.concat(i,'".'),2),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),H.a.error({message:"Something went wrong!",description:a.t0.toString()});case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}()},nn=function(e){var t=e.storageType,n=e.timestamp,r=e.status,o=e.projectId,i=e.setCrawler;return a.a.createElement(en.a,{checkedChildren:"done",unCheckedChildren:"review",checked:"done"===r,onChange:tn(t,o,n,i)})},rn=function(e,t){var n=Object(c.b)(K.n,e,t),r=n.call,o=n.response,i=n.update,l=n.error,s=n.cache;return a.a.useEffect((function(){s()||r()}),[e,t,s,r]),l&&H.a.warning({message:"Something went wrong while loading project.",description:l.toString()}),{project:o,setProject:i}},an=function(e){var t=e.projectId,n=e.storageType,r=rn(n,t).project;return r?a.a.createElement("p",null,a.a.createElement("b",null,"Project:")," ",a.a.createElement(h.b,{to:Q(n,r.id)},r.name)):null},on=p.a.Title,cn={color:"#faad29"},ln={color:"#999",fontSize:11},sn=function(e){var t=e.crawler,n=t.timestamp,r=t.url,o=t.browser,i=t.diffZoneCount,c=t.errorCount,l=t.status,s=t.urlsCount,u=t.inQueue,p=t.startAt,m=t.lastUpdate,f=t.limit,h=t.viewport,d=e.projectId,g=e.storageType,v=e.setCrawler,b=s+u,w=Math.floor(s/b*100),E=re(h);return a.a.createElement(a.a.Fragment,null,a.a.createElement(on,{level:3},kt(n)),(i>0||c>0)&&a.a.createElement("p",null,a.a.createElement(nn,{storageType:g,setCrawler:v,projectId:d,status:l,timestamp:n})),a.a.createElement(an,{projectId:d,storageType:g}),a.a.createElement("p",null,a.a.createElement("b",null,"URL:")," ",r),a.a.createElement("p",null,a.a.createElement("b",null,"Browser:")," ",o||q.b.ChromePuppeteer),a.a.createElement("p",null,a.a.createElement("b",null,"Screen:")," ",E),a.a.createElement("p",null,a.a.createElement("b",null,"URL crawled:")," ",s,void 0!==f&&f>0&&a.a.createElement("span",{style:ln}," (with limit set to ",f,")")),a.a.createElement("p",null,a.a.createElement("b",null,"Duration:")," ",Object(jt.duration)(m-p).format("h [hrs], m [min], s [sec]")),u>0&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Kt.a,{percent:w}),a.a.createElement("p",null,a.a.createElement("b",null,"In queue:")," ",u)),c>0&&a.a.createElement("p",{style:cn},a.a.createElement(U.a,{type:"exclamation-circle"})," ",c," error(s) founds"))},un=function(e){var t=e.match.params,n=t.timestamp,r=t.projectId,o=t.storageType;Ae(o),he();var i=se((function(){return Object(K.e)(o,r,n)})),c=i.result,l=i.error,s=i.setResult;if(a.a.useEffect((function(){var e=Object($e.subscrib)(s);return function(){return Object($e.unsubscrib)(e)}}),[c,s]),l)return a.a.createElement(ct,{description:l.toString()});var u=null===c||void 0===c?void 0:c.lastUpdate;return c?a.a.createElement(a.a.Fragment,null,a.a.createElement(sn,{crawler:c,projectId:r,storageType:o,setCrawler:s}),a.a.createElement(Zt,{storageType:o,timestamp:n,lastUpdate:u,projectId:r})):a.a.createElement(je.a,null)},pn=n(388),mn=n.n(pn),fn=function(e,t,n,r){return Object(I.a)(O.a.mark((function a(){var o,i;return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=xe.a.loading("Delete in progress..",0),a.next=3,Object(K.r)(e,t,n);case 3:i=a.sent,r(i),o();case 6:case"end":return a.stop()}}),a)})))},hn=function(e){var t=e.storageType,n=e.projectId,r=e.timestamp,o=e.id,i=e.url,c=e.viewport,l=e.onImg,s=e.png,u=e.setPins;return a.a.createElement(Qe.a,{style:nt,cover:s&&a.a.createElement(Jt,{timestamp:r,id:o,onImg:l,projectId:n,storageType:t}),actions:[a.a.createElement(mn.a,{title:"Are you sure delete this pin?",onConfirm:fn(t,n,o,u),okText:"Yes",cancelText:"No"},a.a.createElement(U.a,{type:"delete",title:"Delete pin"})),a.a.createElement(h.b,{to:{pathname:$(t,n,o),state:{pattern:i}}},a.a.createElement(U.a,{type:"code",title:"Insert code while crawling"}))]},a.a.createElement("p",null,a.a.createElement(U.a,{type:"link"})," ",a.a.createElement("a",{href:i},i)),!s&&a.a.createElement("p",null,a.a.createElement(U.a,{type:"picture",theme:"outlined"})," No screenshot available"),c&&a.a.createElement("p",null,a.a.createElement(U.a,{type:"picture",theme:"outlined"})," ",re(c)))},dn=p.a.Title,gn=function(e){var t=e.match.params,n=t.projectId,r=t.storageType;he();var o=se((function(){return Object(K.j)(r,n)})),i=o.result,c=o.error,l=o.setResult;return c?a.a.createElement(ct,{description:c.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(dn,{level:3},"Pins"),a.a.createElement(an,{projectId:n,storageType:r}),a.a.createElement(wt,{response:i},(function(e){return e?a.a.createElement(Xe.a,{style:rt,options:at,ref:function(e){Yt(e&&e.masonry)}},e.map((function(e){var t=e.id,o=e.url,i=e.png,c=e.viewport,s=e.timestamp;return a.a.createElement(hn,{projectId:n,timestamp:s,id:t,key:t,url:o,setPins:l,png:i,viewport:c,onImg:$t,storageType:r})}))):a.a.createElement(je.a,null)})))},vn=n(171),bn=n.n(vn),wn=(n(368),n(369),p.a.Paragraph),En=p.a.Text,yn=function(e){var t=e.full,n=void 0===t||t;return a.a.createElement(ee,null,a.a.createElement(wn,null,"Inject some code in the crawler while parsing the page. This code will be executed just after the page finish loaded, before to make the screenshot and before extracting the links. ",n&&a.a.createElement(a.a.Fragment,null,"You need to export a function that will take as first parameter the ",a.a.createElement(En,{code:!0},"page")," coming from Puppeteer.")),n&&a.a.createElement(wn,null,a.a.createElement(En,{code:!0},"module.exports = async (page) => ...some code")))},jn={border:"1px solid #EEE",marginBottom:15,width:"auto"},kn=(Object(x.a)({},nt,{float:"left"}),{marginBottom:15}),On={marginRight:10},xn={maxWidth:500,margin:"0px 0px 10px 0px"},Tn=n(389),In=n.n(Tn),Sn=n(57),Cn=n.n(Sn),Pn=p.a.Paragraph,Rn=function(){xe.a.warn("To be implemented.",2)},_n=function(){var e=Object(I.a)(O.a.mark((function e(t,n,r,a,o){var i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=xe.a.loading("Saving in progress...",0),e.next=4,Object(K.u)(t,n,Object(x.a)({id:r,source:a},o));case 4:i(),xe.a.success("Code saved.",2),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),H.a.error({message:"Something went wrong!",description:e.t0.toString()});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,r,a,o){return e.apply(this,arguments)}}(),Ln=function(e,t,n,r,a){return function(o){o.preventDefault(),a((function(a,o){a||_n(e,t,n,r,o)}))}},Fn=D.a.create({name:"code"})((function(e){var t,n=e.storageType,r=e.projectId,o=e.setSource,i=e.id,c=e.code,l=e.form,s=l.getFieldDecorator,u=l.validateFields,p=e.location.state;return a.a.createElement(D.a,{onSubmit:Ln(n,r,i,c.source,u)},a.a.createElement(D.a.Item,{style:xn},s("name",{initialValue:c.name||""})(a.a.createElement(C.a,{addonBefore:"Name"}))),a.a.createElement(D.a.Item,{style:xn},s("pattern",{rules:[{required:!0,message:"Please input a pattern!"}],initialValue:c.pattern||p&&p.pattern||""})(a.a.createElement(C.a,{addonBefore:"Pattern"}))),a.a.createElement(ee,null,a.a.createElement(Pn,null,"Pattern is using ",a.a.createElement("a",{href:"https://www.npmjs.com/package/minimatch",target:"_blank",rel:"noopener noreferrer"},"minimatch")," to match the urls to inject the code. It works by converting glob expressions into JavaScript RegExp objects.")),a.a.createElement("div",{style:kn},a.a.createElement(W.a,{icon:"save",htmlType:"submit",style:On},"Save"),a.a.createElement(W.a,{icon:"caret-right",onClick:Rn,style:On},"Preview"),a.a.createElement(In.a,{overlay:(t=o,a.a.createElement(Cn.a,null,a.a.createElement(Cn.a.Item,{key:"1",onClick:function(){t('module.exports = async function run(page) {\n    await page.evaluate(() => {\n        const div = document.createElement("div");\n        div.innerHTML = "Test-crawler is awesome!";\n        document.body.insertBefore(div, document.body.firstChild);\n    });\n}')}},"Test-crawler is awesome"),a.a.createElement(Cn.a.Item,{key:"2",onClick:function(){t("module.exports = async function run(page) {\n    return await page.evaluate(() => {\n        Array.from(document.body.getElementsByTagName(\"a\"))\n             .filter(a => !a.href)\n             .forEach(a => a.click());\n        return Array.from(document.links).map(\n            link => link.href.replace('/?', '/iframe.html?')\n        );\n    });\n}")}},"Storybook"),a.a.createElement(Cn.a.Item,{key:"3",onClick:function(){t("// expect library from jest is installed by default\n// but you can use any assertion tool of your choice\n// just install it and use it here :D\nconst expect = require('expect');\n\nmodule.exports = async function run(page) {\n  await expect(page.title()).resolves.toMatch('React App');\n  expect('a').toBe('b'); // fail\n}")}},"Expect assetion example")))},a.a.createElement(W.a,{style:On},"Code snippet ",a.a.createElement(U.a,{type:"down"})))))})),Dn=p.a.Title,Nn=function(e,t){return function(n){t(Object(x.a)({},e,{source:n}))}},Un=function(e){var t=e.match.params,n=t.id,r=t.projectId,o=t.storageType,i=e.location;he();var c=se((function(){return Object(K.c)(o,r,n)})),l=c.error,s=c.result,u=c.setResult;return l?a.a.createElement(ct,{description:l.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(Dn,{level:3},"Add some code"),s?a.a.createElement(D.a,null,a.a.createElement(yn,null),a.a.createElement(an,{projectId:r,storageType:o}),a.a.createElement(Fn,{projectId:r,id:n,code:s,setSource:Nn(s,u),location:i,storageType:o}),a.a.createElement(bn.a,{mode:"javascript",theme:"tomorrow",onChange:Nn(s,u),fontSize:14,value:s.source.length?s.source:"module.exports = async function run(page) {\n// your code\n}",style:jn})):a.a.createElement(je.a,null))},zn=p.a.Title,An=function(){var e=Object(I.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,Object(K.l)();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mn=function(){var e=a.a.useState(),t=Object(ce.a)(e,2),n=t[0],r=t[1];return a.a.useEffect((function(){An(r)}),[]),he(),a.a.createElement(a.a.Fragment,null,a.a.createElement(zn,{level:3},"Settings"),n?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,a.a.createElement("b",null,"Dir:")," ",n.dir)):a.a.createElement(je.a,null),a.a.createElement("p",null,a.a.createElement(W.a,{icon:"caret-right",size:"small",onClick:K.z},"Start crawlers")))},Bn=p.a.Title,Jn=p.a.Text,Hn=function(e){var t=e.projectId,n=e.storageType,r=se((function(){return Object(K.d)(n,t)})),o=r.error,i=r.result;return o?a.a.createElement(ct,{description:o.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(Bn,{level:4},"For each page"),a.a.createElement(yn,{full:!1}),i?a.a.createElement(Ee.a,{bordered:!0,dataSource:Object.values(i),renderItem:function(e){var r=e.id,o=e.name,i=e.pattern;return a.a.createElement(Ee.a.Item,{actions:[a.a.createElement(h.b,{to:$(n,t,r)},"Edit")]},a.a.createElement(Ee.a.Item.Meta,{title:a.a.createElement(h.b,{to:$(n,t,r)},o," ",a.a.createElement(Jn,{code:!0},i))}))}}):a.a.createElement(je.a,null),a.a.createElement("br",null),a.a.createElement(h.b,{to:$(n,t,Math.floor(Date.now()/1e3).toString())},a.a.createElement(W.a,{icon:"plus",size:"small"},"New code")))},Gn=p.a.Title,Wn=p.a.Paragraph,qn=function(e,t,n,r){return Object(I.a)(O.a.mark((function a(){var o;return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,o=xe.a.loading("Saving...",0),a.next=4,Object(K.s)(r,n,t,e);case 4:o(),xe.a.success("Code saved.",2),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),H.a.error({message:"Something went wrong!",description:a.t0.toString()});case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))},Vn=function(e){var t=e.type,n=e.projectId,r=e.storageType,o=e.title,i=e.info,c=e.codeParam,l=void 0===c?"":c,s=se((function(){return Object(K.a)(r,n,t)})),u=s.error,p=s.result,m=s.setResult;return u?a.a.createElement(ct,{description:u.toString()}):a.a.createElement(a.a.Fragment,null,a.a.createElement(Gn,{level:4},o),a.a.createElement(ee,null,a.a.createElement(Wn,null,i)),a.a.createElement(bn.a,{mode:"javascript",theme:"tomorrow",onChange:m,fontSize:14,value:(null===p||void 0===p?void 0:p.length)?p:"module.exports = async function run(".concat(l,") {\n// your code\n}"),style:Object(x.a)({},jn,{height:200})}),a.a.createElement(W.a,{icon:"save",size:"small",onClick:qn(p,t,n,r)},"Save"))},Yn=p.a.Title,$n=function(e){var t=e.projectId,n=e.storageType;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Yn,{level:3},"Codes"),a.a.createElement(Hn,{projectId:t,storageType:n}),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(Vn,{type:q.a.Before,projectId:t,storageType:n,title:"Before all",info:"This script will run when the test-crawler is starting, to give you the possibility to setup a working environment, for example to start a test server."}),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(Vn,{type:q.a.After,projectId:t,storageType:n,title:"After all",info:"This script will run when the test-crawler finish. You could for example use this script to send some notification.",codeParam:"totalDiffCount, totalErrorCount"}))},Zn=function(e){var t=e.jobs,n=e.loadJobs,r=e.loadCrawlers,o=a.a.useState(!1),i=Object(ce.a)(o,2),c=i[0],l=i[1];return a.a.useEffect((function(){var e;return(null===t||void 0===t?void 0:t.length)?(!c&&l(!0),e=setInterval(n,3e4)):c&&(l(!1),r()),function(){return clearInterval(e)}}),[t,r,l,c]),(null===t||void 0===t?void 0:t.length)?a.a.createElement(Ee.a,{itemLayout:"horizontal",bordered:!0,dataSource:t,style:{marginBottom:10},renderItem:function(e){var t=e.status,n=e.startAt,r=e.stepsCount,o=e.stepsDone,i=e.currentStep,c=e.url;return a.a.createElement(Ee.a.Item,{actions:[a.a.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},"Open")]},a.a.createElement(Ee.a.Item.Meta,{title:a.a.createElement("span",null,"CI job ",kt(n.toString())),description:a.a.createElement(a.a.Fragment,null,!!r&&void 0!==o&&a.a.createElement(Kt.a,{percent:100/r*o,size:"small",format:function(){return"".concat(o," of ").concat(r)}}),a.a.createElement("span",null,a.a.createElement(p.a.Text,{code:!0},t)," ",i))}))}}):null},Qn=function(e,t,n,r,o){return Object(I.a)(O.a.mark((function i(){var c,l,s,u;return O.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,c=xe.a.loading("Starting crawlers",0),i.next=4,Object(K.y)(n,t,o);case 4:l=i.sent,s=l.timestamp,(u=l.redirect)?(setTimeout(r,5e3),setTimeout(r,1e4),H.a.open({duration:10,message:"Test-crawler started",description:"Test-crawler is running the crawlers on a remote container. To see live progress click open:",btn:a.a.createElement("a",{href:u,target:"_blank",rel:"noopener noreferrer"},"Open")})):e.push(Z(n,t,s)),c(),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(0),H.a.error({message:"Something went wrong!",description:i.t0.toString()});case 14:case"end":return i.stop()}}),i,null,[[0,11]])})))},Kn=function(e,t,n){var r=t.name,a=t.id,o=t.crawlerInput;return(function(){var t=Object(I.a)(O.a.mark((function t(i){var c,l;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=i.target.checked,t.next=3,Object(K.t)(e,Object(x.a)({},o,{autopin:c}),r,a);case 3:l=t.sent,n(l);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},Xn=function(e,t,n,r){return r>0?"loading":e||0!==t?"done"===n?"issues-close":"exclamation-circle":"check"},er=function(e){var t,n=e.match.params,r=n.projectId,o=n.storageType,i=e.history;Ae(o),he(tr);var c=rn(o,r),l=c.project,s=c.setProject,u=function(e,t){var n=se(Object(I.a)(O.a.mark((function n(){var r;return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(K.f)(e,t);case 2:return r=n.sent,n.abrupt("return",r.sort((function(e,t){var n=e.timestamp,r=t.timestamp;return parseInt(r,10)-parseInt(n,10)})));case 4:case"end":return n.stop()}}),n)})))),r=n.result,a=n.setResult,o=n.error,i=n.loading,c=n.call;return o&&H.a.warning({message:"Something went wrong while loading crawlers from project.",description:o.toString()}),{crawlers:r,setCrawlers:a,loading:i,loadCrawlers:c}}(o,r),m=u.crawlers,f=u.loading,d=u.loadCrawlers,g=se((function(){return Object(K.h)(o,r)})),v=g.result,b=g.call,w=(null===l||void 0===l?void 0:null===(t=l.crawlerInput)||void 0===t?void 0:t.browser)||q.b.ChromePuppeteer;return a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a.Title,{level:3},"Project"),l?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,a.a.createElement("b",null,"Name:")," ",l.name),a.a.createElement("p",null,a.a.createElement("b",null,"ID:")," ",r),a.a.createElement("p",null,a.a.createElement("b",null,"URL:")," ",l.crawlerInput.url),a.a.createElement("p",null,a.a.createElement("b",null,"Browser:")," ",w),a.a.createElement("p",null,a.a.createElement("b",null,"Screen:")," ",re(l.crawlerInput.viewport)),a.a.createElement("p",null,a.a.createElement("b",null,"Method:"),"urls"===l.crawlerInput.method?a.a.createElement(a.a.Fragment,null," ",a.a.createElement(U.a,{type:"ordered-list"})," URLs list"):a.a.createElement(a.a.Fragment,null," ",a.a.createElement(U.a,{type:"radar-chart"})," Spider bot",!!l.crawlerInput.limit&&a.a.createElement("span",{style:{color:"#999",fontSize:12}}," (Limit: ",l.crawlerInput.limit,")"))),a.a.createElement("p",null,a.a.createElement(L.a,{checked:l.crawlerInput.autopin,onChange:Kn(o,l,s)},"Automatically pin new page founds.")),a.a.createElement("p",null,a.a.createElement(W.a,{icon:"caret-right",size:"small",onClick:Qn(i,r,o,b,w)},"Run")," \xa0",a.a.createElement(h.b,{to:Y(o,r)},a.a.createElement(W.a,{icon:"pushpin",size:"small"},"Pins"))),a.a.createElement(Zn,{jobs:v,loadJobs:b,loadCrawlers:d}),a.a.createElement(Ee.a,{itemLayout:"horizontal",bordered:!0,loading:f,dataSource:m,renderItem:function(e){var t=e.timestamp,n=e.diffZoneCount,i=e.errorCount,c=e.status,l=e.inQueue;return a.a.createElement(Ee.a.Item,{actions:[a.a.createElement(h.b,{to:Z(o,r,t)},"Open")]},a.a.createElement(Ee.a.Item.Meta,{title:a.a.createElement(h.b,{to:Z(o,r,t)},kt(t)),description:a.a.createElement(a.a.Fragment,null,a.a.createElement(U.a,{type:Xn(n,i,c,l)}),a.a.createElement("span",null," Diff: ",n," - Error: ",i," - In queue: ",l))}))}})):a.a.createElement(je.a,null),a.a.createElement("br",null),a.a.createElement($n,{projectId:r,storageType:o}))},tr=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"This page give you an overview of a selected project. From there you can see all the crawlers that has been started and their results. To run a crawler click on ",a.a.createElement(W.a,{icon:"caret-right",size:"small"},"Run")),a.a.createElement("p",null,"After clicking on the run button, you will be either redirected to the result page or a job will appear above the list of crawler, this will depends of the crawling storage you will use."),a.a.createElement(p.a.Title,{level:4},"Codes"),a.a.createElement("p",null,"Under the list of crawlers, is a codes section. This will let you write your own code to interact with the crawler when the job is running. There is different phases where you can interact with the crawler: before, during and after crawling."),a.a.createElement("p",null,a.a.createElement("b",null,"Before all")),a.a.createElement("p",null,"This script will run when the test-crawler is starting, to give you the possibility to setup a working environment. This can be useful if you need to start a server to run your test against it."),a.a.createElement("p",null,a.a.createElement("b",null,"For each page")),a.a.createElement("p",null,"This give you the possibility to inject some code in the crawler while parsing the page. This code will be executed just after the page finish loaded, before to make the screenshot and before extracting the links. This can be really useful to manipulate the page before making the screenshot. For example, if you have dynamic element in your page, you can simply remove it. You could open some hidden element from an accordion. Run some e2e assertion with Jest. There is so much possibility with this feature..."),a.a.createElement("p",null,a.a.createElement("b",null,"After all")),a.a.createElement("p",null,"This script will run when the test-crawler finish. This can be useful to send the result to an API or in an email. In the following example, we will show you how to send result in slack:"),a.a.createElement("pre",null,a.a.createElement("code",null,"\n// Need to install @slack/web-api where the crawler is running.\n// with local storage just do yarn add @slack/web-api\n// with remote storage like GitHub you will need to customize the CI job\nconst { WebClient } = require('@slack/web-api');\n\nconst token = 'api_slack_token';\n// Given some known conversation ID (representing a public channel, private channel, DM or group DM)\nconst conversationId = '...';\n\nmodule.exports = async function run(totalDiffCount, totalErrorCount) {\n    const web = new WebClient(token);\n    const result = await web.chat.postMessage({\n        text: `Hi, crawler finish his job. We found ${totalDiffCount} diff(s) and ${totalErrorCount} error(s).`,\n        channel: conversationId,\n    });\n}\n            ")),a.a.createElement(p.a.Title,{level:4},"Schedule"),a.a.createElement("p",null,"Right now, test-crawler doesn't offer scheduling out of the box but you can easily setup your own. On your server you can use build-in feature, like cronjob on Linux. For that, just use ",a.a.createElement(p.a.Text,{code:!0},"test-crawler-cli --project the_id_of_your_project"),"."),a.a.createElement("p",null,"On GitHub, you can reuse the workflow generated by test-crawler in ",a.a.createElement(p.a.Text,{code:!0},".github/workflows"),". Make a copy of the workflow under a different name and define the event to trigger the run, see ",a.a.createElement("a",{href:"https://help.github.com/en/actions/reference/events-that-trigger-workflows",target:"_blank",rel:"noopener noreferrer"},"documentation"),". You need then to specify the project you want to run."),a.a.createElement("pre",null,a.a.createElement("code",null,"\nname: Test-crawler schedule\n\non:\n  schedule:\n    # everyday at 01.00\n    - cron:  '* 1 * * *'\n\njobs:\n  test-crawler:\n    runs-on: macos-latest\n\n    steps:\n    - uses: actions/checkout@v2\n    - name: Run test-crawler\n      uses: apiel/test-crawler/actions/run@master\n      with:\n        projectId: put_here_id_of_the_project\n    - name: Push changes\n      uses: apiel/test-crawler/actions/push@master\n      with:\n        token: ${{ secrets.GITHUB_TOKEN }}\n\n            ")))},nr=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,o=rn(r,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:Q(r,n)},null===o||void 0===o?void 0:o.name)))},rr=function(e){var t=e.match.params,n=t.projectId,r=t.timestamp,o=t.storageType,i=rn(o,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:Q(o,n)},null===i||void 0===i?void 0:i.name)),a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:Z(o,n,r)},"Results: ",kt(r))))},ar=function(e){var t=e.match.params,n=t.projectId,r=t.storageType,o=rn(r,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:Q(r,n)},null===o||void 0===o?void 0:o.name)),a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:Y(r,n)},"Pins")))},or=function(e){var t=e.match.params,n=t.projectId,r=t.id,o=t.storageType,i=rn(o,n).project;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:"/"},"Projects")),a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:Q(o,n)},null===i||void 0===i?void 0:i.name)),a.a.createElement(f.a.Item,null,a.a.createElement(h.b,{to:$(o,n,r)},"Code")))},ir=n(390),cr=n.n(ir),lr=function(e){var t=e.children,n=fe(),r=n.open,o=n.toggle,i=n.content;return a.a.createElement(s.a,null,t,!!r&&a.a.createElement(s.a.Sider,{theme:"light",breakpoint:"md",collapsedWidth:"100%",width:"40%",style:{padding:15,textAlign:"justify"}},a.a.createElement(p.a.Title,{level:3,style:{float:"right",fontStyle:"italic",color:"#CCC"}},"Documentation"),a.a.createElement(cr.a,{offsetTop:10,style:{marginBottom:10}},a.a.createElement(W.a,{size:"small",shape:"circle",icon:"close",onClick:o})),a.a.createElement("br",null),i||a.a.createElement("p",null,"We are sorry, there is no documentation for this section. If you have any questions, please don't hesitate to ",a.a.createElement("a",{href:"https://github.com/apiel/test-crawler/issues",target:"_blank",rel:"noopener noreferrer"},"contact us"),".")))},sr=s.a.Content,ur=s.a.Header,pr=p.a.Title,mr={minHeight:"100vh"},fr={color:"#fff",marginTop:15,marginRight:15,float:"left"},hr={background:"#fff",padding:24,margin:10,minHeight:280},dr=function(){var e=fe().toggle;return function(){var e=new ie.a,t=e.get("github");t&&e.set("github",t,{path:"/",maxAge:600})}(),a.a.createElement(h.a,null,a.a.createElement(lr,null,a.a.createElement(s.a,{style:mr},a.a.createElement(ur,null,a.a.createElement(h.b,{to:"/"},a.a.createElement(pr,{level:3,style:fr},a.a.createElement(j,{style:{height:32,width:32,position:"absolute",fill:"#8c8c8c"}}),a.a.createElement("span",{style:{marginLeft:45}},"Test-crawler"))),a.a.createElement(Cn.a,{theme:"dark",mode:"horizontal",selectable:!1,style:{paddingTop:10}},a.a.createElement(Cn.a.Item,{key:"projects"},a.a.createElement(U.a,{type:"folder"}),a.a.createElement("span",{className:"nav-text"},"Projects"),a.a.createElement(h.b,{to:"/"})),a.a.createElement(Cn.a.Item,{key:"doc",title:"Docs",onClick:e},a.a.createElement(U.a,{type:"question-circle"}),a.a.createElement("span",{className:"nav-text"},"Documentation")),a.a.createElement(Cn.a.Item,{key:"settings",title:"settings"},a.a.createElement(U.a,{type:"setting"}),a.a.createElement("span",{className:"nav-text"},"Settings"),a.a.createElement(h.b,{to:"/settings"})))),a.a.createElement(f.a,{style:{margin:"10px 0 0 10px"}},a.a.createElement(d.a,{path:Q(":storageType",":projectId"),exact:!0,component:nr}),a.a.createElement(d.a,{path:Z(":storageType",":projectId",":timestamp"),exact:!0,component:rr}),a.a.createElement(d.a,{path:Y(":storageType",":projectId"),exact:!0,component:ar}),a.a.createElement(d.a,{path:$(":storageType",":projectId",":id"),exact:!0,component:or})),a.a.createElement(sr,{style:hr},a.a.createElement(d.a,{path:"/auth/github",exact:!0,component:He}),a.a.createElement(d.a,{path:"/",exact:!0,component:Ve}),a.a.createElement(d.a,{path:"/settings",exact:!0,component:Mn}),a.a.createElement(d.a,{path:V(":storageType"),exact:!0,component:ve}),a.a.createElement(d.a,{path:Y(":storageType",":projectId"),exact:!0,component:gn}),a.a.createElement(d.a,{path:$(":storageType",":projectId",":id"),exact:!0,component:Un}),a.a.createElement(d.a,{path:Z(":storageType",":projectId",":timestamp"),component:un}),a.a.createElement(d.a,{path:Q(":storageType",":projectId"),exact:!0,component:er})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var gr=n(391);"apiel.github.io"===window.location.host&&gr.hotjar.initialize(1680523,6),i.a.render(a.a.createElement(c.a,null,a.a.createElement((function(e){var t=e.children,n=new ie.a,r=a.a.useState("open"===n.get("doc")),o=Object(ce.a)(r,2),i=o[0],c=o[1],l=a.a.useState(),s=Object(ce.a)(l,2),u=s[0],p=s[1],m=function(e){n.set("doc",e?"open":"close",{path:"/"}),c(e)};return a.a.createElement(pe.Provider,{value:{open:i,setOpen:m,content:u,setContent:p,toggle:function(){return m(!i)}}},t)}),null,a.a.createElement(dr,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[392,1,2]]]);
//# sourceMappingURL=main.cbae4db1.chunk.js.map